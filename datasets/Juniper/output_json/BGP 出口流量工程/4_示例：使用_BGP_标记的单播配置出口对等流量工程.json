{
  "title": "示例：使用 BGP 标记的单播配置出口对等流量工程",
  "sections": [
    {
      "title": "要求",
      "level": 3,
      "content": "此示例使用以下硬件和软件组件： 九个 MX 系列路由器 Junos OS 14.2R4 或更高版本 此示例使用以下硬件和软件组件： 九个 MX 系列路由器 Junos OS 14.2R4 或更高版本"
    },
    {
      "title": "概述",
      "level": 3,
      "content": "从 Junos OS 14.2R4 版开始，您可以启用服务流量的流量工程 （TE），例如使用 BGP 标记的单播在自治系统 （AS） 之间启用 MPLS LSP 流量，以便在负载平衡期间优化利用播发的出口路由。 配置出口对等方 TE，以将核心服务流量（如 MPLS RSVP）定向到特定的出口 BGP 对等方。入口 BGP 对等方可以使用标记为单播的 BGP 对特定出口 BGP 对等方对核心 inet 单播和 inet6 单播服务流量进行流量工程。 注： 不能为外部 BGP 多跃点对等方配置出口对等方 TE。中的 inet.3 ARP 路由仅用于对等 /32 和 /128 路由。 不能为外部 BGP 多跃点对等方配置出口对等方 TE。中的 inet.3 ARP 路由仅用于对等 /32 和 /128 路由。 图 1 显示了示例拓扑。路由器 R3 和路由器 R4 都是 AS 边界路由器。在 R3 上启用了出口对等 TE。入口路由器 R0 将发往远程网络的流量定向到启用了出口对等 TE 的路由器 R3。",
      "sections": [
        {
          "title": "拓扑学",
          "level": 4,
          "content": "图 1 显示了示例拓扑。路由器 R3 和路由器 R4 都是 AS 边界路由器。在 R3 上启用了出口对等 TE。入口路由器 R0 将发往远程网络的流量定向到启用了出口对等 TE 的路由器 R3。",
          "images": [
            "BGP 出口流量工程\\images\\4_示例：使用_BGP_标记的单播配置出口对_1.png"
          ]
        }
      ]
    },
    {
      "title": "配置",
      "level": 3,
      "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改详细信息，以便与网络配置匹配，将命令复制并粘贴到 [edit] 层级的 CLI 中，然后从配置模式进入 commit 。 路由器 R0 set interfaces ge-2/0/1 unit 0 family inet address 10.1.1.1/24 set interfaces ge-2/0/1 unit 0 family inet6 address 2001:db8:10:1:1::1/64 set interfaces ge-2/1/4 unit 0 family inet address 10.100.100.1/30 set interfaces ge-2/1/4 unit 0 family inet6 address ::10.100.100.1/126 set interfaces ge-2/1/4 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.1.1.1/32 set interfaces lo0 unit 0 family inet6 address ::10.1.1.1/128 set routing-options router-id 01.1.1.1 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls no-cspf set protocols mpls label-switched-path to_asbr1_r3 to 10.6.6.6 set protocols mpls label-switched-path to_asbr2_r4 to 10.7.7.7 set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.1.1.1 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-svr-pre set protocols bgp group RR-1-2 export nhs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group R0RT0 type external set protocols bgp group R0RT0 family inet unicast set protocols bgp group R0RT0 peer-as 64496 set protocols bgp group R0RT0 neighbor 10.1.1.2 set protocols bgp group R0RT0-v6 type external set protocols bgp group R0RT0-v6 family inet6 unicast set protocols bgp group R0RT0-v6 peer-as 64496 set protocols bgp group R0RT0-v6 neighbor 2001:db8:40::2 set protocols ospf area 0.0.0.0 interface ge-2/1/4.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_prefix 10.1.1.1/32 set policy-options prefix-list server_v6_prefix ::10.1.1.1/128 set policy-options policy-statement exp-svr-pre term 1 from prefix-list server_v4_prefix set policy-options policy-statement exp-svr-pre term 1 then accept set policy-options policy-statement exp-svr-pre term 2 from prefix-list server_v6_prefix set policy-options policy-statement exp-svr-pre term 2 then accept set policy-options policy-statement nhs then next-hop self 路由器 R1 set interfaces ge-1/0/4 unit 0 family inet address 00.100.100.2/30 set interfaces ge-1/0/4 unit 0 family inet6 address ::00.100.100.2/126 set interfaces ge-1/0/4 unit 0 family mpls set interfaces ge-1/0/6 unit 0 family inet address 10.100.104.1/30 set interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.104.1/126 set interfaces ge-1/0/6 unit 0 family mpls set interfaces ge-1/0/9 unit 0 family inet address 100.100.105.1/30 set interfaces ge-1/0/9 unit 0 family inet6 address ::10.100.105.1/126 set interfaces ge-1/0/9 unit 0 family mpls set interfaces ge-1/1/3 unit 0 family inet address 10.100.102.1/30 set interfaces ge-1/1/3 unit 0 family inet6 address ::10.100.102.1/126 set interfaces ge-1/1/3 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.3.3.3/32 set interfaces lo0 unit 0 family inet6 address ::10.3.3.3/128 set routing-options router-id 10.3.3.3 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface all set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable 路由器 R2 set interfaces et-0/0/0 unit 0 family inet address 10.100.102.2/30 set interfaces et-0/0/0 unit 0 family inet6 address ::10.100.102.2/126 set interfaces et-0/0/0 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.4.4.4/32 set interfaces lo0 unit 0 family inet6 address ::10.4.4.4/128 set routing-options router-id 10.4.4.4 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group Client type internal set protocols bgp group Client local-address 10.4.4.4 set protocols bgp group Client advertise-inactive set protocols bgp group Client family inet unicast add-path receive set protocols bgp group Client family inet unicast add-path send path-count 6 set protocols bgp group Client family inet labeled-unicast rib inet.3 set protocols bgp group Client family inet6 unicast add-path receive set protocols bgp group Client family inet6 unicast add-path send path-count 6 set protocols bgp group Client family inet6 labeled-unicast rib inet6.3 set protocols bgp group Client cluster 10.4.4.4 set protocols bgp group Client neighbor 10.1.1.1 set protocols bgp group Client neighbor 10.6.6.6 set protocols bgp group Client neighbor 10.7.7.7 set protocols ospf area 0.0.0.0 interface et-0/0/0.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable 路由器 R3 set interfaces ge-1/1/0 unit 0 family inet address 10.100.104.2/30 set interfaces ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126 set interfaces ge-1/1/0 unit 0 family mpls set interfaces ge-2/2/5 unit 0 family inet address 10.200.203.1/28 set interfaces ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124 set interfaces ge-2/2/8 unit 0 family inet address 10.200.202.1/30 set interfaces ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126 set interfaces lo0 unit 0 family inet address 10.6.6.6/32 set interfaces lo0 unit 0 family inet6 address ::10.6.6.6/128 set routing-options router-id 10.6.6.6 set routing-options autonomous-system 64496 set routing-options forwarding-table export pplb set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp log-updown set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.6.6.6 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-arp-to-rrs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp_server_v4_v6_peers set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te set protocols bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te set protocols ospf area 0.0.0.0 interface ge-1/1/0.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_pre 10.1.1.1/32 set policy-options prefix-list server_v6_pre ::10.1.1.1/128 set policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3 set policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 1 then accept set policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3 set policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 2 then accept set policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp set policy-options policy-statement exp-arp-to-rrs term 3 then accept set policy-options policy-statement exp-arp-to-rrs term 4 then reject set policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre set policy-options policy-statement exp_server_v4_v6_peers term 1 then accept set policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre set policy-options policy-statement exp_server_v4_v6_peers term 2 then accept set policy-options policy-statement pplb then load-balance per-packet 路由器 R4 set interfaces ge-3/0/2 vlan-tagging set interfaces ge-3/0/2 unit 0 vlan-id 1 set interfaces ge-3/0/2 unit 0 family inet address 10.200.204.1/24 set interfaces ge-3/0/2 unit 0 family inet6 address ::10.200.204.1/120 set interfaces ge-3/0/2 unit 0 family mpls set interfaces ge-3/0/2 unit 1 vlan-id 2 set interfaces ge-3/2/4 unit 0 family inet address 10.100.105.2/30 set interfaces ge-3/2/4 unit 0 family inet6 address ::10.100.105.2/126 set interfaces ge-3/2/4 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.7.7.7/32 set interfaces lo0 unit 0 family inet6 address ::10.7.7.7/128 set routing-options router-id 10.7.7.7 set routing-options autonomous-system 64496 set routing-options forwarding-table export pplb set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.7.7.7 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-arp-to-rrs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group Peer5-6-lan type external set protocols bgp group Peer5-6-lan family inet unicast set protocols bgp group Peer5-6-lan export exp_server_v4_v6_peers set protocols bgp group Peer5-6-lan peer-as 64497 set protocols bgp group Peer5-6-lan-v6 type external set protocols bgp group Peer5-6-lan-v6 family inet6 unicast set protocols bgp group Peer5-6-lan-v6 export exp_server_v4_v6_peers set protocols bgp group Peer5-6-lan-v6 peer-as 64497 set protocols ospf area 0.0.0.0 interface ge-3/2/4.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_pre 10.1.1.1/32 set policy-options prefix-list server_v6_pre ::10.1.1.1/128 set policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3 set policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 1 then accept set policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3 set policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 2 then accept set policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp set policy-options policy-statement exp-arp-to-rrs term 3 then accept set policy-options policy-statement exp-arp-to-rrs term 4 then reject set policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre set policy-options policy-statement exp_server_v4_v6_peers term 1 then accept set policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre set policy-options policy-statement exp_server_v4_v6_peers term 2 then accept set policy-options policy-statement pplb then load-balance per-packet 路由器 R5 set interfaces ge-0/2/1 unit 0 family inet address 10.100.140.1/30 set interfaces ge-0/2/1 unit 0 family inet6 address ::10.100.140.1/126 set interfaces ge-0/3/1 unit 0 family inet address 10.200.203.2/28 set interfaces ge-0/3/1 unit 0 family inet6 address ::10.200.203.2/124 set interfaces ge-0/3/4 unit 0 family inet address 10.200.202.2/30 set interfaces ge-0/3/4 unit 0 family inet6 address ::10.200.202.2/126 set interfaces lo0 unit 0 family inet address 10.8.8.8/32 set interfaces lo0 unit 0 family inet6 address ::10.8.8.8/128 set routing-options router-id 10.8.8.8 set routing-options autonomous-system 64497 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp-lo0 set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.202.1 set protocols bgp group Peer1-lan-1 neighbor 10.200.203.1 set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp-lo0 set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.1 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.1 set protocols bgp group Peer1-H1 type external set protocols bgp group Peer1-H1 family inet unicast set protocols bgp group Peer1-H1 neighbor 10.100.140.2 peer-as 64498 set protocols bgp group Peer1-H1-v6 type external set protocols bgp group Peer1-H1-v6 family inet6 unicast set protocols bgp group Peer1-H1-v6 neighbor ::10.100.140.2 peer-as 64498 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept 路由器 R6 set interfaces ge-1/1/2 unit 0 family inet address 10.100.140.2/30 set interfaces ge-1/1/2 unit 0 family inet6 address ::10.100.140.2/126 set interfaces ge-1/1/5 unit 0 family inet address 10.1.1.1/24 set interfaces ge-1/1/5 unit 0 family inet6 address 2001:db8:10:1:1::1/120 set interfaces lo0 unit 0 family inet address 10.17.17.1/32 set interfaces lo0 unit 0 family inet address 10.17.17.2/32 set interfaces lo0 unit 0 family inet address 10.17.17.3/32 set interfaces lo0 unit 0 family inet address 10.17.17.4/32 set interfaces lo0 unit 0 family inet address 10.17.17.5/32 set interfaces lo0 unit 0 family inet address 10.17.17.6/32 set interfaces lo0 unit 0 family inet address 10.17.17.7/32 set interfaces lo0 unit 0 family inet address 10.17.17.8/32 set interfaces lo0 unit 0 family inet address 10.17.17.9/32 set interfaces lo0 unit 0 family inet6 address ::10.17.17.1/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.2/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.3/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.4/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.5/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.6/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.7/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.8/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.9/128 set routing-options router-id 10.17.17.1 set routing-options autonomous-system 64498 set protocols bgp group H1-Peer1 type external set protocols bgp group H1-Peer1 family inet unicast set protocols bgp group H1-Peer1 export exp-lo0 set protocols bgp group H1-Peer1 neighbor 10.100.140.1 peer-as 64497 set protocols bgp group H1-Peer1-v6 type external set protocols bgp group H1-Peer1-v6 family inet6 unicast set protocols bgp group H1-Peer1-v6 export exp-lo0 set protocols bgp group H1-Peer1-v6 neighbor ::100.100.140.1 peer-as 64497 set protocols bgp group R6RT0 type external set protocols bgp group R6RT0 family inet unicast set protocols bgp group R6RT0 peer-as 65300 set protocols bgp group R6RT0 neighbor 10.1.1.2 set protocols bgp group R6RT0-v6 type external set protocols bgp group R6RT0-v6 family inet6 unicast set protocols bgp group R6RT0-v6 peer-as 65300 set protocols bgp group R6RT0-v6 neighbor 2008:db8:50::2 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept set policy-options policy-statement exp-lo0 term 2 from protocol direct set policy-options policy-statement exp-lo0 term 2 from protocol local set policy-options policy-statement exp-lo0 term 2 then accept 路由器 R7 set interfaces ge-1/0/6 unit 0 family inet address 10.100.141.1/30 set interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.141.1/126 set interfaces ge-1/1/4 vlan-tagging set interfaces ge-1/1/4 unit 0 vlan-id 1 set interfaces ge-1/1/4 unit 0 family inet address 10.200.204.2/24 set interfaces ge-1/1/4 unit 0 family inet6 address ::10.200.204.2/120 set interfaces ge-1/1/4 unit 1 vlan-id 2 set interfaces ge-1/1/4 unit 2 vlan-id 3 set interfaces lo0 unit 0 family inet address 10.9.9.9/32 set interfaces lo0 unit 0 family inet6 address ::10.9.9.9/128 set routing-options router-id 10.9.9.9 set routing-options autonomous-system 64497 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp-lo0 set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.204.1 set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp-lo0 set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.204.1 set protocols bgp group Peer2-H2 type external set protocols bgp group Peer2-H2 family inet unicast set protocols bgp group Peer2-H2 neighbor 10.100.141.2 peer-as 64499 set protocols bgp group Peer2-H2-v6 type external set protocols bgp group Peer2-H2-v6 family inet6 unicast set protocols bgp group Peer2-H2-v6 neighbor ::10.100.141.2 peer-as 64499 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept 路由器 R8 set interfaces ge-4/0/5 unit 0 family inet address 10.100.141.2/30 set interfaces ge-4/0/5 unit 0 family inet6 address ::10.100.141.2/126 set interfaces lo0 unit 0 family inet address 10.18.18.1/32 set interfaces lo0 unit 0 family inet address 10.18.18.2/32 set interfaces lo0 unit 0 family inet address 10.18.18.3/32 set interfaces lo0 unit 0 family inet address 10.18.18.4/32 set interfaces lo0 unit 0 family inet address 10.18.18.5/32 set interfaces lo0 unit 0 family inet address 10.18.18.6/32 set interfaces lo0 unit 0 family inet address 10.18.18.7/32 set interfaces lo0 unit 0 family inet address 10.18.18.8/32 set interfaces lo0 unit 0 family inet address 10.18.18.9/32 set interfaces lo0 unit 0 family inet6 address ::10.18.18.1/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.2/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.3/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.4/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.5/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.6/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.7/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.8/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.9/128 set routing-options router-id 10.18.18.1 set routing-options autonomous-system 64499 set protocols bgp group H2-Peer2 type external set protocols bgp group H2-Peer2 family inet unicast set protocols bgp group H2-Peer2 export exp-lo0 set protocols bgp group H2-Peer2 neighbor 10.100.141.1 peer-as 64497 set protocols bgp group H2-Peer2-v6 type external set protocols bgp group H2-Peer2-v6 family inet6 unicast set protocols bgp group H2-Peer2-v6 export exp-lo0 set protocols bgp group H2-Peer2-v6 neighbor ::10.100.141.1 peer-as 64497 set protocols bgp group R8RT0 type external set protocols bgp group R8RT0 family inet unicast set protocols bgp group R8RT0 peer-as 65400 set protocols bgp group R8RT0 neighbor 10.1.1.2 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept set policy-options policy-statement exp-lo0 term 2 then reject 以下示例要求您在配置层次结构中导航各个级别。有关导航 CLI 的信息，请参阅 CLI 用户指南中的在配置模式下使用 CLI 编辑器。 要配置路由器 R3： 注： 修改相应的接口名称、地址和其他参数后，对其他路由器重复此过程。 修改相应的接口名称、地址和其他参数后，对其他路由器重复此过程。 使用 IPv4 和 IPv6 地址配置接口。 [edit interfaces] user@R3# set ge-1/1/0 unit 0 family inet address 10.100.104.2/30 user@R3# set ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126 user@R3# set ge-1/1/0 unit 0 family mpls user@R3# set ge-2/2/5 unit 0 family inet address 10.200.203.1/28 user@R3# set ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124 user@R3# set ge-2/2/8 unit 0 family inet address 10.200.202.1/30 user@R3# set ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126 配置环路地址。 [edit interfaces] user@R3# set lo0 unit 0 family inet address 10.6.6.6/32 user@R3# set lo0 unit 0 family inet6 address ::10.6.6.6/128 配置路由器 ID 和自治系统 (AS) 编号。 [edit routing-options] user@R3# set router-id 10.6.6.6 user@R3# set autonomous-system 64496 为除管理接口以外的所有接口配置 RSVP 协议。 [edit protocols] user@R3# set rsvp interface all user@R3# set rsvp interface fxp0.0 disable 为除管理接口以外的所有接口配置 MPLS 协议。 [edit protocols] user@R3# set mpls ipv6-tunneling user@R3# set mpls interface all user@R3# set mpls interface fxp0.0 disable 在面向核心的接口上配置 IBGP 对等会话。 [edit protocols] user@R3# set bgp log-updown user@R3# set bgp group RR-1-2 type internal user@R3# set bgp group RR-1-2 local-address 10.6.6.6 user@R3# set bgp group RR-1-2 family inet unicast add-path receive user@R3# set bgp group RR-1-2 family inet unicast add-path send path-count 6 user@R3# set bgp group RR-1-2 family inet labeled-unicast rib inet.3 user@R3# set bgp group RR-1-2 family inet6 unicast add-path receive user@R3# set bgp group RR-1-2 family inet6 unicast add-path send path-count 6 user@R3# set bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 user@R3# set bgp group RR-1-2 neighbor 10.4.4.4 在面向外部边缘路由器的接口上配置 EBGP 对等会话。 [edit protocols] user@R3# set bgp group Peer1-lan-1 type external user@R3# set bgp group Peer1-lan-1 family inet unicast user@R3# set bgp group Peer1-lan-1 peer-as 64497 user@R3# set bgp group Peer1-lan-1-v6 family inet6 unicast user@R3# set bgp group Peer1-lan-1-v6 peer-as 64497 为外部 BGP 组 Peer1-lan-1 和 IPv6 组 Peer1-lan-1-v6 启用出口对等流量工程。 [edit protocols] user@R3# set bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te user@R3# set bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te 将 OSPF 协议配置为 IGP。 [edit protocols] user@R3# set ospf area 0.0.0.0 interface ge-1/1/0.0 user@R3# set ospf area 0.0.0.0 interface fxp0.0 disable user@R3# set ospf area 0.0.0.0 interface lo0.0 passive user@R3# set ldp interface all user@R3# set ldp interface fxp0.0 disable 定义用于将 ARP 路由导出到路由反射器的策略。 [edit policy-options] user@R3# set policy-statement exp-arp-to-rrs term 1 from protocol arp user@R3# set policy-statement exp-arp-to-rrs term 1 from rib inet.3 user@R3# set policy-statement exp-arp-to-rrs term 1 then next-hop self user@R3# set policy-statement exp-arp-to-rrs term 1 then accept user@R3# set policy-statement exp-arp-to-rrs term 2 from protocol arp user@R3# set policy-statement exp-arp-to-rrs term 2 from rib inet6.3 user@R3# set policy-statement exp-arp-to-rrs term 2 then next-hop self user@R3# set policy-statement exp-arp-to-rrs term 2 then accept user@R3# set policy-statement exp-arp-to-rrs term 3 from protocol bgp user@R3# set policy-statement exp-arp-to-rrs term 3 then accept user@R3# set policy-statement exp-arp-to-rrs term 4 then reject 应用 exp-arp-to-rrs 用于导出 ARP 路由的策略，将路由反射器应用到外部 BGP 组 ebgp-v6。 [edit protocols] user@R3# set bgp group RR-1-2 export exp-arp-to-rrs 使用 IPv4 和 IPv6 路由定义前缀列表。 [edit policy-options] user@R3# set prefix-list server_v4_pre 10.1.1.1/32 user@R3# set prefix-list server_v6_pre ::10.1.1.1/128 定义用于将 IPv4 和 IPv6 路由导出到服务器的策略。 [edit policy-options] user@R3# set policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre user@R3# set policy-statement exp_server_v4_v6_peers term 1 then accept user@R3# set policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre user@R3# set policy-statement exp_server_v4_v6_peers term 2 then accept 应用策略以导出 IPv4 和 IPv6 对等路由。 [edit protocols] user@R3# set bgp group Peer1-lan-1 export exp_server_v4_v6_peers user@R3# set bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers 定义按数据包负载均衡策略。 [edit policy-options] user@R3# set policy-statement pplb then load-balance per-packet 应用按数据包负载均衡策略。 [edit routing-options] user@R3# set forwarding-table export pplb 在配置模式下，输入 show interfaces 、 show protocols 、 show routing-options 和 show policy-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 [edit] user@R3# show interfaces ge-1/1/0 { unit 0 { family inet { address 10.100.104.2/30; } family inet6 { address ::10.100.104.2/126; } family mpls; } } ge-2/2/5 { unit 0 { family inet { address 100.200.203.1/28; } family inet6 { address ::10.200.203.1/124; } } } ge-2/2/8 { unit 0 { family inet { address 10.200.202.1/30; } family inet6 { address ::10.200.202.1/126; } } } lo0 { unit 0 { family inet { address 10.6.6.6/32; } family inet6 { address ::10.6.6.6/128; } } } [edit] user@R3# show protocols rsvp { interface all; interface fxp0.0 { disable; } } mpls { ipv6-tunneling; interface all; interface fxp0.0 { disable; } } bgp { log-updown; group RR-1-2 { type internal; local-address 10.6.6.6; family inet { unicast { add-path { receive; send { path-count 6; } } } labeled-unicast { rib { inet.3; } } } family inet6 { unicast { add-path { receive; send { path-count 6; } } } labeled-unicast { rib { inet6.3; } } } export exp-arp-to-rrs; neighbor 10.4.4.4; } group Peer1-lan-1 { type external; family inet { unicast; } export exp_server_v4_v6_peers; peer-as 64497; neighbor 10.200.202.2 { egress-te; } neighbor 10.200.203.2 { egress-te; } } group Peer1-lan-1-v6 { family inet6 { unicast; } export exp_server_v4_v6_peers; peer-as 64497; neighbor ::10.200.202.2 { egress-te; } neighbor ::10.200.203.2 { egress-te; } } } ospf { area 0.0.0.0 { interface ge-1/1/0.0; interface fxp0.0 { disable; } interface lo0.0 { passive; } } } ldp { interface all; interface fxp0.0 { disable; } } [edit] user@R3# show routing-options router-id 10.6.6.6; autonomous-system 64496; forwarding-table { export pplb; } [edit] user@R3# show policy-options prefix-list server_v4_pre { 10.1.1.1/32; } prefix-list server_v6_pre { ::10.1.1.1/128; } policy-statement exp-arp-to-rrs { term 1 { from { protocol arp; rib inet.3; } then { next-hop self; accept; } } term 2 { from { protocol arp; rib inet6.3; } then { next-hop self; accept; } } term 3 { from protocol bgp; then accept; } term 4 { then reject; } } policy-statement exp_server_v4_v6_peers { term 1 { from { prefix-list server_v4_pre; } then accept; } term 2 { from { prefix-list server_v6_pre; } then accept; } } policy-statement pplb { then { load-balance per-packet; } } }",
      "sections": [
        {
          "title": "CLI 快速配置",
          "level": 4,
          "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改详细信息，以便与网络配置匹配，将命令复制并粘贴到 [edit] 层级的 CLI 中，然后从配置模式进入 commit 。 路由器 R0 set interfaces ge-2/0/1 unit 0 family inet address 10.1.1.1/24 set interfaces ge-2/0/1 unit 0 family inet6 address 2001:db8:10:1:1::1/64 set interfaces ge-2/1/4 unit 0 family inet address 10.100.100.1/30 set interfaces ge-2/1/4 unit 0 family inet6 address ::10.100.100.1/126 set interfaces ge-2/1/4 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.1.1.1/32 set interfaces lo0 unit 0 family inet6 address ::10.1.1.1/128 set routing-options router-id 01.1.1.1 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls no-cspf set protocols mpls label-switched-path to_asbr1_r3 to 10.6.6.6 set protocols mpls label-switched-path to_asbr2_r4 to 10.7.7.7 set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.1.1.1 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-svr-pre set protocols bgp group RR-1-2 export nhs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group R0RT0 type external set protocols bgp group R0RT0 family inet unicast set protocols bgp group R0RT0 peer-as 64496 set protocols bgp group R0RT0 neighbor 10.1.1.2 set protocols bgp group R0RT0-v6 type external set protocols bgp group R0RT0-v6 family inet6 unicast set protocols bgp group R0RT0-v6 peer-as 64496 set protocols bgp group R0RT0-v6 neighbor 2001:db8:40::2 set protocols ospf area 0.0.0.0 interface ge-2/1/4.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_prefix 10.1.1.1/32 set policy-options prefix-list server_v6_prefix ::10.1.1.1/128 set policy-options policy-statement exp-svr-pre term 1 from prefix-list server_v4_prefix set policy-options policy-statement exp-svr-pre term 1 then accept set policy-options policy-statement exp-svr-pre term 2 from prefix-list server_v6_prefix set policy-options policy-statement exp-svr-pre term 2 then accept set policy-options policy-statement nhs then next-hop self 路由器 R1 set interfaces ge-1/0/4 unit 0 family inet address 00.100.100.2/30 set interfaces ge-1/0/4 unit 0 family inet6 address ::00.100.100.2/126 set interfaces ge-1/0/4 unit 0 family mpls set interfaces ge-1/0/6 unit 0 family inet address 10.100.104.1/30 set interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.104.1/126 set interfaces ge-1/0/6 unit 0 family mpls set interfaces ge-1/0/9 unit 0 family inet address 100.100.105.1/30 set interfaces ge-1/0/9 unit 0 family inet6 address ::10.100.105.1/126 set interfaces ge-1/0/9 unit 0 family mpls set interfaces ge-1/1/3 unit 0 family inet address 10.100.102.1/30 set interfaces ge-1/1/3 unit 0 family inet6 address ::10.100.102.1/126 set interfaces ge-1/1/3 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.3.3.3/32 set interfaces lo0 unit 0 family inet6 address ::10.3.3.3/128 set routing-options router-id 10.3.3.3 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface all set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable 路由器 R2 set interfaces et-0/0/0 unit 0 family inet address 10.100.102.2/30 set interfaces et-0/0/0 unit 0 family inet6 address ::10.100.102.2/126 set interfaces et-0/0/0 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.4.4.4/32 set interfaces lo0 unit 0 family inet6 address ::10.4.4.4/128 set routing-options router-id 10.4.4.4 set routing-options autonomous-system 64496 set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group Client type internal set protocols bgp group Client local-address 10.4.4.4 set protocols bgp group Client advertise-inactive set protocols bgp group Client family inet unicast add-path receive set protocols bgp group Client family inet unicast add-path send path-count 6 set protocols bgp group Client family inet labeled-unicast rib inet.3 set protocols bgp group Client family inet6 unicast add-path receive set protocols bgp group Client family inet6 unicast add-path send path-count 6 set protocols bgp group Client family inet6 labeled-unicast rib inet6.3 set protocols bgp group Client cluster 10.4.4.4 set protocols bgp group Client neighbor 10.1.1.1 set protocols bgp group Client neighbor 10.6.6.6 set protocols bgp group Client neighbor 10.7.7.7 set protocols ospf area 0.0.0.0 interface et-0/0/0.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable 路由器 R3 set interfaces ge-1/1/0 unit 0 family inet address 10.100.104.2/30 set interfaces ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126 set interfaces ge-1/1/0 unit 0 family mpls set interfaces ge-2/2/5 unit 0 family inet address 10.200.203.1/28 set interfaces ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124 set interfaces ge-2/2/8 unit 0 family inet address 10.200.202.1/30 set interfaces ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126 set interfaces lo0 unit 0 family inet address 10.6.6.6/32 set interfaces lo0 unit 0 family inet6 address ::10.6.6.6/128 set routing-options router-id 10.6.6.6 set routing-options autonomous-system 64496 set routing-options forwarding-table export pplb set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp log-updown set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.6.6.6 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-arp-to-rrs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp_server_v4_v6_peers set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te set protocols bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te set protocols ospf area 0.0.0.0 interface ge-1/1/0.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_pre 10.1.1.1/32 set policy-options prefix-list server_v6_pre ::10.1.1.1/128 set policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3 set policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 1 then accept set policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3 set policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 2 then accept set policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp set policy-options policy-statement exp-arp-to-rrs term 3 then accept set policy-options policy-statement exp-arp-to-rrs term 4 then reject set policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre set policy-options policy-statement exp_server_v4_v6_peers term 1 then accept set policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre set policy-options policy-statement exp_server_v4_v6_peers term 2 then accept set policy-options policy-statement pplb then load-balance per-packet 路由器 R4 set interfaces ge-3/0/2 vlan-tagging set interfaces ge-3/0/2 unit 0 vlan-id 1 set interfaces ge-3/0/2 unit 0 family inet address 10.200.204.1/24 set interfaces ge-3/0/2 unit 0 family inet6 address ::10.200.204.1/120 set interfaces ge-3/0/2 unit 0 family mpls set interfaces ge-3/0/2 unit 1 vlan-id 2 set interfaces ge-3/2/4 unit 0 family inet address 10.100.105.2/30 set interfaces ge-3/2/4 unit 0 family inet6 address ::10.100.105.2/126 set interfaces ge-3/2/4 unit 0 family mpls set interfaces lo0 unit 0 family inet address 10.7.7.7/32 set interfaces lo0 unit 0 family inet6 address ::10.7.7.7/128 set routing-options router-id 10.7.7.7 set routing-options autonomous-system 64496 set routing-options forwarding-table export pplb set protocols rsvp interface all set protocols rsvp interface fxp0.0 disable set protocols mpls ipv6-tunneling set protocols mpls interface all set protocols mpls interface fxp0.0 disable set protocols bgp group RR-1-2 type internal set protocols bgp group RR-1-2 local-address 10.7.7.7 set protocols bgp group RR-1-2 family inet unicast add-path receive set protocols bgp group RR-1-2 family inet unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3 set protocols bgp group RR-1-2 family inet6 unicast add-path receive set protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6 set protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 set protocols bgp group RR-1-2 export exp-arp-to-rrs set protocols bgp group RR-1-2 neighbor 10.4.4.4 set protocols bgp group Peer5-6-lan type external set protocols bgp group Peer5-6-lan family inet unicast set protocols bgp group Peer5-6-lan export exp_server_v4_v6_peers set protocols bgp group Peer5-6-lan peer-as 64497 set protocols bgp group Peer5-6-lan-v6 type external set protocols bgp group Peer5-6-lan-v6 family inet6 unicast set protocols bgp group Peer5-6-lan-v6 export exp_server_v4_v6_peers set protocols bgp group Peer5-6-lan-v6 peer-as 64497 set protocols ospf area 0.0.0.0 interface ge-3/2/4.0 set protocols ospf area 0.0.0.0 interface fxp0.0 disable set protocols ospf area 0.0.0.0 interface lo0.0 passive set protocols ldp interface all set protocols ldp interface fxp0.0 disable set policy-options prefix-list server_v4_pre 10.1.1.1/32 set policy-options prefix-list server_v6_pre ::10.1.1.1/128 set policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3 set policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 1 then accept set policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp set policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3 set policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self set policy-options policy-statement exp-arp-to-rrs term 2 then accept set policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp set policy-options policy-statement exp-arp-to-rrs term 3 then accept set policy-options policy-statement exp-arp-to-rrs term 4 then reject set policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre set policy-options policy-statement exp_server_v4_v6_peers term 1 then accept set policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre set policy-options policy-statement exp_server_v4_v6_peers term 2 then accept set policy-options policy-statement pplb then load-balance per-packet 路由器 R5 set interfaces ge-0/2/1 unit 0 family inet address 10.100.140.1/30 set interfaces ge-0/2/1 unit 0 family inet6 address ::10.100.140.1/126 set interfaces ge-0/3/1 unit 0 family inet address 10.200.203.2/28 set interfaces ge-0/3/1 unit 0 family inet6 address ::10.200.203.2/124 set interfaces ge-0/3/4 unit 0 family inet address 10.200.202.2/30 set interfaces ge-0/3/4 unit 0 family inet6 address ::10.200.202.2/126 set interfaces lo0 unit 0 family inet address 10.8.8.8/32 set interfaces lo0 unit 0 family inet6 address ::10.8.8.8/128 set routing-options router-id 10.8.8.8 set routing-options autonomous-system 64497 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp-lo0 set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.202.1 set protocols bgp group Peer1-lan-1 neighbor 10.200.203.1 set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp-lo0 set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.1 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.1 set protocols bgp group Peer1-H1 type external set protocols bgp group Peer1-H1 family inet unicast set protocols bgp group Peer1-H1 neighbor 10.100.140.2 peer-as 64498 set protocols bgp group Peer1-H1-v6 type external set protocols bgp group Peer1-H1-v6 family inet6 unicast set protocols bgp group Peer1-H1-v6 neighbor ::10.100.140.2 peer-as 64498 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept 路由器 R6 set interfaces ge-1/1/2 unit 0 family inet address 10.100.140.2/30 set interfaces ge-1/1/2 unit 0 family inet6 address ::10.100.140.2/126 set interfaces ge-1/1/5 unit 0 family inet address 10.1.1.1/24 set interfaces ge-1/1/5 unit 0 family inet6 address 2001:db8:10:1:1::1/120 set interfaces lo0 unit 0 family inet address 10.17.17.1/32 set interfaces lo0 unit 0 family inet address 10.17.17.2/32 set interfaces lo0 unit 0 family inet address 10.17.17.3/32 set interfaces lo0 unit 0 family inet address 10.17.17.4/32 set interfaces lo0 unit 0 family inet address 10.17.17.5/32 set interfaces lo0 unit 0 family inet address 10.17.17.6/32 set interfaces lo0 unit 0 family inet address 10.17.17.7/32 set interfaces lo0 unit 0 family inet address 10.17.17.8/32 set interfaces lo0 unit 0 family inet address 10.17.17.9/32 set interfaces lo0 unit 0 family inet6 address ::10.17.17.1/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.2/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.3/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.4/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.5/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.6/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.7/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.8/128 set interfaces lo0 unit 0 family inet6 address ::10.17.17.9/128 set routing-options router-id 10.17.17.1 set routing-options autonomous-system 64498 set protocols bgp group H1-Peer1 type external set protocols bgp group H1-Peer1 family inet unicast set protocols bgp group H1-Peer1 export exp-lo0 set protocols bgp group H1-Peer1 neighbor 10.100.140.1 peer-as 64497 set protocols bgp group H1-Peer1-v6 type external set protocols bgp group H1-Peer1-v6 family inet6 unicast set protocols bgp group H1-Peer1-v6 export exp-lo0 set protocols bgp group H1-Peer1-v6 neighbor ::100.100.140.1 peer-as 64497 set protocols bgp group R6RT0 type external set protocols bgp group R6RT0 family inet unicast set protocols bgp group R6RT0 peer-as 65300 set protocols bgp group R6RT0 neighbor 10.1.1.2 set protocols bgp group R6RT0-v6 type external set protocols bgp group R6RT0-v6 family inet6 unicast set protocols bgp group R6RT0-v6 peer-as 65300 set protocols bgp group R6RT0-v6 neighbor 2008:db8:50::2 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept set policy-options policy-statement exp-lo0 term 2 from protocol direct set policy-options policy-statement exp-lo0 term 2 from protocol local set policy-options policy-statement exp-lo0 term 2 then accept 路由器 R7 set interfaces ge-1/0/6 unit 0 family inet address 10.100.141.1/30 set interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.141.1/126 set interfaces ge-1/1/4 vlan-tagging set interfaces ge-1/1/4 unit 0 vlan-id 1 set interfaces ge-1/1/4 unit 0 family inet address 10.200.204.2/24 set interfaces ge-1/1/4 unit 0 family inet6 address ::10.200.204.2/120 set interfaces ge-1/1/4 unit 1 vlan-id 2 set interfaces ge-1/1/4 unit 2 vlan-id 3 set interfaces lo0 unit 0 family inet address 10.9.9.9/32 set interfaces lo0 unit 0 family inet6 address ::10.9.9.9/128 set routing-options router-id 10.9.9.9 set routing-options autonomous-system 64497 set protocols bgp group Peer1-lan-1 type external set protocols bgp group Peer1-lan-1 family inet unicast set protocols bgp group Peer1-lan-1 export exp-lo0 set protocols bgp group Peer1-lan-1 peer-as 64497 set protocols bgp group Peer1-lan-1 neighbor 10.200.204.1 set protocols bgp group Peer1-lan-1-v6 family inet6 unicast set protocols bgp group Peer1-lan-1-v6 export exp-lo0 set protocols bgp group Peer1-lan-1-v6 peer-as 64497 set protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.204.1 set protocols bgp group Peer2-H2 type external set protocols bgp group Peer2-H2 family inet unicast set protocols bgp group Peer2-H2 neighbor 10.100.141.2 peer-as 64499 set protocols bgp group Peer2-H2-v6 type external set protocols bgp group Peer2-H2-v6 family inet6 unicast set protocols bgp group Peer2-H2-v6 neighbor ::10.100.141.2 peer-as 64499 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept 路由器 R8 set interfaces ge-4/0/5 unit 0 family inet address 10.100.141.2/30 set interfaces ge-4/0/5 unit 0 family inet6 address ::10.100.141.2/126 set interfaces lo0 unit 0 family inet address 10.18.18.1/32 set interfaces lo0 unit 0 family inet address 10.18.18.2/32 set interfaces lo0 unit 0 family inet address 10.18.18.3/32 set interfaces lo0 unit 0 family inet address 10.18.18.4/32 set interfaces lo0 unit 0 family inet address 10.18.18.5/32 set interfaces lo0 unit 0 family inet address 10.18.18.6/32 set interfaces lo0 unit 0 family inet address 10.18.18.7/32 set interfaces lo0 unit 0 family inet address 10.18.18.8/32 set interfaces lo0 unit 0 family inet address 10.18.18.9/32 set interfaces lo0 unit 0 family inet6 address ::10.18.18.1/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.2/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.3/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.4/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.5/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.6/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.7/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.8/128 set interfaces lo0 unit 0 family inet6 address ::10.18.18.9/128 set routing-options router-id 10.18.18.1 set routing-options autonomous-system 64499 set protocols bgp group H2-Peer2 type external set protocols bgp group H2-Peer2 family inet unicast set protocols bgp group H2-Peer2 export exp-lo0 set protocols bgp group H2-Peer2 neighbor 10.100.141.1 peer-as 64497 set protocols bgp group H2-Peer2-v6 type external set protocols bgp group H2-Peer2-v6 family inet6 unicast set protocols bgp group H2-Peer2-v6 export exp-lo0 set protocols bgp group H2-Peer2-v6 neighbor ::10.100.141.1 peer-as 64497 set protocols bgp group R8RT0 type external set protocols bgp group R8RT0 family inet unicast set protocols bgp group R8RT0 peer-as 65400 set protocols bgp group R8RT0 neighbor 10.1.1.2 set policy-options policy-statement exp-lo0 term 1 from interface lo0.0 set policy-options policy-statement exp-lo0 term 1 then accept set policy-options policy-statement exp-lo0 term 2 then reject",
          "commands_by_device": {
            "路由器 R0": "set interfaces ge-2/0/1 unit 0 family inet address 10.1.1.1/24\nset interfaces ge-2/0/1 unit 0 family inet6 address 2001:db8:10:1:1::1/64\nset interfaces ge-2/1/4 unit 0 family inet address 10.100.100.1/30\nset interfaces ge-2/1/4 unit 0 family inet6 address ::10.100.100.1/126\nset interfaces ge-2/1/4 unit 0 family mpls\nset interfaces lo0 unit 0 family inet address 10.1.1.1/32\nset interfaces lo0 unit 0 family inet6 address ::10.1.1.1/128\nset routing-options router-id 01.1.1.1\nset routing-options autonomous-system 64496\nset protocols rsvp interface all\nset protocols rsvp interface fxp0.0 disable\nset protocols mpls ipv6-tunneling\nset protocols mpls no-cspf\nset protocols mpls label-switched-path to_asbr1_r3 to 10.6.6.6\nset protocols mpls label-switched-path to_asbr2_r4 to 10.7.7.7\nset protocols mpls interface all\nset protocols mpls interface fxp0.0 disable\nset protocols bgp group RR-1-2 type internal\nset protocols bgp group RR-1-2 local-address 10.1.1.1\nset protocols bgp group RR-1-2 family inet unicast add-path receive\nset protocols bgp group RR-1-2 family inet unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3\nset protocols bgp group RR-1-2 family inet6 unicast add-path receive\nset protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3\nset protocols bgp group RR-1-2 export exp-svr-pre\nset protocols bgp group RR-1-2 export nhs\nset protocols bgp group RR-1-2 neighbor 10.4.4.4\nset protocols bgp group R0RT0 type external\nset protocols bgp group R0RT0 family inet unicast\nset protocols bgp group R0RT0 peer-as 64496\nset protocols bgp group R0RT0 neighbor 10.1.1.2\nset protocols bgp group R0RT0-v6 type external\nset protocols bgp group R0RT0-v6 family inet6 unicast\nset protocols bgp group R0RT0-v6 peer-as 64496\nset protocols bgp group R0RT0-v6 neighbor 2001:db8:40::2\nset protocols ospf area 0.0.0.0 interface ge-2/1/4.0\nset protocols ospf area 0.0.0.0 interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface lo0.0 passive\nset protocols ldp interface all\nset protocols ldp interface fxp0.0 disable\nset policy-options prefix-list server_v4_prefix 10.1.1.1/32\nset policy-options prefix-list server_v6_prefix ::10.1.1.1/128\nset policy-options policy-statement exp-svr-pre term 1 from prefix-list server_v4_prefix\nset policy-options policy-statement exp-svr-pre term 1 then accept\nset policy-options policy-statement exp-svr-pre term 2 from prefix-list server_v6_prefix\nset policy-options policy-statement exp-svr-pre term 2 then accept\nset policy-options policy-statement nhs then next-hop self",
            "路由器 R1": "set interfaces ge-1/0/4 unit 0 family inet address 00.100.100.2/30\nset interfaces ge-1/0/4 unit 0 family inet6 address ::00.100.100.2/126\nset interfaces ge-1/0/4 unit 0 family mpls\nset interfaces ge-1/0/6 unit 0 family inet address 10.100.104.1/30\nset interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.104.1/126\nset interfaces ge-1/0/6 unit 0 family mpls\nset interfaces ge-1/0/9 unit 0 family inet address 100.100.105.1/30\nset interfaces ge-1/0/9 unit 0 family inet6 address ::10.100.105.1/126\nset interfaces ge-1/0/9 unit 0 family mpls\nset interfaces ge-1/1/3 unit 0 family inet address 10.100.102.1/30\nset interfaces ge-1/1/3 unit 0 family inet6 address ::10.100.102.1/126\nset interfaces ge-1/1/3 unit 0 family mpls\nset interfaces lo0 unit 0 family inet address 10.3.3.3/32\nset interfaces lo0 unit 0 family inet6 address ::10.3.3.3/128\nset routing-options router-id 10.3.3.3\nset routing-options autonomous-system 64496\nset protocols rsvp interface all\nset protocols rsvp interface fxp0.0 disable\nset protocols mpls ipv6-tunneling\nset protocols mpls interface all\nset protocols mpls interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface all\nset protocols ospf area 0.0.0.0 interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface lo0.0 passive\nset protocols ldp interface all\nset protocols ldp interface fxp0.0 disable",
            "路由器 R2": "set interfaces et-0/0/0 unit 0 family inet address 10.100.102.2/30\nset interfaces et-0/0/0 unit 0 family inet6 address ::10.100.102.2/126\nset interfaces et-0/0/0 unit 0 family mpls\nset interfaces lo0 unit 0 family inet address 10.4.4.4/32\nset interfaces lo0 unit 0 family inet6 address ::10.4.4.4/128\nset routing-options router-id 10.4.4.4\nset routing-options autonomous-system 64496\nset protocols rsvp interface all\nset protocols rsvp interface fxp0.0 disable\nset protocols mpls ipv6-tunneling\nset protocols mpls interface all\nset protocols mpls interface fxp0.0 disable\nset protocols bgp group Client type internal\nset protocols bgp group Client local-address 10.4.4.4\nset protocols bgp group Client advertise-inactive\nset protocols bgp group Client family inet unicast add-path receive\nset protocols bgp group Client family inet unicast add-path send path-count 6\nset protocols bgp group Client family inet labeled-unicast rib inet.3\nset protocols bgp group Client family inet6 unicast add-path receive\nset protocols bgp group Client family inet6 unicast add-path send path-count 6\nset protocols bgp group Client family inet6 labeled-unicast rib inet6.3\nset protocols bgp group Client cluster 10.4.4.4\nset protocols bgp group Client neighbor 10.1.1.1\nset protocols bgp group Client neighbor 10.6.6.6\nset protocols bgp group Client neighbor 10.7.7.7\nset protocols ospf area 0.0.0.0 interface et-0/0/0.0\nset protocols ospf area 0.0.0.0 interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface lo0.0 passive\nset protocols ldp interface all\nset protocols ldp interface fxp0.0 disable",
            "路由器 R3": "set interfaces ge-1/1/0 unit 0 family inet address 10.100.104.2/30\nset interfaces ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126\nset interfaces ge-1/1/0 unit 0 family mpls\nset interfaces ge-2/2/5 unit 0 family inet address 10.200.203.1/28\nset interfaces ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124\nset interfaces ge-2/2/8 unit 0 family inet address 10.200.202.1/30\nset interfaces ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126\nset interfaces lo0 unit 0 family inet address 10.6.6.6/32\nset interfaces lo0 unit 0 family inet6 address ::10.6.6.6/128\nset routing-options router-id 10.6.6.6\nset routing-options autonomous-system 64496\nset routing-options forwarding-table export pplb\nset protocols rsvp interface all\nset protocols rsvp interface fxp0.0 disable\nset protocols mpls ipv6-tunneling\nset protocols mpls interface all\nset protocols mpls interface fxp0.0 disable\nset protocols bgp log-updown\nset protocols bgp group RR-1-2 type internal\nset protocols bgp group RR-1-2 local-address 10.6.6.6\nset protocols bgp group RR-1-2 family inet unicast add-path receive\nset protocols bgp group RR-1-2 family inet unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3\nset protocols bgp group RR-1-2 family inet6 unicast add-path receive\nset protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3\nset protocols bgp group RR-1-2 export exp-arp-to-rrs\nset protocols bgp group RR-1-2 neighbor 10.4.4.4\nset protocols bgp group Peer1-lan-1 type external\nset protocols bgp group Peer1-lan-1 family inet unicast\nset protocols bgp group Peer1-lan-1 export exp_server_v4_v6_peers\nset protocols bgp group Peer1-lan-1 peer-as 64497\nset protocols bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te\nset protocols bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te\nset protocols bgp group Peer1-lan-1-v6 family inet6 unicast\nset protocols bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers\nset protocols bgp group Peer1-lan-1-v6 peer-as 64497\nset protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te\nset protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te\nset protocols ospf area 0.0.0.0 interface ge-1/1/0.0\nset protocols ospf area 0.0.0.0 interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface lo0.0 passive\nset protocols ldp interface all\nset protocols ldp interface fxp0.0 disable\nset policy-options prefix-list server_v4_pre 10.1.1.1/32\nset policy-options prefix-list server_v6_pre ::10.1.1.1/128\nset policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp\nset policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3\nset policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self\nset policy-options policy-statement exp-arp-to-rrs term 1 then accept\nset policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp\nset policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3\nset policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self\nset policy-options policy-statement exp-arp-to-rrs term 2 then accept\nset policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp\nset policy-options policy-statement exp-arp-to-rrs term 3 then accept\nset policy-options policy-statement exp-arp-to-rrs term 4 then reject\nset policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre\nset policy-options policy-statement exp_server_v4_v6_peers term 1 then accept\nset policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre\nset policy-options policy-statement exp_server_v4_v6_peers term 2 then accept\nset policy-options policy-statement pplb then load-balance per-packet",
            "路由器 R4": "set interfaces ge-3/0/2 vlan-tagging\nset interfaces ge-3/0/2 unit 0 vlan-id 1\nset interfaces ge-3/0/2 unit 0 family inet address 10.200.204.1/24\nset interfaces ge-3/0/2 unit 0 family inet6 address ::10.200.204.1/120\nset interfaces ge-3/0/2 unit 0 family mpls\nset interfaces ge-3/0/2 unit 1 vlan-id 2\nset interfaces ge-3/2/4 unit 0 family inet address 10.100.105.2/30\nset interfaces ge-3/2/4 unit 0 family inet6 address ::10.100.105.2/126\nset interfaces ge-3/2/4 unit 0 family mpls\nset interfaces lo0 unit 0 family inet address 10.7.7.7/32\nset interfaces lo0 unit 0 family inet6 address ::10.7.7.7/128\nset routing-options router-id 10.7.7.7\nset routing-options autonomous-system 64496\nset routing-options forwarding-table export pplb\nset protocols rsvp interface all\nset protocols rsvp interface fxp0.0 disable\nset protocols mpls ipv6-tunneling\nset protocols mpls interface all\nset protocols mpls interface fxp0.0 disable\nset protocols bgp group RR-1-2 type internal\nset protocols bgp group RR-1-2 local-address 10.7.7.7\nset protocols bgp group RR-1-2 family inet unicast add-path receive\nset protocols bgp group RR-1-2 family inet unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet labeled-unicast rib inet.3\nset protocols bgp group RR-1-2 family inet6 unicast add-path receive\nset protocols bgp group RR-1-2 family inet6 unicast add-path send path-count 6\nset protocols bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3\nset protocols bgp group RR-1-2 export exp-arp-to-rrs\nset protocols bgp group RR-1-2 neighbor 10.4.4.4\nset protocols bgp group Peer5-6-lan type external\nset protocols bgp group Peer5-6-lan family inet unicast\nset protocols bgp group Peer5-6-lan export exp_server_v4_v6_peers\nset protocols bgp group Peer5-6-lan peer-as 64497\nset protocols bgp group Peer5-6-lan-v6 type external\nset protocols bgp group Peer5-6-lan-v6 family inet6 unicast\nset protocols bgp group Peer5-6-lan-v6 export exp_server_v4_v6_peers\nset protocols bgp group Peer5-6-lan-v6 peer-as 64497\nset protocols ospf area 0.0.0.0 interface ge-3/2/4.0\nset protocols ospf area 0.0.0.0 interface fxp0.0 disable\nset protocols ospf area 0.0.0.0 interface lo0.0 passive\nset protocols ldp interface all\nset protocols ldp interface fxp0.0 disable\nset policy-options prefix-list server_v4_pre 10.1.1.1/32\nset policy-options prefix-list server_v6_pre ::10.1.1.1/128\nset policy-options policy-statement exp-arp-to-rrs term 1 from protocol arp\nset policy-options policy-statement exp-arp-to-rrs term 1 from rib inet.3\nset policy-options policy-statement exp-arp-to-rrs term 1 then next-hop self\nset policy-options policy-statement exp-arp-to-rrs term 1 then accept\nset policy-options policy-statement exp-arp-to-rrs term 2 from protocol arp\nset policy-options policy-statement exp-arp-to-rrs term 2 from rib inet6.3\nset policy-options policy-statement exp-arp-to-rrs term 2 then next-hop self\nset policy-options policy-statement exp-arp-to-rrs term 2 then accept\nset policy-options policy-statement exp-arp-to-rrs term 3 from protocol bgp\nset policy-options policy-statement exp-arp-to-rrs term 3 then accept\nset policy-options policy-statement exp-arp-to-rrs term 4 then reject\nset policy-options policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre\nset policy-options policy-statement exp_server_v4_v6_peers term 1 then accept\nset policy-options policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre\nset policy-options policy-statement exp_server_v4_v6_peers term 2 then accept\nset policy-options policy-statement pplb then load-balance per-packet",
            "路由器 R5": "set interfaces ge-0/2/1 unit 0 family inet address 10.100.140.1/30\nset interfaces ge-0/2/1 unit 0 family inet6 address ::10.100.140.1/126\nset interfaces ge-0/3/1 unit 0 family inet address 10.200.203.2/28\nset interfaces ge-0/3/1 unit 0 family inet6 address ::10.200.203.2/124\nset interfaces ge-0/3/4 unit 0 family inet address 10.200.202.2/30\nset interfaces ge-0/3/4 unit 0 family inet6 address ::10.200.202.2/126\nset interfaces lo0 unit 0 family inet address 10.8.8.8/32\nset interfaces lo0 unit 0 family inet6 address ::10.8.8.8/128\nset routing-options router-id 10.8.8.8\nset routing-options autonomous-system 64497\nset protocols bgp group Peer1-lan-1 type external\nset protocols bgp group Peer1-lan-1 family inet unicast\nset protocols bgp group Peer1-lan-1 export exp-lo0\nset protocols bgp group Peer1-lan-1 peer-as 64497\nset protocols bgp group Peer1-lan-1 neighbor 10.200.202.1\nset protocols bgp group Peer1-lan-1 neighbor 10.200.203.1\nset protocols bgp group Peer1-lan-1-v6 family inet6 unicast\nset protocols bgp group Peer1-lan-1-v6 export exp-lo0\nset protocols bgp group Peer1-lan-1-v6 peer-as 64497\nset protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.202.1\nset protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.203.1\nset protocols bgp group Peer1-H1 type external\nset protocols bgp group Peer1-H1 family inet unicast\nset protocols bgp group Peer1-H1 neighbor 10.100.140.2 peer-as 64498\nset protocols bgp group Peer1-H1-v6 type external\nset protocols bgp group Peer1-H1-v6 family inet6 unicast\nset protocols bgp group Peer1-H1-v6 neighbor ::10.100.140.2 peer-as 64498\nset policy-options policy-statement exp-lo0 term 1 from interface lo0.0\nset policy-options policy-statement exp-lo0 term 1 then accept",
            "路由器 R6": "set interfaces ge-1/1/2 unit 0 family inet address 10.100.140.2/30\nset interfaces ge-1/1/2 unit 0 family inet6 address ::10.100.140.2/126\nset interfaces ge-1/1/5 unit 0 family inet address 10.1.1.1/24\nset interfaces ge-1/1/5 unit 0 family inet6 address 2001:db8:10:1:1::1/120\nset interfaces lo0 unit 0 family inet address 10.17.17.1/32\nset interfaces lo0 unit 0 family inet address 10.17.17.2/32\nset interfaces lo0 unit 0 family inet address 10.17.17.3/32\nset interfaces lo0 unit 0 family inet address 10.17.17.4/32\nset interfaces lo0 unit 0 family inet address 10.17.17.5/32\nset interfaces lo0 unit 0 family inet address 10.17.17.6/32\nset interfaces lo0 unit 0 family inet address 10.17.17.7/32\nset interfaces lo0 unit 0 family inet address 10.17.17.8/32\nset interfaces lo0 unit 0 family inet address 10.17.17.9/32\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.1/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.2/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.3/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.4/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.5/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.6/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.7/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.8/128\nset interfaces lo0 unit 0 family inet6 address ::10.17.17.9/128\nset routing-options router-id 10.17.17.1\nset routing-options autonomous-system 64498\nset protocols bgp group H1-Peer1 type external\nset protocols bgp group H1-Peer1 family inet unicast\nset protocols bgp group H1-Peer1 export exp-lo0\nset protocols bgp group H1-Peer1 neighbor 10.100.140.1 peer-as 64497\nset protocols bgp group H1-Peer1-v6 type external\nset protocols bgp group H1-Peer1-v6 family inet6 unicast\nset protocols bgp group H1-Peer1-v6 export exp-lo0\nset protocols bgp group H1-Peer1-v6 neighbor ::100.100.140.1 peer-as 64497\nset protocols bgp group R6RT0 type external\nset protocols bgp group R6RT0 family inet unicast\nset protocols bgp group R6RT0 peer-as 65300\nset protocols bgp group R6RT0 neighbor 10.1.1.2\nset protocols bgp group R6RT0-v6 type external\nset protocols bgp group R6RT0-v6 family inet6 unicast\nset protocols bgp group R6RT0-v6 peer-as 65300\nset protocols bgp group R6RT0-v6 neighbor 2008:db8:50::2\nset policy-options policy-statement exp-lo0 term 1 from interface lo0.0\nset policy-options policy-statement exp-lo0 term 1 then accept\nset policy-options policy-statement exp-lo0 term 2 from protocol direct\nset policy-options policy-statement exp-lo0 term 2 from protocol local\nset policy-options policy-statement exp-lo0 term 2 then accept",
            "路由器 R7": "set interfaces ge-1/0/6 unit 0 family inet address 10.100.141.1/30\nset interfaces ge-1/0/6 unit 0 family inet6 address ::10.100.141.1/126\nset interfaces ge-1/1/4 vlan-tagging\nset interfaces ge-1/1/4 unit 0 vlan-id 1\nset interfaces ge-1/1/4 unit 0 family inet address 10.200.204.2/24\nset interfaces ge-1/1/4 unit 0 family inet6 address ::10.200.204.2/120\nset interfaces ge-1/1/4 unit 1 vlan-id 2\nset interfaces ge-1/1/4 unit 2 vlan-id 3\nset interfaces lo0 unit 0 family inet address 10.9.9.9/32\nset interfaces lo0 unit 0 family inet6 address ::10.9.9.9/128\nset routing-options router-id 10.9.9.9\nset routing-options autonomous-system 64497\nset protocols bgp group Peer1-lan-1 type external\nset protocols bgp group Peer1-lan-1 family inet unicast\nset protocols bgp group Peer1-lan-1 export exp-lo0\nset protocols bgp group Peer1-lan-1 peer-as 64497\nset protocols bgp group Peer1-lan-1 neighbor 10.200.204.1\nset protocols bgp group Peer1-lan-1-v6 family inet6 unicast\nset protocols bgp group Peer1-lan-1-v6 export exp-lo0\nset protocols bgp group Peer1-lan-1-v6 peer-as 64497\nset protocols bgp group Peer1-lan-1-v6 neighbor ::10.200.204.1\nset protocols bgp group Peer2-H2 type external\nset protocols bgp group Peer2-H2 family inet unicast\nset protocols bgp group Peer2-H2 neighbor 10.100.141.2 peer-as 64499\nset protocols bgp group Peer2-H2-v6 type external\nset protocols bgp group Peer2-H2-v6 family inet6 unicast\nset protocols bgp group Peer2-H2-v6 neighbor ::10.100.141.2 peer-as 64499\nset policy-options policy-statement exp-lo0 term 1 from interface lo0.0\nset policy-options policy-statement exp-lo0 term 1 then accept",
            "路由器 R8": "set interfaces ge-4/0/5 unit 0 family inet address 10.100.141.2/30\nset interfaces ge-4/0/5 unit 0 family inet6 address ::10.100.141.2/126\nset interfaces lo0 unit 0 family inet address 10.18.18.1/32\nset interfaces lo0 unit 0 family inet address 10.18.18.2/32\nset interfaces lo0 unit 0 family inet address 10.18.18.3/32\nset interfaces lo0 unit 0 family inet address 10.18.18.4/32\nset interfaces lo0 unit 0 family inet address 10.18.18.5/32\nset interfaces lo0 unit 0 family inet address 10.18.18.6/32\nset interfaces lo0 unit 0 family inet address 10.18.18.7/32\nset interfaces lo0 unit 0 family inet address 10.18.18.8/32\nset interfaces lo0 unit 0 family inet address 10.18.18.9/32\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.1/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.2/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.3/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.4/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.5/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.6/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.7/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.8/128\nset interfaces lo0 unit 0 family inet6 address ::10.18.18.9/128\nset routing-options router-id 10.18.18.1\nset routing-options autonomous-system 64499\nset protocols bgp group H2-Peer2 type external\nset protocols bgp group H2-Peer2 family inet unicast\nset protocols bgp group H2-Peer2 export exp-lo0\nset protocols bgp group H2-Peer2 neighbor 10.100.141.1 peer-as 64497\nset protocols bgp group H2-Peer2-v6 type external\nset protocols bgp group H2-Peer2-v6 family inet6 unicast\nset protocols bgp group H2-Peer2-v6 export exp-lo0\nset protocols bgp group H2-Peer2-v6 neighbor ::10.100.141.1 peer-as 64497\nset protocols bgp group R8RT0 type external\nset protocols bgp group R8RT0 family inet unicast\nset protocols bgp group R8RT0 peer-as 65400\nset protocols bgp group R8RT0 neighbor 10.1.1.2\nset policy-options policy-statement exp-lo0 term 1 from interface lo0.0\nset policy-options policy-statement exp-lo0 term 1 then accept\nset policy-options policy-statement exp-lo0 term 2 then reject"
          }
        },
        {
          "title": "配置路由器 R3",
          "level": 4,
          "content": "以下示例要求您在配置层次结构中导航各个级别。有关导航 CLI 的信息，请参阅 CLI 用户指南中的在配置模式下使用 CLI 编辑器。 要配置路由器 R3： 注： 修改相应的接口名称、地址和其他参数后，对其他路由器重复此过程。 修改相应的接口名称、地址和其他参数后，对其他路由器重复此过程。 使用 IPv4 和 IPv6 地址配置接口。 [edit interfaces] user@R3# set ge-1/1/0 unit 0 family inet address 10.100.104.2/30 user@R3# set ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126 user@R3# set ge-1/1/0 unit 0 family mpls user@R3# set ge-2/2/5 unit 0 family inet address 10.200.203.1/28 user@R3# set ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124 user@R3# set ge-2/2/8 unit 0 family inet address 10.200.202.1/30 user@R3# set ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126 配置环路地址。 [edit interfaces] user@R3# set lo0 unit 0 family inet address 10.6.6.6/32 user@R3# set lo0 unit 0 family inet6 address ::10.6.6.6/128 配置路由器 ID 和自治系统 (AS) 编号。 [edit routing-options] user@R3# set router-id 10.6.6.6 user@R3# set autonomous-system 64496 为除管理接口以外的所有接口配置 RSVP 协议。 [edit protocols] user@R3# set rsvp interface all user@R3# set rsvp interface fxp0.0 disable 为除管理接口以外的所有接口配置 MPLS 协议。 [edit protocols] user@R3# set mpls ipv6-tunneling user@R3# set mpls interface all user@R3# set mpls interface fxp0.0 disable 在面向核心的接口上配置 IBGP 对等会话。 [edit protocols] user@R3# set bgp log-updown user@R3# set bgp group RR-1-2 type internal user@R3# set bgp group RR-1-2 local-address 10.6.6.6 user@R3# set bgp group RR-1-2 family inet unicast add-path receive user@R3# set bgp group RR-1-2 family inet unicast add-path send path-count 6 user@R3# set bgp group RR-1-2 family inet labeled-unicast rib inet.3 user@R3# set bgp group RR-1-2 family inet6 unicast add-path receive user@R3# set bgp group RR-1-2 family inet6 unicast add-path send path-count 6 user@R3# set bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3 user@R3# set bgp group RR-1-2 neighbor 10.4.4.4 在面向外部边缘路由器的接口上配置 EBGP 对等会话。 [edit protocols] user@R3# set bgp group Peer1-lan-1 type external user@R3# set bgp group Peer1-lan-1 family inet unicast user@R3# set bgp group Peer1-lan-1 peer-as 64497 user@R3# set bgp group Peer1-lan-1-v6 family inet6 unicast user@R3# set bgp group Peer1-lan-1-v6 peer-as 64497 为外部 BGP 组 Peer1-lan-1 和 IPv6 组 Peer1-lan-1-v6 启用出口对等流量工程。 [edit protocols] user@R3# set bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te user@R3# set bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te 将 OSPF 协议配置为 IGP。 [edit protocols] user@R3# set ospf area 0.0.0.0 interface ge-1/1/0.0 user@R3# set ospf area 0.0.0.0 interface fxp0.0 disable user@R3# set ospf area 0.0.0.0 interface lo0.0 passive user@R3# set ldp interface all user@R3# set ldp interface fxp0.0 disable 定义用于将 ARP 路由导出到路由反射器的策略。 [edit policy-options] user@R3# set policy-statement exp-arp-to-rrs term 1 from protocol arp user@R3# set policy-statement exp-arp-to-rrs term 1 from rib inet.3 user@R3# set policy-statement exp-arp-to-rrs term 1 then next-hop self user@R3# set policy-statement exp-arp-to-rrs term 1 then accept user@R3# set policy-statement exp-arp-to-rrs term 2 from protocol arp user@R3# set policy-statement exp-arp-to-rrs term 2 from rib inet6.3 user@R3# set policy-statement exp-arp-to-rrs term 2 then next-hop self user@R3# set policy-statement exp-arp-to-rrs term 2 then accept user@R3# set policy-statement exp-arp-to-rrs term 3 from protocol bgp user@R3# set policy-statement exp-arp-to-rrs term 3 then accept user@R3# set policy-statement exp-arp-to-rrs term 4 then reject 应用 exp-arp-to-rrs 用于导出 ARP 路由的策略，将路由反射器应用到外部 BGP 组 ebgp-v6。 [edit protocols] user@R3# set bgp group RR-1-2 export exp-arp-to-rrs 使用 IPv4 和 IPv6 路由定义前缀列表。 [edit policy-options] user@R3# set prefix-list server_v4_pre 10.1.1.1/32 user@R3# set prefix-list server_v6_pre ::10.1.1.1/128 定义用于将 IPv4 和 IPv6 路由导出到服务器的策略。 [edit policy-options] user@R3# set policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre user@R3# set policy-statement exp_server_v4_v6_peers term 1 then accept user@R3# set policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre user@R3# set policy-statement exp_server_v4_v6_peers term 2 then accept 应用策略以导出 IPv4 和 IPv6 对等路由。 [edit protocols] user@R3# set bgp group Peer1-lan-1 export exp_server_v4_v6_peers user@R3# set bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers 定义按数据包负载均衡策略。 [edit policy-options] user@R3# set policy-statement pplb then load-balance per-packet 应用按数据包负载均衡策略。 [edit routing-options] user@R3# set forwarding-table export pplb",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "使用 IPv4 和 IPv6 地址配置接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@R3# set ge-1/1/0 unit 0 family inet address 10.100.104.2/30",
                    "user@R3# set ge-1/1/0 unit 0 family inet6 address ::10.100.104.2/126",
                    "user@R3# set ge-1/1/0 unit 0 family mpls",
                    "user@R3# set ge-2/2/5 unit 0 family inet address 10.200.203.1/28",
                    "user@R3# set ge-2/2/5 unit 0 family inet6 address ::10.200.203.1/124",
                    "user@R3# set ge-2/2/8 unit 0 family inet address 10.200.202.1/30",
                    "user@R3# set ge-2/2/8 unit 0 family inet6 address ::10.200.202.1/126"
                  ]
                },
                {
                  "step": 2,
                  "description": "配置环路地址。",
                  "code": [
                    "[edit interfaces]",
                    "user@R3# set lo0 unit 0 family inet address 10.6.6.6/32",
                    "user@R3# set lo0 unit 0 family inet6 address ::10.6.6.6/128"
                  ]
                },
                {
                  "step": 3,
                  "description": "配置路由器 ID 和自治系统 (AS) 编号。",
                  "code": [
                    "[edit routing-options]",
                    "user@R3# set router-id 10.6.6.6",
                    "user@R3# set autonomous-system 64496"
                  ]
                },
                {
                  "step": 4,
                  "description": "为除管理接口以外的所有接口配置 RSVP 协议。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set rsvp interface all",
                    "user@R3# set rsvp interface fxp0.0 disable"
                  ]
                },
                {
                  "step": 5,
                  "description": "为除管理接口以外的所有接口配置 MPLS 协议。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set mpls ipv6-tunneling",
                    "user@R3# set mpls interface all",
                    "user@R3# set mpls interface fxp0.0 disable"
                  ]
                },
                {
                  "step": 6,
                  "description": "在面向核心的接口上配置 IBGP 对等会话。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set bgp log-updown",
                    "user@R3# set bgp group RR-1-2 type internal",
                    "user@R3# set bgp group RR-1-2 local-address 10.6.6.6",
                    "user@R3# set bgp group RR-1-2 family inet unicast add-path receive",
                    "user@R3# set bgp group RR-1-2 family inet unicast add-path send path-count 6",
                    "user@R3# set bgp group RR-1-2 family inet labeled-unicast rib inet.3",
                    "user@R3# set bgp group RR-1-2 family inet6 unicast add-path receive",
                    "user@R3# set bgp group RR-1-2 family inet6 unicast add-path send path-count 6",
                    "user@R3# set bgp group RR-1-2 family inet6 labeled-unicast rib inet6.3",
                    "user@R3# set bgp group RR-1-2 neighbor 10.4.4.4"
                  ]
                },
                {
                  "step": 7,
                  "description": "在面向外部边缘路由器的接口上配置 EBGP 对等会话。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set bgp group Peer1-lan-1 type external",
                    "user@R3# set bgp group Peer1-lan-1 family inet unicast",
                    "user@R3# set bgp group Peer1-lan-1 peer-as 64497",
                    "user@R3# set bgp group Peer1-lan-1-v6 family inet6 unicast",
                    "user@R3# set bgp group Peer1-lan-1-v6 peer-as 64497"
                  ]
                },
                {
                  "step": 8,
                  "description": "为外部 BGP 组 Peer1-lan-1 和 IPv6 组 Peer1-lan-1-v6 启用出口对等流量工程。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set bgp group Peer1-lan-1 neighbor 10.200.202.2 egress-te",
                    "user@R3# set bgp group Peer1-lan-1 neighbor 10.200.203.2 egress-te",
                    "user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.202.2 egress-te",
                    "user@R3# set bgp group Peer1-lan-1-v6 neighbor ::10.200.203.2 egress-te"
                  ]
                },
                {
                  "step": 9,
                  "description": "将 OSPF 协议配置为 IGP。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set ospf area 0.0.0.0 interface ge-1/1/0.0",
                    "user@R3# set ospf area 0.0.0.0 interface fxp0.0 disable",
                    "user@R3# set ospf area 0.0.0.0 interface lo0.0 passive",
                    "user@R3# set ldp interface all",
                    "user@R3# set ldp interface fxp0.0 disable"
                  ]
                },
                {
                  "step": 10,
                  "description": "定义用于将 ARP 路由导出到路由反射器的策略。",
                  "code": [
                    "[edit policy-options]",
                    "user@R3# set policy-statement exp-arp-to-rrs term 1 from protocol arp",
                    "user@R3# set policy-statement exp-arp-to-rrs term 1 from rib inet.3",
                    "user@R3# set policy-statement exp-arp-to-rrs term 1 then next-hop self",
                    "user@R3# set policy-statement exp-arp-to-rrs term 1 then accept",
                    "user@R3# set policy-statement exp-arp-to-rrs term 2 from protocol arp",
                    "user@R3# set policy-statement exp-arp-to-rrs term 2 from rib inet6.3",
                    "user@R3# set policy-statement exp-arp-to-rrs term 2 then next-hop self",
                    "user@R3# set policy-statement exp-arp-to-rrs term 2 then accept",
                    "user@R3# set policy-statement exp-arp-to-rrs term 3 from protocol bgp",
                    "user@R3# set policy-statement exp-arp-to-rrs term 3 then accept",
                    "user@R3# set policy-statement exp-arp-to-rrs term 4 then reject"
                  ]
                },
                {
                  "step": 11,
                  "description": "应用 exp-arp-to-rrs 用于导出 ARP 路由的策略，将路由反射器应用到外部 BGP 组 ebgp-v6。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set bgp group RR-1-2 export exp-arp-to-rrs"
                  ]
                },
                {
                  "step": 12,
                  "description": "使用 IPv4 和 IPv6 路由定义前缀列表。",
                  "code": [
                    "[edit policy-options]",
                    "user@R3# set prefix-list server_v4_pre 10.1.1.1/32",
                    "user@R3# set prefix-list server_v6_pre ::10.1.1.1/128"
                  ]
                },
                {
                  "step": 13,
                  "description": "定义用于将 IPv4 和 IPv6 路由导出到服务器的策略。",
                  "code": [
                    "[edit policy-options]",
                    "user@R3# set policy-statement exp_server_v4_v6_peers term 1 from prefix-list server_v4_pre",
                    "user@R3# set policy-statement exp_server_v4_v6_peers term 1 then accept",
                    "user@R3# set policy-statement exp_server_v4_v6_peers term 2 from prefix-list server_v6_pre",
                    "user@R3# set policy-statement exp_server_v4_v6_peers term 2 then accept"
                  ]
                },
                {
                  "step": 14,
                  "description": "应用策略以导出 IPv4 和 IPv6 对等路由。",
                  "code": [
                    "[edit protocols]",
                    "user@R3# set bgp group Peer1-lan-1 export exp_server_v4_v6_peers",
                    "user@R3# set bgp group Peer1-lan-1-v6 export exp_server_v4_v6_peers"
                  ]
                },
                {
                  "step": 15,
                  "description": "定义按数据包负载均衡策略。",
                  "code": [
                    "[edit policy-options]",
                    "user@R3# set policy-statement pplb then load-balance per-packet"
                  ]
                },
                {
                  "step": 16,
                  "description": "应用按数据包负载均衡策略。",
                  "code": [
                    "[edit routing-options]",
                    "user@R3# set forwarding-table export pplb"
                  ]
                }
              ]
            }
          ]
        },
        {
          "title": "结果",
          "level": 4,
          "content": "在配置模式下，输入 show interfaces 、 show protocols 、 show routing-options 和 show policy-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。",
          "code": [
            "[edit]\nuser@R3# show interfaces\nge-1/1/0 {\n    unit 0 {\n        family inet {\n            address 10.100.104.2/30;\n        }\n        family inet6 {\n            address ::10.100.104.2/126;\n        }\n        family mpls;\n    }\n}\nge-2/2/5 {\n    unit 0 {\n        family inet {\n            address 100.200.203.1/28;\n        }\n        family inet6 {\n            address ::10.200.203.1/124;\n        }\n    }\n}\nge-2/2/8 {\n    unit 0 {\n        family inet {\n            address 10.200.202.1/30;\n        }\n        family inet6 {\n            address ::10.200.202.1/126;\n        }\n    }\n}\nlo0 {\n    unit 0 {\n        family inet {\n            address 10.6.6.6/32;\n        }\n        family inet6 {\n            address ::10.6.6.6/128;\n        }\n    }\n}",
            "[edit]\nuser@R3#show protocolsrsvp {\n    interface all;\n    interface fxp0.0 {\n        disable;\n    }\n}\nmpls {\n    ipv6-tunneling;\n    interface all;\n    interface fxp0.0 {\n        disable;\n    }\n}\nbgp {\n    log-updown;\n    group RR-1-2 {\n        type internal;\n        local-address 10.6.6.6;\n        family inet {\n            unicast {\n                add-path {\n                    receive;\n                    send {\n                        path-count 6;\n                    }\n                }\n            }\n            labeled-unicast {\n                rib {\n                    inet.3;\n                }\n            }\n        }\n        family inet6 {\n            unicast {\n                add-path {\n                    receive;\n                    send {\n                        path-count 6;\n                    }\n                }\n            }\n            labeled-unicast {\n                rib {\n                    inet6.3;\n                }\n            }\n        }\n        export exp-arp-to-rrs;\n        neighbor 10.4.4.4;\n    }\n    group Peer1-lan-1 {\n        type external;\n        family inet {\n            unicast;\n        }\n        export exp_server_v4_v6_peers;\n        peer-as 64497;\n        neighbor 10.200.202.2 {\n            egress-te;\n        }\n        neighbor 10.200.203.2 {\n            egress-te;\n        }\n    }\n    group Peer1-lan-1-v6 {\n        family inet6 {\n            unicast;\n        }\n        export exp_server_v4_v6_peers;\n        peer-as 64497;\n        neighbor ::10.200.202.2 {\n            egress-te;\n        }\n        neighbor ::10.200.203.2 {\n            egress-te;\n        }\n    }\n}\nospf {\n    area 0.0.0.0 {\n        interface ge-1/1/0.0;\n        interface fxp0.0 {\n            disable;\n        }\n        interface lo0.0 {\n            passive;\n        }\n    }\n}\nldp {\n    interface all;\n    interface fxp0.0 {\n        disable;\n    }\n}",
            "[edit]\nuser@R3#show routing-optionsrouter-id 10.6.6.6;\nautonomous-system 64496;\n    forwarding-table {\n        export pplb;\n    }",
            "[edit]\nuser@R3#show policy-optionsprefix-list server_v4_pre {\n        10.1.1.1/32;\n    }\n    prefix-list server_v6_pre {\n        ::10.1.1.1/128;\n    }\n    policy-statement exp-arp-to-rrs {\n        term 1 {\n            from {\n                protocol arp;\n                rib inet.3;\n            }\n            then {\n                next-hop self;\n                accept;\n            }\n        }\n        term 2 {\n            from {\n                protocol arp;\n                rib inet6.3;\n            }\n            then {\n                next-hop self;\n                accept;\n            }\n        }\n        term 3 {\n            from protocol bgp;\n            then accept;\n        }\n        term 4 {\n            then reject;\n        }\n    }\n    policy-statement exp_server_v4_v6_peers {\n        term 1 {\n            from {\n                prefix-list server_v4_pre;\n            }\n            then accept;\n        }\n        term 2 {\n            from {\n                prefix-list server_v6_pre;\n            }\n            then accept;\n        }\n    }\n    policy-statement pplb {\n        then {\n            load-balance per-packet;\n        }\n    }\n}"
          ]
        }
      ]
    }
  ],
  "content": "此示例说明如何使用标记为单播的 BGP 配置出口对等流量工程。出口对等流量工程允许中央控制器指示域中的入口路由器将流量定向到特定的出口路由器和特定的外部接口，以到达网络外的特定目标。在入口处进行负载平衡的情况下，此功能可确保以最佳方式利用播发的出口路由"
}
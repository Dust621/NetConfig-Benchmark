{
  "title": "示例：在 BGP 网络中通过 SRv6 配置第 3 层服务",
  "sections": [
    {
      "title": "要求",
      "level": 3,
      "content": "此示例使用以下硬件和软件组件： 5 个带有 MPC7E、MPC8E 或 MPC9E 线卡的 MX 系列路由器 Junos OS 20.4R1 或更高版本 此示例使用以下硬件和软件组件： 5 个带有 MPC7E、MPC8E 或 MPC9E 线卡的 MX 系列路由器 Junos OS 20.4R1 或更高版本"
    },
    {
      "title": "概述",
      "level": 3,
      "content": "从 Junos OS 20.4R1 版开始，您可以通过 SRv6 核心网络配置基于 BGP 的第 3 层服务。使用 SRv6 网络编程，网络仅依靠 IPv6 报头和报头扩展来传输数据。您可以使用 BGP 作为控制平面，将 SRv6 作为数据平面来启用第 3 层叠加服务。 在 中 图 3，路由器 R0 是入口路由器，路由器 R1 和 R2 是支持仅支持 IPv4 的客户边缘设备的出口路由器。路由器 R3 和 R4 构成仅支持 IPv6 的提供商核心网络。所有路由器都属于同一个自治系统。IS-IS 是内部网关协议，配置为支持 IPv6 核心路由器 R3 和 R4 中的 SRv6。在此示例中，BGP 在路由器 R0、R1 和 R2 上配置。路由器 R0 配置为具有到路由器 R1 和路由器 R2 的 IBGP 对等会话的 IPv6 路由反射器。出口路由器 R1 将 L3VPN SID 播发至入口路由器 R0，后者接受并更新 VRF 表。 R1 将 3011：：1 配置为终端 sid，所有 BGP 路由都使用 3011：：1 播发作为路由器 R0 的下一跃点。路由器 R0 有两条通向 R1 的路径，一条是通过 R3 的主路径，另一条是通过 R4 的备份路径。在路由器 R0 中，主路径使用默认指标，备份路径配置指标 50。以下是从路由器 R1 播发到 R0 的一些路由： IPv4 21.0.0.0 IPv6 2001:21:: IPv4 VPN 31.0.0.0 IPv6 VPN 2001:31:: 21.0.0.0 2001:21:: 31.0.0.0 2001:31::",
      "sections": [
        {
          "title": "拓扑学",
          "level": 4,
          "content": "在 中 图 3，路由器 R0 是入口路由器，路由器 R1 和 R2 是支持仅支持 IPv4 的客户边缘设备的出口路由器。路由器 R3 和 R4 构成仅支持 IPv6 的提供商核心网络。所有路由器都属于同一个自治系统。IS-IS 是内部网关协议，配置为支持 IPv6 核心路由器 R3 和 R4 中的 SRv6。在此示例中，BGP 在路由器 R0、R1 和 R2 上配置。路由器 R0 配置为具有到路由器 R1 和路由器 R2 的 IBGP 对等会话的 IPv6 路由反射器。出口路由器 R1 将 L3VPN SID 播发至入口路由器 R0，后者接受并更新 VRF 表。 R1 将 3011：：1 配置为终端 sid，所有 BGP 路由都使用 3011：：1 播发作为路由器 R0 的下一跃点。路由器 R0 有两条通向 R1 的路径，一条是通过 R3 的主路径，另一条是通过 R4 的备份路径。在路由器 R0 中，主路径使用默认指标，备份路径配置指标 50。以下是从路由器 R1 播发到 R0 的一些路由： IPv4 21.0.0.0 IPv6 2001:21:: IPv4 VPN 31.0.0.0 IPv6 VPN 2001:31:: 21.0.0.0 2001:21:: 31.0.0.0 2001:31::",
          "images": [
            "BGP 出口流量工程\\images\\9_示例：在_BGP_网络中通过_SRv6__1.png"
          ]
        }
      ]
    },
    {
      "title": "配置",
      "level": 3,
      "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改与您的网络配置匹配所需的任何详细信息，将命令复制并粘贴到层次结构级别的 CLI [edit] 中，然后从配置模式进入提交。 路由器 R0 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64 set interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30 set interfaces xe-0/0/0:1 unit 0 family iso set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126 set interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::0/128 set policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 then next-hop self set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger set policy-options policy-statement adv_global term v6 then next-hop self set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set policy-options community vpn2-target members target:100:2 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface xe-0/0/0:3.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3001::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options router-id 128.53.38.52 set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-PE-all type internal set protocols bgp group to-PE-all local-address abcd::128:53:38:52 set protocols bgp group to-PE-all family inet unicast extended-nexthop set protocols bgp group to-PE-all family inet unicast advertise-srv6-service set protocols bgp group to-PE-all family inet unicast accept-srv6-service set protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop set protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service set protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service set protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service set protocols bgp group to-PE-all family inet6 unicast accept-srv6-service set protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service set protocols bgp group to-PE-all export adv_global set protocols bgp group to-PE-all cluster 128.53.38.52 set protocols bgp group to-PE-all neighbor abcd::128:53:35:39 set protocols bgp group to-PE-all neighbor abcd::128:53:35:35 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 11.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1001 set protocols bgp group to-TG-global-v4 neighbor 11.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1001 set protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd set protocols isis level 1 disable 路由器 R1 set chassis network-services enhanced-ip set interfaces xe-0/0/0:2 unit 0 family inet address 2.5.1.1/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::52:0:1/64 set interfaces xe-0/0/0:3 unit 0 family inet address 2.6.1.1/30 set interfaces xe-0/0/0:3 unit 0 family iso set interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::26:1/64 set policy-options policy-statement adv_global term v4 from route-filter 21.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 from route-filter 12.1.1.1/30 orlonger set policy-options policy-statement adv_global term v4 then next-hop 3011::1 set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:21::/64 orlonger set policy-options policy-statement adv_global term v6 from route-filter 2001:12:1:1::1/126 orlonger set policy-options policy-statement adv_global term v6 then next-hop 3011::1 set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement adv_vpn1 term v4 from route-filter 31.0.0.0/8 orlonger set policy-options policy-statement adv_vpn1 term v4 from route-filter 12.1.1.5/30 orlonger set policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v4 then next-hop 3011::1 set policy-options policy-statement adv_vpn1 term v4 then accept set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:31::/64 orlonger set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:12:1:1::5/126 orlonger set policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v6 then next-hop 3011::1 set policy-options policy-statement adv_vpn1 term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set policy-options community vpn2-target members target:100:2 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 12.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1012 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 12.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:12:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1012 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:12:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface xe-0/0/1:0.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-export adv_vpn1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3011::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve set routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-RR type internal set protocols bgp group to-RR local-address abcd::128:53:35:39 set protocols bgp group to-RR family inet unicast extended-nexthop set protocols bgp group to-RR family inet unicast advertise-srv6-service set protocols bgp group to-RR family inet unicast accept-srv6-service set protocols bgp group to-RR family inet-vpn unicast extended-nexthop set protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet-vpn unicast accept-srv6-service set protocols bgp group to-RR family inet6 unicast advertise-srv6-service set protocols bgp group to-RR family inet6 unicast accept-srv6-service set protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service set protocols bgp group to-RR export adv_global set protocols bgp group to-RR neighbor abcd::128:53:38:52 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 12.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1011 set protocols bgp group to-TG-global-v4 neighbor 12.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:12:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1011 set protocols bgp group to-TG-global-v6 neighbor 2001:12:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3011::1 flavor usd set protocols isis level 1 disable 路由器 R2 set chassis network-services enhanced-ip set interfaces ge-0/0/0 unit 0 family inet address 3.5.1.1/30 set interfaces ge-0/0/0 unit 0 family iso set interfaces ge-0/0/0 unit 0 family inet6 address 2001:db8::3:5:1/64 set interfaces ge-0/0/1 unit 0 family inet address 3.6.1.1/30 set interfaces ge-0/0/1 unit 0 family iso set interfaces ge-0/0/1 unit 0 family inet6 address 2001:db8::3:6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::2/128 set policy-options policy-statement adv_global term v4 from route-filter 22.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 from route-filter 13.1.1.1/30 orlonger set policy-options policy-statement adv_global term v4 then next-hop 3021::1 set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:22::/64 orlonger set policy-options policy-statement adv_global term v6 from route-filter 2001:13:1:1::1/126 orlonger set policy-options policy-statement adv_global term v6 then next-hop 3021::1 set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement adv_vpn1 term v4 from route-filter 32.0.0.0/8 orlonger set policy-options policy-statement adv_vpn1 term v4 from route-filter 13.1.1.5/30 orlonger set policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v4 then next-hop 3021::1 set policy-options policy-statement adv_vpn1 term v4 then accept set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:32::/64 orlonger set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:13:1:1::5/126 orlonger set policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v6 then next-hop 3021::1 set policy-options policy-statement adv_vpn1 term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 13.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1022 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 13.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:13:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1022 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:13:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface ge-0/0/2.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-export adv_vpn1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3021::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve set routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-RR type internal set protocols bgp group to-RR local-address abcd::128:53:35:35 set protocols bgp group to-RR family inet unicast extended-nexthop set protocols bgp group to-RR family inet unicast advertise-srv6-service set protocols bgp group to-RR family inet unicast accept-srv6-service set protocols bgp group to-RR family inet-vpn unicast extended-nexthop set protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet-vpn unicast accept-srv6-service set protocols bgp group to-RR family inet6 unicast advertise-srv6-service set protocols bgp group to-RR family inet6 unicast accept-srv6-service set protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service set protocols bgp group to-RR export adv_global set protocols bgp group to-RR neighbor abcd::128:53:38:52 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 13.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1021 set protocols bgp group to-TG-global-v4 neighbor 13.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:13:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1021 set protocols bgp group to-TG-global-v6 neighbor 2001:13:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3021::1 flavor usd set protocols isis level 1 disable 路由器 R3 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.2/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:2/64 set interfaces xe-0/0/1:0 unit 0 family inet address 2.5.1.2/30 set interfaces xe-0/0/1:0 unit 0 family iso set interfaces xe-0/0/1:0 unit 0 family inet6 address 2001:db8::52:0:2/64 set interfaces xe-0/0/1:1 unit 0 family inet address 3.5.1.2/30 set interfaces xe-0/0/1:1 unit 0 family iso set interfaces xe-0/0/1:1 unit 0 family inet6 address 2001:db8::3:5:2/64 set interfaces xe-0/0/1:2 unit 0 family inet address 4.6.1.1/30 set interfaces xe-0/0/1:2 unit 0 family iso set interfaces xe-0/0/1:2 unit 0 family inet6 address 2001:db8::4:6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::3/128 set routing-options autonomous-system 100 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis level 1 disable 路由器 R4 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.6.1.2/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::6:2/64 set interfaces xe-0/0/0:1 unit 0 family inet address 2.6.1.2/30 set interfaces xe-0/0/0:1 unit 0 family iso set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:db8::26:2/64 set interfaces xe-0/0/0:2 unit 0 family inet address 3.6.1.2/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::3:6:2/64 set interfaces xe-0/0/0:3 unit 0 family inet address 4.6.1.2/30 set interfaces xe-0/0/0:3 unit 0 family iso set interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::4:6:2/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::4/128 set routing-options autonomous-system 100 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis level 1 disable 要使用第 3 层 VPN 服务配置 SRv6 网络编程，请在路由器 R0 上执行以下步骤： 配置设备接口以启用 IP 传输。 [edit] user@R0# set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30 user@R0# set interfaces xe-0/0/0:0 unit 0 family iso user@R0# set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64 user@R0# set interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30 user@R0# set interfaces xe-0/0/0:1 unit 0 family iso user@R0# set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126 user@R0# set interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30 user@R0# set interfaces xe-0/0/0:2 unit 0 family iso user@R0# set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64 配置路由器 ID 和自治系统 （AS） 编号，以便在属于同一 AS 的一组路由设备中传播路由信息。 [edit] user@R0# set routing-options router-id 128.53.38.52 user@R0# set routing-options autonomous-system 100 全局启用 SRv6 和定位器地址以指示路由器的 SRv6 功能。SRv6 SID 是由定位器和函数组成的 IPv6 地址。路由协议播发定位器地址。 [edit] user@R0# set routing-options source-packet-routing srv6 locator loc1 3001::/64 user@R0# set routing-options source-packet-routing srv6 no-reduced-srh 为 IPv4 和 IPv6 流量配置外部路由实例 VPN1。为 VPN1 配置 BGP 协议，以便在提供商边缘设备之间启用对等互连和流量传输。 [edit] user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6 为参与路由实例的每个 PE 路由器配置 VPN 类型和唯一路由识别符。 [edit] user@R0# set routing-instances vpn1 instance-type vrf user@R0# set routing-instances vpn1 interface xe-0/0/0:3.1 user@R0# set routing-instances vpn1 route-distinguisher 100:1 user@R0# set routing-instances vpn1 vrf-target target:100:1 配置结束 dt4 和结束 dt6 SID 值以启用第 3 层 VPN 服务。 [edit] user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4 user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5 定义用于对数据包进行负载平衡的策略。 [edit] user@R0# set policy-options policy-statement pplb then load-balance per-packet user@R0# set policy-options community vpn1-target members target:100:1 user@R0# set policy-options community vpn2-target members target:100:2 应用按数据包策略以启用流量的负载平衡。 [edit] user@R0# set routing-options forwarding-table export pplb 定义一个策略adv_global以接受从 R1 通告的路由。 [edit] user@R0# set policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger user@R0# set policy-options policy-statement adv_global term v4 then next-hop self user@R0# set policy-options policy-statement adv_global term v4 then accept user@R0# set policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger user@R0# set policy-options policy-statement adv_global term v6 then next-hop self user@R0# set policy-options policy-statement adv_global term v6 then accept 在面向核心的接口上配置 BGP，以建立内部和外部对等会话。 [edit] user@R0# set protocols bgp group to-PE-all type internal user@R0# set protocols bgp group to-PE-all local-address abcd::128:53:38:52 user@R0# set protocols bgp group to-PE-all family inet unicast extended-nexthop user@R0# set protocols bgp group to-PE-all family inet unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop user@R0# set protocols bgp group to-PE-all export adv_global user@R0# set protocols bgp group to-PE-all cluster 128.53.38.52 user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:39 user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:35 user@R0# set protocols bgp group to-TG-global-v4 type external user@R0# set protocols bgp group to-TG-global-v4 local-address 11.1.1.1 user@R0# set protocols bgp group to-TG-global-v4 family inet unicast user@R0# set protocols bgp group to-TG-global-v4 family inet6 unicast user@R0# set protocols bgp group to-TG-global-v4 user@R0# set protocols bgp group to-TG-global-v4 neighbor 11.1.1.2 user@R0# set protocols bgp group to-TG-global-v6 type external user@R0# set protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1 user@R0# set protocols bgp group to-TG-global-v6 family inet6 unicast user@R0# set protocols bgp group to-TG-global-v6 peer-as 1001 user@R0# set protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2 使设备能够向 BGP 对等方播发 SRv6 服务，并接受出口提供商边缘 （PE） 设备播发的路由。 [edit] user@R0# set protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet6 unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service 启用 IS-IS 作为内部网关协议 （IGP），以便在核心提供商路由器之间路由流量。 [edit] user@R0# set protocols isis interface all user@R0# set protocols isis interface fxp0.0 disable user@R0# set protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd user@R0# set protocols isis level 1 disable 为前缀段配置 end-dt4 和 end-dt6 SID 值。end-dt4 是具有解封装和 IPv4 表查找功能的终结点 SID，end-dt6 是具有解封装和 IPv6 表查找功能的终结点。BGP 为 IPv4 和 IPv6 第 3 层 VPN 服务 SID 分配这些内容。 [edit] user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2 user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3 在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 [edit] user@R0# show interfaces xe-0/0/0:0 { unit 0 { family inet { address 1.4.1.1/30; } family iso; family inet6 { address 2001:db8::4:1/64; } } } xe-0/0/0:1 { unit 0 { family inet { address 1.5.1.1/30; } family iso; family inet6 { address 2001:1:4:2::1/126; } } } xe-0/0/0:2 { unit 0 { family inet { address 1.6.1.1/30; } family iso; family inet6 { address 2001:db8::6:1/64; } } } [edit] user@R0# show protocols bgp { group to-PE-all { type internal; local-address abcd::128:53:38:52; family inet { unicast { extended-nexthop; advertise-srv6-service; accept-srv6-service; } } family inet-vpn { unicast { extended-nexthop; advertise-srv6-service; accept-srv6-service; } } family inet6 { unicast { advertise-srv6-service; accept-srv6-service; } } family inet6-vpn { unicast { advertise-srv6-service; accept-srv6-service; } } export adv_global; cluster 128.53.38.52; neighbor abcd::128:53:35:39; neighbor abcd::128:53:35:35; } group to-TG-global-v4 { type external; local-address 11.1.1.1; family inet { unicast; } family inet6 { unicast; } peer-as 1001; neighbor 11.1.1.2; } group to-TG-global-v6 { type external; local-address 2001:11:1:1::1; family inet6 { unicast; } peer-as 1001; neighbor 2001:11:1:1::2; } source-packet-routing { srv6 { locator loc1 { end-dt4-sid 3001::2; end-dt6-sid 3001::3; } } } } isis { interface all; interface fxp0.0 { disable; } source-packet-routing { srv6 { locator loc1 { end-sid 3001::1 { flavor { usd; } } } } } level 1 disable; } [edit] user@R0# show policy-options policy-options { policy-statement adv_global { term v4 { from { route-filter 20.0.0.0/8 orlonger; } then { next-hop self; accept; } } term v6 { from { route-filter 2001:20::/64 orlonger; } then { next-hop self; accept; } } } policy-statement pplb { then { load-balance per-packet; } } community vpn1-target members target:100:1; community vpn2-target members target:100:2; } [edit] user@R0# show routing-options routing-options { source-packet-routing { srv6 { locator loc1 3001::/64; no-reduced-srh; } } router-id 128.53.38.52; autonomous-system 100; forwarding-table { export pplb; } } [edit] user@R0# show routing-instances routing-instances { vpn1 { protocols { bgp { group to-TG-vpn1-v4 { type external; local-address 11.1.1.5; family inet { unicast; } family inet6 { unicast; } peer-as 1002; neighbor 11.1.1.6; } group to-TG-vpn1-v6 { type external; local-address 2001:11:1:1::5; family inet6 { unicast; } peer-as 1002; neighbor 2001:11:1:1::6; } source-packet-routing { srv6 { locator loc1 { end-dt4-sid 3001::4; end-dt6-sid 3001::5; } } } } } instance-type vrf; interface xe-0/0/0:3.1; route-distinguisher 100:1; vrf-target target:100:1; } } 完成设备配置后，从配置模式输入 commit 。",
      "sections": [
        {
          "title": "CLI 快速配置",
          "level": 4,
          "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改与您的网络配置匹配所需的任何详细信息，将命令复制并粘贴到层次结构级别的 CLI [edit] 中，然后从配置模式进入提交。 路由器 R0 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64 set interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30 set interfaces xe-0/0/0:1 unit 0 family iso set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126 set interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::0/128 set policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 then next-hop self set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger set policy-options policy-statement adv_global term v6 then next-hop self set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set policy-options community vpn2-target members target:100:2 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface xe-0/0/0:3.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3001::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options router-id 128.53.38.52 set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-PE-all type internal set protocols bgp group to-PE-all local-address abcd::128:53:38:52 set protocols bgp group to-PE-all family inet unicast extended-nexthop set protocols bgp group to-PE-all family inet unicast advertise-srv6-service set protocols bgp group to-PE-all family inet unicast accept-srv6-service set protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop set protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service set protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service set protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service set protocols bgp group to-PE-all family inet6 unicast accept-srv6-service set protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service set protocols bgp group to-PE-all export adv_global set protocols bgp group to-PE-all cluster 128.53.38.52 set protocols bgp group to-PE-all neighbor abcd::128:53:35:39 set protocols bgp group to-PE-all neighbor abcd::128:53:35:35 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 11.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1001 set protocols bgp group to-TG-global-v4 neighbor 11.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1001 set protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd set protocols isis level 1 disable 路由器 R1 set chassis network-services enhanced-ip set interfaces xe-0/0/0:2 unit 0 family inet address 2.5.1.1/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::52:0:1/64 set interfaces xe-0/0/0:3 unit 0 family inet address 2.6.1.1/30 set interfaces xe-0/0/0:3 unit 0 family iso set interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::26:1/64 set policy-options policy-statement adv_global term v4 from route-filter 21.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 from route-filter 12.1.1.1/30 orlonger set policy-options policy-statement adv_global term v4 then next-hop 3011::1 set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:21::/64 orlonger set policy-options policy-statement adv_global term v6 from route-filter 2001:12:1:1::1/126 orlonger set policy-options policy-statement adv_global term v6 then next-hop 3011::1 set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement adv_vpn1 term v4 from route-filter 31.0.0.0/8 orlonger set policy-options policy-statement adv_vpn1 term v4 from route-filter 12.1.1.5/30 orlonger set policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v4 then next-hop 3011::1 set policy-options policy-statement adv_vpn1 term v4 then accept set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:31::/64 orlonger set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:12:1:1::5/126 orlonger set policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v6 then next-hop 3011::1 set policy-options policy-statement adv_vpn1 term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set policy-options community vpn2-target members target:100:2 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 12.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1012 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 12.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:12:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1012 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:12:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface xe-0/0/1:0.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-export adv_vpn1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3011::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve set routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-RR type internal set protocols bgp group to-RR local-address abcd::128:53:35:39 set protocols bgp group to-RR family inet unicast extended-nexthop set protocols bgp group to-RR family inet unicast advertise-srv6-service set protocols bgp group to-RR family inet unicast accept-srv6-service set protocols bgp group to-RR family inet-vpn unicast extended-nexthop set protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet-vpn unicast accept-srv6-service set protocols bgp group to-RR family inet6 unicast advertise-srv6-service set protocols bgp group to-RR family inet6 unicast accept-srv6-service set protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service set protocols bgp group to-RR export adv_global set protocols bgp group to-RR neighbor abcd::128:53:38:52 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 12.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1011 set protocols bgp group to-TG-global-v4 neighbor 12.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:12:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1011 set protocols bgp group to-TG-global-v6 neighbor 2001:12:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3011::1 flavor usd set protocols isis level 1 disable 路由器 R2 set chassis network-services enhanced-ip set interfaces ge-0/0/0 unit 0 family inet address 3.5.1.1/30 set interfaces ge-0/0/0 unit 0 family iso set interfaces ge-0/0/0 unit 0 family inet6 address 2001:db8::3:5:1/64 set interfaces ge-0/0/1 unit 0 family inet address 3.6.1.1/30 set interfaces ge-0/0/1 unit 0 family iso set interfaces ge-0/0/1 unit 0 family inet6 address 2001:db8::3:6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::2/128 set policy-options policy-statement adv_global term v4 from route-filter 22.0.0.0/8 orlonger set policy-options policy-statement adv_global term v4 from route-filter 13.1.1.1/30 orlonger set policy-options policy-statement adv_global term v4 then next-hop 3021::1 set policy-options policy-statement adv_global term v4 then accept set policy-options policy-statement adv_global term v6 from route-filter 2001:22::/64 orlonger set policy-options policy-statement adv_global term v6 from route-filter 2001:13:1:1::1/126 orlonger set policy-options policy-statement adv_global term v6 then next-hop 3021::1 set policy-options policy-statement adv_global term v6 then accept set policy-options policy-statement adv_vpn1 term v4 from route-filter 32.0.0.0/8 orlonger set policy-options policy-statement adv_vpn1 term v4 from route-filter 13.1.1.5/30 orlonger set policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v4 then next-hop 3021::1 set policy-options policy-statement adv_vpn1 term v4 then accept set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:32::/64 orlonger set policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:13:1:1::5/126 orlonger set policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target set policy-options policy-statement adv_vpn1 term v6 then next-hop 3021::1 set policy-options policy-statement adv_vpn1 term v6 then accept set policy-options policy-statement pplb then load-balance per-packet set policy-options community vpn1-target members target:100:1 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 13.1.1.5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1022 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 13.1.1.6 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:13:1:1::5 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1022 set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:13:1:1::6 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::4 set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::5 set routing-instances vpn1 instance-type vrf set routing-instances vpn1 interface ge-0/0/2.1 set routing-instances vpn1 route-distinguisher 100:1 set routing-instances vpn1 vrf-export adv_vpn1 set routing-instances vpn1 vrf-target target:100:1 set routing-options source-packet-routing srv6 locator loc1 3021::/64 set routing-options source-packet-routing srv6 no-reduced-srh set routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve set routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1 set routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve set routing-options autonomous-system 100 set routing-options forwarding-table export pplb set protocols bgp group to-RR type internal set protocols bgp group to-RR local-address abcd::128:53:35:35 set protocols bgp group to-RR family inet unicast extended-nexthop set protocols bgp group to-RR family inet unicast advertise-srv6-service set protocols bgp group to-RR family inet unicast accept-srv6-service set protocols bgp group to-RR family inet-vpn unicast extended-nexthop set protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet-vpn unicast accept-srv6-service set protocols bgp group to-RR family inet6 unicast advertise-srv6-service set protocols bgp group to-RR family inet6 unicast accept-srv6-service set protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service set protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service set protocols bgp group to-RR export adv_global set protocols bgp group to-RR neighbor abcd::128:53:38:52 set protocols bgp group to-TG-global-v4 type external set protocols bgp group to-TG-global-v4 local-address 13.1.1.1 set protocols bgp group to-TG-global-v4 family inet unicast set protocols bgp group to-TG-global-v4 family inet6 unicast set protocols bgp group to-TG-global-v4 peer-as 1021 set protocols bgp group to-TG-global-v4 neighbor 13.1.1.2 set protocols bgp group to-TG-global-v6 type external set protocols bgp group to-TG-global-v6 local-address 2001:13:1:1::1 set protocols bgp group to-TG-global-v6 family inet6 unicast set protocols bgp group to-TG-global-v6 peer-as 1021 set protocols bgp group to-TG-global-v6 neighbor 2001:13:1:1::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::2 set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::3 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis source-packet-routing srv6 locator loc1 end-sid 3021::1 flavor usd set protocols isis level 1 disable 路由器 R3 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.2/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:2/64 set interfaces xe-0/0/1:0 unit 0 family inet address 2.5.1.2/30 set interfaces xe-0/0/1:0 unit 0 family iso set interfaces xe-0/0/1:0 unit 0 family inet6 address 2001:db8::52:0:2/64 set interfaces xe-0/0/1:1 unit 0 family inet address 3.5.1.2/30 set interfaces xe-0/0/1:1 unit 0 family iso set interfaces xe-0/0/1:1 unit 0 family inet6 address 2001:db8::3:5:2/64 set interfaces xe-0/0/1:2 unit 0 family inet address 4.6.1.1/30 set interfaces xe-0/0/1:2 unit 0 family iso set interfaces xe-0/0/1:2 unit 0 family inet6 address 2001:db8::4:6:1/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::3/128 set routing-options autonomous-system 100 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis level 1 disable 路由器 R4 set chassis network-services enhanced-ip set interfaces xe-0/0/0:0 unit 0 family inet address 1.6.1.2/30 set interfaces xe-0/0/0:0 unit 0 family iso set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::6:2/64 set interfaces xe-0/0/0:1 unit 0 family inet address 2.6.1.2/30 set interfaces xe-0/0/0:1 unit 0 family iso set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:db8::26:2/64 set interfaces xe-0/0/0:2 unit 0 family inet address 3.6.1.2/30 set interfaces xe-0/0/0:2 unit 0 family iso set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::3:6:2/64 set interfaces xe-0/0/0:3 unit 0 family inet address 4.6.1.2/30 set interfaces xe-0/0/0:3 unit 0 family iso set interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::4:6:2/64 set interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::4/128 set routing-options autonomous-system 100 set protocols isis interface all set protocols isis interface fxp0.0 disable set protocols isis level 1 disable",
          "commands_by_device": {
            "路由器 R0": "set chassis network-services enhanced-ip\nset interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30\nset interfaces xe-0/0/0:0 unit 0 family iso\nset interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64\nset interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30\nset interfaces xe-0/0/0:1 unit 0 family iso\nset interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126\nset interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30\nset interfaces xe-0/0/0:2 unit 0 family iso\nset interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64\nset interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::0/128\nset policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger\nset policy-options policy-statement adv_global term v4 then next-hop self\nset policy-options policy-statement adv_global term v4 then accept\nset policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger\nset policy-options policy-statement adv_global term v6 then next-hop self\nset policy-options policy-statement adv_global term v6 then accept\nset policy-options policy-statement pplb then load-balance per-packet\nset policy-options community vpn1-target members target:100:1\nset policy-options community vpn2-target members target:100:2\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5\nset routing-instances vpn1 instance-type vrf\nset routing-instances vpn1 interface xe-0/0/0:3.1\nset routing-instances vpn1 route-distinguisher 100:1\nset routing-instances vpn1 vrf-target target:100:1\nset routing-options source-packet-routing srv6 locator loc1 3001::/64\nset routing-options source-packet-routing srv6 no-reduced-srh\nset routing-options router-id 128.53.38.52\nset routing-options autonomous-system 100\nset routing-options forwarding-table export pplb\nset protocols bgp group to-PE-all type internal\nset protocols bgp group to-PE-all local-address abcd::128:53:38:52\nset protocols bgp group to-PE-all family inet unicast extended-nexthop\nset protocols bgp group to-PE-all family inet unicast advertise-srv6-service\nset protocols bgp group to-PE-all family inet unicast accept-srv6-service\nset protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop\nset protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service\nset protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service\nset protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service\nset protocols bgp group to-PE-all family inet6 unicast accept-srv6-service\nset protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service\nset protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service\nset protocols bgp group to-PE-all export adv_global\nset protocols bgp group to-PE-all cluster 128.53.38.52\nset protocols bgp group to-PE-all neighbor abcd::128:53:35:39\nset protocols bgp group to-PE-all neighbor abcd::128:53:35:35\nset protocols bgp group to-TG-global-v4 type external\nset protocols bgp group to-TG-global-v4 local-address 11.1.1.1\nset protocols bgp group to-TG-global-v4 family inet unicast\nset protocols bgp group to-TG-global-v4 family inet6 unicast\nset protocols bgp group to-TG-global-v4 peer-as 1001\nset protocols bgp group to-TG-global-v4 neighbor 11.1.1.2\nset protocols bgp group to-TG-global-v6 type external\nset protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1\nset protocols bgp group to-TG-global-v6 family inet6 unicast\nset protocols bgp group to-TG-global-v6 peer-as 1001\nset protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3\nset protocols isis interface all\nset protocols isis interface fxp0.0 disable\nset protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd\nset protocols isis level 1 disable",
            "路由器 R1": "set chassis network-services enhanced-ip\nset interfaces xe-0/0/0:2 unit 0 family inet address 2.5.1.1/30\nset interfaces xe-0/0/0:2 unit 0 family iso\nset interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::52:0:1/64\nset interfaces xe-0/0/0:3 unit 0 family inet address 2.6.1.1/30\nset interfaces xe-0/0/0:3 unit 0 family iso\nset interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::26:1/64\nset policy-options policy-statement adv_global term v4 from route-filter 21.0.0.0/8 orlonger\nset policy-options policy-statement adv_global term v4 from route-filter 12.1.1.1/30 orlonger\nset policy-options policy-statement adv_global term v4 then next-hop 3011::1\nset policy-options policy-statement adv_global term v4 then accept\nset policy-options policy-statement adv_global term v6 from route-filter 2001:21::/64 orlonger\nset policy-options policy-statement adv_global term v6 from route-filter 2001:12:1:1::1/126 orlonger\nset policy-options policy-statement adv_global term v6 then next-hop 3011::1\nset policy-options policy-statement adv_global term v6 then accept\nset policy-options policy-statement adv_vpn1 term v4 from route-filter 31.0.0.0/8 orlonger\nset policy-options policy-statement adv_vpn1 term v4 from route-filter 12.1.1.5/30 orlonger\nset policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target\nset policy-options policy-statement adv_vpn1 term v4 then next-hop 3011::1\nset policy-options policy-statement adv_vpn1 term v4 then accept\nset policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:31::/64 orlonger\nset policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:12:1:1::5/126 orlonger\nset policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target\nset policy-options policy-statement adv_vpn1 term v6 then next-hop 3011::1\nset policy-options policy-statement adv_vpn1 term v6 then accept\nset policy-options policy-statement pplb then load-balance per-packet\nset policy-options community vpn1-target members target:100:1\nset policy-options community vpn2-target members target:100:2\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 12.1.1.5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1012\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 12.1.1.6\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:12:1:1::5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1012\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:12:1:1::6\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::4\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::5\nset routing-instances vpn1 instance-type vrf\nset routing-instances vpn1 interface xe-0/0/1:0.1\nset routing-instances vpn1 route-distinguisher 100:1\nset routing-instances vpn1 vrf-export adv_vpn1\nset routing-instances vpn1 vrf-target target:100:1\nset routing-options source-packet-routing srv6 locator loc1 3011::/64\nset routing-options source-packet-routing srv6 no-reduced-srh\nset routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1\nset routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve\nset routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1\nset routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve\nset routing-options autonomous-system 100\nset routing-options forwarding-table export pplb\nset protocols bgp group to-RR type internal\nset protocols bgp group to-RR local-address abcd::128:53:35:39\nset protocols bgp group to-RR family inet unicast extended-nexthop\nset protocols bgp group to-RR family inet unicast advertise-srv6-service\nset protocols bgp group to-RR family inet unicast accept-srv6-service\nset protocols bgp group to-RR family inet-vpn unicast extended-nexthop\nset protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service\nset protocols bgp group to-RR family inet-vpn unicast accept-srv6-service\nset protocols bgp group to-RR family inet6 unicast advertise-srv6-service\nset protocols bgp group to-RR family inet6 unicast accept-srv6-service\nset protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service\nset protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service\nset protocols bgp group to-RR export adv_global\nset protocols bgp group to-RR neighbor abcd::128:53:38:52\nset protocols bgp group to-TG-global-v4 type external\nset protocols bgp group to-TG-global-v4 local-address 12.1.1.1\nset protocols bgp group to-TG-global-v4 family inet unicast\nset protocols bgp group to-TG-global-v4 family inet6 unicast\nset protocols bgp group to-TG-global-v4 peer-as 1011\nset protocols bgp group to-TG-global-v4 neighbor 12.1.1.2\nset protocols bgp group to-TG-global-v6 type external\nset protocols bgp group to-TG-global-v6 local-address 2001:12:1:1::1\nset protocols bgp group to-TG-global-v6 family inet6 unicast\nset protocols bgp group to-TG-global-v6 peer-as 1011\nset protocols bgp group to-TG-global-v6 neighbor 2001:12:1:1::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3011::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3011::3\nset protocols isis interface all\nset protocols isis interface fxp0.0 disable\nset protocols isis source-packet-routing srv6 locator loc1 end-sid 3011::1 flavor usd\nset protocols isis level 1 disable",
            "路由器 R2": "set chassis network-services enhanced-ip\nset interfaces ge-0/0/0 unit 0 family inet address 3.5.1.1/30\nset interfaces ge-0/0/0 unit 0 family iso\nset interfaces ge-0/0/0 unit 0 family inet6 address 2001:db8::3:5:1/64\nset interfaces ge-0/0/1 unit 0 family inet address 3.6.1.1/30\nset interfaces ge-0/0/1 unit 0 family iso\nset interfaces ge-0/0/1 unit 0 family inet6 address 2001:db8::3:6:1/64\nset interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::2/128\nset policy-options policy-statement adv_global term v4 from route-filter 22.0.0.0/8 orlonger\nset policy-options policy-statement adv_global term v4 from route-filter 13.1.1.1/30 orlonger\nset policy-options policy-statement adv_global term v4 then next-hop 3021::1\nset policy-options policy-statement adv_global term v4 then accept\nset policy-options policy-statement adv_global term v6 from route-filter 2001:22::/64 orlonger\nset policy-options policy-statement adv_global term v6 from route-filter 2001:13:1:1::1/126 orlonger\nset policy-options policy-statement adv_global term v6 then next-hop 3021::1\nset policy-options policy-statement adv_global term v6 then accept\nset policy-options policy-statement adv_vpn1 term v4 from route-filter 32.0.0.0/8 orlonger\nset policy-options policy-statement adv_vpn1 term v4 from route-filter 13.1.1.5/30 orlonger\nset policy-options policy-statement adv_vpn1 term v4 then community set vpn1-target\nset policy-options policy-statement adv_vpn1 term v4 then next-hop 3021::1\nset policy-options policy-statement adv_vpn1 term v4 then accept\nset policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:32::/64 orlonger\nset policy-options policy-statement adv_vpn1 term v6 from route-filter 2001:13:1:1::5/126 orlonger\nset policy-options policy-statement adv_vpn1 term v6 then community set vpn1-target\nset policy-options policy-statement adv_vpn1 term v6 then next-hop 3021::1\nset policy-options policy-statement adv_vpn1 term v6 then accept\nset policy-options policy-statement pplb then load-balance per-packet\nset policy-options community vpn1-target members target:100:1\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 13.1.1.5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1022\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 13.1.1.6\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:13:1:1::5\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1022\nset routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:13:1:1::6\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::4\nset routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::5\nset routing-instances vpn1 instance-type vrf\nset routing-instances vpn1 interface ge-0/0/2.1\nset routing-instances vpn1 route-distinguisher 100:1\nset routing-instances vpn1 vrf-export adv_vpn1\nset routing-instances vpn1 vrf-target target:100:1\nset routing-options source-packet-routing srv6 locator loc1 3021::/64\nset routing-options source-packet-routing srv6 no-reduced-srh\nset routing-options rib inet6.3 static route abcd::128:53:38:52/128 next-hop 3001::1\nset routing-options rib inet6.3 static route abcd::128:53:38:52/128 resolve\nset routing-options rib inet6.0 static route abcd::128:53:38:52/128 next-hop 3001::1\nset routing-options rib inet6.0 static route abcd::128:53:38:52/128 resolve\nset routing-options autonomous-system 100\nset routing-options forwarding-table export pplb\nset protocols bgp group to-RR type internal\nset protocols bgp group to-RR local-address abcd::128:53:35:35\nset protocols bgp group to-RR family inet unicast extended-nexthop\nset protocols bgp group to-RR family inet unicast advertise-srv6-service\nset protocols bgp group to-RR family inet unicast accept-srv6-service\nset protocols bgp group to-RR family inet-vpn unicast extended-nexthop\nset protocols bgp group to-RR family inet-vpn unicast advertise-srv6-service\nset protocols bgp group to-RR family inet-vpn unicast accept-srv6-service\nset protocols bgp group to-RR family inet6 unicast advertise-srv6-service\nset protocols bgp group to-RR family inet6 unicast accept-srv6-service\nset protocols bgp group to-RR family inet6-vpn unicast advertise-srv6-service\nset protocols bgp group to-RR family inet6-vpn unicast accept-srv6-service\nset protocols bgp group to-RR export adv_global\nset protocols bgp group to-RR neighbor abcd::128:53:38:52\nset protocols bgp group to-TG-global-v4 type external\nset protocols bgp group to-TG-global-v4 local-address 13.1.1.1\nset protocols bgp group to-TG-global-v4 family inet unicast\nset protocols bgp group to-TG-global-v4 family inet6 unicast\nset protocols bgp group to-TG-global-v4 peer-as 1021\nset protocols bgp group to-TG-global-v4 neighbor 13.1.1.2\nset protocols bgp group to-TG-global-v6 type external\nset protocols bgp group to-TG-global-v6 local-address 2001:13:1:1::1\nset protocols bgp group to-TG-global-v6 family inet6 unicast\nset protocols bgp group to-TG-global-v6 peer-as 1021\nset protocols bgp group to-TG-global-v6 neighbor 2001:13:1:1::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3021::2\nset protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3021::3\nset protocols isis interface all\nset protocols isis interface fxp0.0 disable\nset protocols isis source-packet-routing srv6 locator loc1 end-sid 3021::1 flavor usd\nset protocols isis level 1 disable",
            "路由器 R3": "set chassis network-services enhanced-ip\nset interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.2/30\nset interfaces xe-0/0/0:0 unit 0 family iso\nset interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:2/64\nset interfaces xe-0/0/1:0 unit 0 family inet address 2.5.1.2/30\nset interfaces xe-0/0/1:0 unit 0 family iso\nset interfaces xe-0/0/1:0 unit 0 family inet6 address 2001:db8::52:0:2/64\nset interfaces xe-0/0/1:1 unit 0 family inet address 3.5.1.2/30\nset interfaces xe-0/0/1:1 unit 0 family iso\nset interfaces xe-0/0/1:1 unit 0 family inet6 address 2001:db8::3:5:2/64\nset interfaces xe-0/0/1:2 unit 0 family inet address 4.6.1.1/30\nset interfaces xe-0/0/1:2 unit 0 family iso\nset interfaces xe-0/0/1:2 unit 0 family inet6 address 2001:db8::4:6:1/64\nset interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::3/128\nset routing-options autonomous-system 100\nset protocols isis interface all\nset protocols isis interface fxp0.0 disable\nset protocols isis level 1 disable",
            "路由器 R4": "set chassis network-services enhanced-ip\nset interfaces xe-0/0/0:0 unit 0 family inet address 1.6.1.2/30\nset interfaces xe-0/0/0:0 unit 0 family iso\nset interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::6:2/64\nset interfaces xe-0/0/0:1 unit 0 family inet address 2.6.1.2/30\nset interfaces xe-0/0/0:1 unit 0 family iso\nset interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:db8::26:2/64\nset interfaces xe-0/0/0:2 unit 0 family inet address 3.6.1.2/30\nset interfaces xe-0/0/0:2 unit 0 family iso\nset interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::3:6:2/64\nset interfaces xe-0/0/0:3 unit 0 family inet address 4.6.1.2/30\nset interfaces xe-0/0/0:3 unit 0 family iso\nset interfaces xe-0/0/0:3 unit 0 family inet6 address 2001:db8::4:6:2/64\nset interfaces lo0 unit 0 family inet6 address 2001:db8:1:255::4/128\nset routing-options autonomous-system 100\nset protocols isis interface all\nset protocols isis interface fxp0.0 disable\nset protocols isis level 1 disable"
          }
        },
        {
          "title": "配置路由器 R0",
          "level": 4,
          "content": "要使用第 3 层 VPN 服务配置 SRv6 网络编程，请在路由器 R0 上执行以下步骤： 配置设备接口以启用 IP 传输。 [edit] user@R0# set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30 user@R0# set interfaces xe-0/0/0:0 unit 0 family iso user@R0# set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64 user@R0# set interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30 user@R0# set interfaces xe-0/0/0:1 unit 0 family iso user@R0# set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126 user@R0# set interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30 user@R0# set interfaces xe-0/0/0:2 unit 0 family iso user@R0# set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64 配置路由器 ID 和自治系统 （AS） 编号，以便在属于同一 AS 的一组路由设备中传播路由信息。 [edit] user@R0# set routing-options router-id 128.53.38.52 user@R0# set routing-options autonomous-system 100 全局启用 SRv6 和定位器地址以指示路由器的 SRv6 功能。SRv6 SID 是由定位器和函数组成的 IPv6 地址。路由协议播发定位器地址。 [edit] user@R0# set routing-options source-packet-routing srv6 locator loc1 3001::/64 user@R0# set routing-options source-packet-routing srv6 no-reduced-srh 为 IPv4 和 IPv6 流量配置外部路由实例 VPN1。为 VPN1 配置 BGP 协议，以便在提供商边缘设备之间启用对等互连和流量传输。 [edit] user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002 user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6 为参与路由实例的每个 PE 路由器配置 VPN 类型和唯一路由识别符。 [edit] user@R0# set routing-instances vpn1 instance-type vrf user@R0# set routing-instances vpn1 interface xe-0/0/0:3.1 user@R0# set routing-instances vpn1 route-distinguisher 100:1 user@R0# set routing-instances vpn1 vrf-target target:100:1 配置结束 dt4 和结束 dt6 SID 值以启用第 3 层 VPN 服务。 [edit] user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4 user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5 定义用于对数据包进行负载平衡的策略。 [edit] user@R0# set policy-options policy-statement pplb then load-balance per-packet user@R0# set policy-options community vpn1-target members target:100:1 user@R0# set policy-options community vpn2-target members target:100:2 应用按数据包策略以启用流量的负载平衡。 [edit] user@R0# set routing-options forwarding-table export pplb 定义一个策略adv_global以接受从 R1 通告的路由。 [edit] user@R0# set policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger user@R0# set policy-options policy-statement adv_global term v4 then next-hop self user@R0# set policy-options policy-statement adv_global term v4 then accept user@R0# set policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger user@R0# set policy-options policy-statement adv_global term v6 then next-hop self user@R0# set policy-options policy-statement adv_global term v6 then accept 在面向核心的接口上配置 BGP，以建立内部和外部对等会话。 [edit] user@R0# set protocols bgp group to-PE-all type internal user@R0# set protocols bgp group to-PE-all local-address abcd::128:53:38:52 user@R0# set protocols bgp group to-PE-all family inet unicast extended-nexthop user@R0# set protocols bgp group to-PE-all family inet unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop user@R0# set protocols bgp group to-PE-all export adv_global user@R0# set protocols bgp group to-PE-all cluster 128.53.38.52 user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:39 user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:35 user@R0# set protocols bgp group to-TG-global-v4 type external user@R0# set protocols bgp group to-TG-global-v4 local-address 11.1.1.1 user@R0# set protocols bgp group to-TG-global-v4 family inet unicast user@R0# set protocols bgp group to-TG-global-v4 family inet6 unicast user@R0# set protocols bgp group to-TG-global-v4 user@R0# set protocols bgp group to-TG-global-v4 neighbor 11.1.1.2 user@R0# set protocols bgp group to-TG-global-v6 type external user@R0# set protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1 user@R0# set protocols bgp group to-TG-global-v6 family inet6 unicast user@R0# set protocols bgp group to-TG-global-v6 peer-as 1001 user@R0# set protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2 使设备能够向 BGP 对等方播发 SRv6 服务，并接受出口提供商边缘 （PE） 设备播发的路由。 [edit] user@R0# set protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet6 unicast accept-srv6-service user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service 启用 IS-IS 作为内部网关协议 （IGP），以便在核心提供商路由器之间路由流量。 [edit] user@R0# set protocols isis interface all user@R0# set protocols isis interface fxp0.0 disable user@R0# set protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd user@R0# set protocols isis level 1 disable 为前缀段配置 end-dt4 和 end-dt6 SID 值。end-dt4 是具有解封装和 IPv4 表查找功能的终结点 SID，end-dt6 是具有解封装和 IPv6 表查找功能的终结点。BGP 为 IPv4 和 IPv6 第 3 层 VPN 服务 SID 分配这些内容。 [edit] user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2 user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "配置设备接口以启用 IP 传输。",
                  "code": [
                    "[edit]",
                    "user@R0# set interfaces xe-0/0/0:0 unit 0 family inet address 1.4.1.1/30",
                    "user@R0# set interfaces xe-0/0/0:0 unit 0 family iso",
                    "user@R0# set interfaces xe-0/0/0:0 unit 0 family inet6 address 2001:db8::4:1/64",
                    "user@R0# set interfaces xe-0/0/0:1 unit 0 family inet address 1.5.1.1/30",
                    "user@R0# set interfaces xe-0/0/0:1 unit 0 family iso",
                    "user@R0# set interfaces xe-0/0/0:1 unit 0 family inet6 address 2001:1:4:2::1/126",
                    "user@R0# set interfaces xe-0/0/0:2 unit 0 family inet address 1.6.1.1/30",
                    "user@R0# set interfaces xe-0/0/0:2 unit 0 family iso",
                    "user@R0# set interfaces xe-0/0/0:2 unit 0 family inet6 address 2001:db8::6:1/64"
                  ]
                },
                {
                  "step": 2,
                  "description": "配置路由器 ID 和自治系统 （AS） 编号，以便在属于同一 AS 的一组路由设备中传播路由信息。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-options router-id 128.53.38.52",
                    "user@R0# set routing-options autonomous-system 100"
                  ]
                },
                {
                  "step": 3,
                  "description": "全局启用 SRv6 和定位器地址以指示路由器的 SRv6 功能。SRv6 SID 是由定位器和函数组成的 IPv6 地址。路由协议播发定位器地址。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-options source-packet-routing srv6 locator loc1 3001::/64",
                    "user@R0# set routing-options source-packet-routing srv6 no-reduced-srh"
                  ]
                },
                {
                  "step": 4,
                  "description": "为 IPv4 和 IPv6 流量配置外部路由实例 VPN1。为 VPN1 配置 BGP 协议，以便在提供商边缘设备之间启用对等互连和流量传输。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 type external",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 local-address 11.1.1.5",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet unicast",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 family inet6 unicast",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 peer-as 1002",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v4 neighbor 11.1.1.6",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 type external",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 local-address 2001:11:1:1::5",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 family inet6 unicast",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 peer-as 1002",
                    "user@R0# set routing-instances vpn1 protocols bgp group to-TG-vpn1-v6 neighbor 2001:11:1:1::6"
                  ]
                },
                {
                  "step": 5,
                  "description": "为参与路由实例的每个 PE 路由器配置 VPN 类型和唯一路由识别符。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-instances vpn1 instance-type vrf",
                    "user@R0# set routing-instances vpn1 interface xe-0/0/0:3.1",
                    "user@R0# set routing-instances vpn1 route-distinguisher 100:1",
                    "user@R0# set routing-instances vpn1 vrf-target target:100:1"
                  ]
                },
                {
                  "step": 6,
                  "description": "配置结束 dt4 和结束 dt6 SID 值以启用第 3 层 VPN 服务。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::4",
                    "user@R0# set routing-instances vpn1 protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::5"
                  ]
                },
                {
                  "step": 7,
                  "description": "定义用于对数据包进行负载平衡的策略。",
                  "code": [
                    "[edit]",
                    "user@R0# set policy-options policy-statement pplb then load-balance per-packet",
                    "user@R0# set policy-options community vpn1-target members target:100:1",
                    "user@R0# set policy-options community vpn2-target members target:100:2"
                  ]
                },
                {
                  "step": 8,
                  "description": "应用按数据包策略以启用流量的负载平衡。",
                  "code": [
                    "[edit]",
                    "user@R0# set routing-options forwarding-table export pplb"
                  ]
                },
                {
                  "step": 9,
                  "description": "定义一个策略adv_global以接受从 R1 通告的路由。",
                  "code": [
                    "[edit]",
                    "user@R0# set policy-options policy-statement adv_global term v4 from route-filter 20.0.0.0/8 orlonger",
                    "user@R0# set policy-options policy-statement adv_global term v4 then next-hop self",
                    "user@R0# set policy-options policy-statement adv_global term v4 then accept",
                    "user@R0# set policy-options policy-statement adv_global term v6 from route-filter 2001:20::/64 orlonger",
                    "user@R0# set policy-options policy-statement adv_global term v6 then next-hop self",
                    "user@R0# set policy-options policy-statement adv_global term v6 then accept"
                  ]
                },
                {
                  "step": 10,
                  "description": "在面向核心的接口上配置 BGP，以建立内部和外部对等会话。",
                  "code": [
                    "[edit]",
                    "user@R0# set protocols bgp group to-PE-all type internal",
                    "user@R0# set protocols bgp group to-PE-all local-address abcd::128:53:38:52",
                    "user@R0# set protocols bgp group to-PE-all family inet unicast extended-nexthop",
                    "user@R0# set protocols bgp group to-PE-all family inet unicast advertise-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet unicast accept-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet-vpn unicast extended-nexthop",
                    "user@R0# set protocols bgp group to-PE-all export adv_global",
                    "user@R0# set protocols bgp group to-PE-all cluster 128.53.38.52",
                    "user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:39",
                    "user@R0# set protocols bgp group to-PE-all neighbor abcd::128:53:35:35",
                    "user@R0# set protocols bgp group to-TG-global-v4 type external",
                    "user@R0# set protocols bgp group to-TG-global-v4 local-address 11.1.1.1",
                    "user@R0# set protocols bgp group to-TG-global-v4 family inet unicast",
                    "user@R0# set protocols bgp group to-TG-global-v4 family inet6 unicast",
                    "user@R0# set protocols bgp group to-TG-global-v4 ",
                    "user@R0# set protocols bgp group to-TG-global-v4 neighbor 11.1.1.2",
                    "user@R0# set protocols bgp group to-TG-global-v6 type external",
                    "user@R0# set protocols bgp group to-TG-global-v6 local-address 2001:11:1:1::1",
                    "user@R0# set protocols bgp group to-TG-global-v6 family inet6 unicast",
                    "user@R0# set protocols bgp group to-TG-global-v6 peer-as 1001",
                    "user@R0# set protocols bgp group to-TG-global-v6 neighbor 2001:11:1:1::2"
                  ]
                },
                {
                  "step": 11,
                  "description": "使设备能够向 BGP 对等方播发 SRv6 服务，并接受出口提供商边缘 （PE） 设备播发的路由。",
                  "code": [
                    "[edit]",
                    "user@R0# set protocols bgp group to-PE-all family inet-vpn unicast advertise-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet-vpn unicast accept-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet6 unicast advertise-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet6 unicast accept-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast advertise-srv6-service",
                    "user@R0# set protocols bgp group to-PE-all family inet6-vpn unicast accept-srv6-service"
                  ]
                },
                {
                  "step": 12,
                  "description": "启用 IS-IS 作为内部网关协议 （IGP），以便在核心提供商路由器之间路由流量。",
                  "code": [
                    "[edit]",
                    "user@R0# set protocols isis interface all",
                    "user@R0# set protocols isis interface fxp0.0 disable",
                    "user@R0# set protocols isis source-packet-routing srv6 locator loc1 end-sid 3001::1 flavor usd",
                    "user@R0# set protocols isis level 1 disable"
                  ]
                },
                {
                  "step": 13,
                  "description": "为前缀段配置 end-dt4 和 end-dt6 SID 值。end-dt4 是具有解封装和 IPv4 表查找功能的终结点 SID，end-dt6 是具有解封装和 IPv6 表查找功能的终结点。BGP 为 IPv4 和 IPv6 第 3 层 VPN 服务 SID 分配这些内容。",
                  "code": [
                    "[edit]",
                    "user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt4-sid 3001::2",
                    "user@R0# set protocols bgp source-packet-routing srv6 locator loc1 end-dt6-sid 3001::3"
                  ]
                }
              ]
            }
          ]
        },
        {
          "title": "结果",
          "level": 4,
          "content": "在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 完成设备配置后，从配置模式输入 commit 。",
          "code": [
            "[edit]\nuser@R0#show interfacesxe-0/0/0:0 {\n    unit 0 {\n        family inet {\n            address 1.4.1.1/30;\n        }\n        family iso;\n        family inet6 {\n            address 2001:db8::4:1/64;\n        }\n    }\n}\nxe-0/0/0:1 {\n    unit 0 {\n        family inet {\n            address 1.5.1.1/30;\n        }\n        family iso;\n        family inet6 {\n            address 2001:1:4:2::1/126;\n        }\n    }\n}\nxe-0/0/0:2 {\n    unit 0 {\n        family inet {\n            address 1.6.1.1/30;\n        }\n        family iso;\n        family inet6 {\n            address 2001:db8::6:1/64;\n        }\n    }\n}",
            "[edit]\nuser@R0#show protocolsbgp {\n    group to-PE-all {\n        type internal;\n        local-address abcd::128:53:38:52;\n        family inet {\n            unicast {\n                extended-nexthop;\n                advertise-srv6-service;\n                accept-srv6-service;\n            }\n        }\n        family inet-vpn {\n            unicast {\n                extended-nexthop;\n                advertise-srv6-service;\n                accept-srv6-service;\n            }\n        }\n        family inet6 {\n            unicast {\n                advertise-srv6-service;\n                accept-srv6-service;\n            }\n        }\n        family inet6-vpn {\n            unicast {\n                advertise-srv6-service;\n                accept-srv6-service;\n            }\n        }\n        export adv_global;\n        cluster 128.53.38.52;\n        neighbor abcd::128:53:35:39;\n        neighbor abcd::128:53:35:35;\n    }\n    group to-TG-global-v4 {\n        type external;\n        local-address 11.1.1.1;\n        family inet {\n            unicast;\n        }\n        family inet6 {\n            unicast;\n        }\n        peer-as 1001;\n        neighbor 11.1.1.2;\n    }\n    group to-TG-global-v6 {\n        type external;\n        local-address 2001:11:1:1::1;\n        family inet6 {\n            unicast;\n        }\n        peer-as 1001;\n        neighbor 2001:11:1:1::2;\n    }\n    source-packet-routing {\n        srv6 {\n            locator loc1 {\n                end-dt4-sid 3001::2;\n                end-dt6-sid 3001::3;\n            }\n        }\n    }\n}\nisis {\n    interface all;\n    interface fxp0.0 {\n        disable;\n    }\n    source-packet-routing {\n        srv6 {\n            locator loc1 {\n                end-sid 3001::1 {\n                    flavor {\n                        usd;\n                    }\n                }\n            }\n        }\n    }\n    level 1 disable;\n}",
            "[edit]\nuser@R0#show policy-optionspolicy-options {\n    policy-statement adv_global {\n        term v4 {\n            from {\n                route-filter 20.0.0.0/8 orlonger;\n            }\n            then {\n                next-hop self;\n                accept;\n            }\n        }\n        term v6 {\n            from {\n                route-filter 2001:20::/64 orlonger;\n            }\n            then {\n                next-hop self;\n                accept;\n            }\n        }\n    }\n    policy-statement pplb {\n        then {\n            load-balance per-packet;\n        }\n    }\n    community vpn1-target members target:100:1;\n    community vpn2-target members target:100:2;\n}",
            "[edit]\nuser@R0#show routing-optionsrouting-options {\n    source-packet-routing {\n        srv6 {\n            locator loc1 3001::/64;\n            no-reduced-srh;\n        }\n    }\n    \n    router-id 128.53.38.52;\n    autonomous-system 100;\n    forwarding-table {\n        export pplb;\n    }\n}",
            "[edit]\nuser@R0#show routing-instancesrouting-instances {\n    vpn1 {\n        protocols {\n            bgp {\n                group to-TG-vpn1-v4 {\n                    type external;\n                    local-address 11.1.1.5;\n                    family inet {\n                        unicast;\n                    }\n                    family inet6 {\n                        unicast;\n                    }\n                    peer-as 1002;\n                    neighbor 11.1.1.6;\n                }\n                group to-TG-vpn1-v6 {\n                    type external;\n                    local-address 2001:11:1:1::5;\n                    family inet6 {\n                        unicast;\n                    }\n                    peer-as 1002;\n                    neighbor 2001:11:1:1::6;\n                }\n                source-packet-routing {\n                    srv6 {\n                        locator loc1 {\n                            end-dt4-sid 3001::4;\n                            end-dt6-sid 3001::5;\n                        }\n                    }\n                }\n            }\n        }\n        instance-type vrf;\n        interface xe-0/0/0:3.1;\n        route-distinguisher 100:1;\n        vrf-target target:100:1;\n    }\n}"
          ]
        }
      ]
    }
  ],
  "content": "此示例说明如何在 BGP 网络中配置 SRv6 网络编程和第 3 层 VPN 服务。SRv6 网络编程提供了利用分段路由的灵活性，无需部署 MPLS。此功能对于网络主要为 IPv6 且尚未部署 MPLS 的服务提供商非常有用"
}
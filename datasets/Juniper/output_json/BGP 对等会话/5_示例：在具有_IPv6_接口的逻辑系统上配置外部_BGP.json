{
  "title": "示例：在具有 IPv6 接口的逻辑系统上配置外部 BGP",
  "sections": [
    {
      "title": "要求",
      "level": 3,
      "content": "在此示例中，不需要除设备初始化之外的特殊配置。"
    },
    {
      "title": "概述",
      "level": 3,
      "content": "Junos OS 通过 IPv6 地址支持 EBGP 对等会话。在语句中 neighbor 指定 IPv6 地址时，可以配置 IPv6 对等会话。此示例使用 EUI-64 生成自动应用于接口的 IPv6 地址。EUI-64 地址是使用 IEEE EUI-64 格式作为地址的接口标识符部分（最后 64 位）的 IPv6 地址。 注： 或者，您可以使用手动分配的 128 位 IPv6 地址配置 EBGP 会话。 如果对接口使用 128 位链路本地地址，则必须包含该 local-interface 语句。此语句仅对 128 位 IPv6 链路本地地址有效，并且对于配置 IPv6 EBGP 链路本地对等会话是必需的。 使用链路本地地址配置 EBGP 对等仅适用于直接连接的接口。不支持多跃点对等互连。 接口启动后，您可以使用 show interfaces terse 命令查看接口上 EUI-64 生成的 IPv6 地址。您必须在 BGP neighbor 语句中使用这些生成的地址。此示例演示完整的端到端过程。 在此示例中，帧中继接口封装应用于逻辑隧道 （ lt ） 接口。这是一项要求，因为在接口上 lt 配置 IPv6 地址时，仅支持帧中继封装。 图 3 显示了具有 BGP 对等会话的网络。在示例网络中，路由器 R1 配置了五个逻辑系统。自治系统 （AS） 17 中的设备 E 与一组名为 的 external-peers 对等方具有 的 BGP 对等会话。对等方 A、B 和 C 位于 AS 22 中。此示例显示了逻辑系统 A 和逻辑系统 E 上的分步配置。 拓扑学 图 3： 具有 BGP 对等会话的典型网络 Junos OS 通过 IPv6 地址支持 EBGP 对等会话。在语句中 neighbor 指定 IPv6 地址时，可以配置 IPv6 对等会话。此示例使用 EUI-64 生成自动应用于接口的 IPv6 地址。EUI-64 地址是使用 IEEE EUI-64 格式作为地址的接口标识符部分（最后 64 位）的 IPv6 地址。 注： 或者，您可以使用手动分配的 128 位 IPv6 地址配置 EBGP 会话。 如果对接口使用 128 位链路本地地址，则必须包含该 local-interface 语句。此语句仅对 128 位 IPv6 链路本地地址有效，并且对于配置 IPv6 EBGP 链路本地对等会话是必需的。 使用链路本地地址配置 EBGP 对等仅适用于直接连接的接口。不支持多跃点对等互连。 或者，您可以使用手动分配的 128 位 IPv6 地址配置 EBGP 会话。 如果对接口使用 128 位链路本地地址，则必须包含该 local-interface 语句。此语句仅对 128 位 IPv6 链路本地地址有效，并且对于配置 IPv6 EBGP 链路本地对等会话是必需的。 使用链路本地地址配置 EBGP 对等仅适用于直接连接的接口。不支持多跃点对等互连。 接口启动后，您可以使用 show interfaces terse 命令查看接口上 EUI-64 生成的 IPv6 地址。您必须在 BGP neighbor 语句中使用这些生成的地址。此示例演示完整的端到端过程。 在此示例中，帧中继接口封装应用于逻辑隧道 （ lt ） 接口。这是一项要求，因为在接口上 lt 配置 IPv6 地址时，仅支持帧中继封装。 图 3 显示了具有 BGP 对等会话的网络。在示例网络中，路由器 R1 配置了五个逻辑系统。自治系统 （AS） 17 中的设备 E 与一组名为 的 external-peers 对等方具有 的 BGP 对等会话。对等方 A、B 和 C 位于 AS 22 中。此示例显示了逻辑系统 A 和逻辑系统 E 上的分步配置。 拓扑学 图 3： 具有 BGP 对等会话的典型网络 图 3： 具有 BGP 对等会话的典型网络",
      "sections": [
        {
          "title": "拓扑学",
          "level": 4,
          "content": "图 3： 具有 BGP 对等会话的典型网络",
          "images": [
            "BGP 对等会话\\images\\5_示例：在具有_IPv6_接口的逻辑系统上_1.gif"
          ]
        }
      ]
    },
    {
      "title": "配置",
      "level": 3,
      "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改详细信息，以便与网络配置匹配，将命令复制并粘贴到 [edit] 层级的 CLI 中，然后从配置模式进入 commit 。 设备 A set logical-systems A interfaces lt-0/1/0 unit 1 description to-E set logical-systems A interfaces lt-0/1/0 unit 1 encapsulation frame-relay set logical-systems A interfaces lt-0/1/0 unit 1 dlci 1 set logical-systems A interfaces lt-0/1/0 unit 1 peer-unit 25 set logical-systems A interfaces lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems A interfaces lo0 unit 1 family inet6 address 2001:db8::1/128 set logical-systems A protocols bgp group external-peers type external set logical-systems A protocols bgp group external-peers peer-as 17 set logical-systems A protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:19da set logical-systems A protocols bgp group external-peers family inet6 unicast set logical-systems A routing-options router-id 172.16.1.1 set logical-systems A routing-options autonomous-system 22 设备 B set logical-systems B interfaces lt-0/1/0 unit 6 description to-E set logical-systems B interfaces lt-0/1/0 unit 6 encapsulation frame-relay set logical-systems B interfaces lt-0/1/0 unit 6 dlci 6 set logical-systems B interfaces lt-0/1/0 unit 6 peer-unit 5 set logical-systems B interfaces lt-0/1/0 unit 6 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems B interfaces lo0 unit 2 family inet6 address 2001:db8::2/128 set logical-systems B protocols bgp group external-peers type external set logical-systems B protocols bgp group external-peers peer-as 17 set logical-systems B protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:5da set logical-systems B protocols bgp group external-peers family inet6 unicast set logical-systems B routing-options router-id 172.16.2.2 set logical-systems B routing-options autonomous-system 22 设备 C set logical-systems C interfaces lt-0/1/0 unit 10 description to-E set logical-systems C interfaces lt-0/1/0 unit 10 encapsulation frame-relay set logical-systems C interfaces lt-0/1/0 unit 10 dlci 10 set logical-systems C interfaces lt-0/1/0 unit 10 peer-unit 9 set logical-systems C interfaces lt-0/1/0 unit 10 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems C interfaces lo0 unit 3 family inet6 address 2001:db8::3/128 set logical-systems C protocols bgp group external-peers type external set logical-systems C protocols bgp group external-peers peer-as 17 set logical-systems C protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:9da set logical-systems C protocols bgp group external-peers family inet6 unicast set logical-systems C routing-options router-id 172.16.3.3 set logical-systems C routing-options autonomous-system 22 设备 D set logical-systems D interfaces lt-0/1/0 unit 7 description to-E set logical-systems D interfaces lt-0/1/0 unit 7 encapsulation frame-relay set logical-systems D interfaces lt-0/1/0 unit 7 dlci 7 set logical-systems D interfaces lt-0/1/0 unit 7 peer-unit 21 set logical-systems D interfaces lt-0/1/0 unit 7 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems D interfaces lo0 unit 4 family inet6 address 2001:db8::4/128 set logical-systems D protocols bgp group external-peers type external set logical-systems D protocols bgp group external-peers peer-as 17 set logical-systems D protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:15da set logical-systems D protocols bgp group external-peers family inet6 unicast set logical-systems D routing-options router-id 172.16.4.4 set logical-systems D routing-options autonomous-system 79 设备 E set logical-systems E interfaces lt-0/1/0 unit 5 description to-B set logical-systems E interfaces lt-0/1/0 unit 5 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 5 dlci 6 set logical-systems E interfaces lt-0/1/0 unit 5 peer-unit 6 set logical-systems E interfaces lt-0/1/0 unit 5 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 9 description to-C set logical-systems E interfaces lt-0/1/0 unit 9 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 9 dlci 10 set logical-systems E interfaces lt-0/1/0 unit 9 peer-unit 10 set logical-systems E interfaces lt-0/1/0 unit 9 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 21 description to-D set logical-systems E interfaces lt-0/1/0 unit 21 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 21 dlci 7 set logical-systems E interfaces lt-0/1/0 unit 21 peer-unit 7 set logical-systems E interfaces lt-0/1/0 unit 21 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 25 description to-A set logical-systems E interfaces lt-0/1/0 unit 25 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 25 dlci 1 set logical-systems E interfaces lt-0/1/0 unit 25 peer-unit 1 set logical-systems E interfaces lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems E interfaces lo0 unit 5 family inet6 address 2001:db8::5/128 set logical-systems E protocols bgp group external-peers type external set logical-systems E protocols bgp group external-peers peer-as 22 set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:1da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:6da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:ada set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:7da peer-as 79 set logical-systems E protocols bgp group external-peers family inet6 unicast set logical-systems E routing-options router-id 172.16.5.5 set logical-systems E routing-options autonomous-system 17 下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅 CLI 用户指南中的在配置模式下使用 CLI 编辑器。 要配置 BGP 对等会话，请执行以下操作： 运行命令以 show interfaces terse 验证物理路由器是否具有逻辑隧道 （ lt ） 接口。 user@R1> show interfaces terse Interface Admin Link Proto Local Remote ... lt-0/1/0 up up ... 在逻辑系统 A 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 E。 user@R1> set cli logical-system A Logical system: A [edit] user@R1:A> edit Entering configuration mode [edit] user@R1:A# edit interfaces [edit interfaces] user@R1:A# set lt-0/1/0 unit 1 encapsulation frame-relay user@R1:A# set lt-0/1/0 unit 1 dlci 1 user@R1:A# set lt-0/1/0 unit 1 peer-unit 25 在逻辑系统 A 上，配置指向对等方 E 的链路的网络地址，并配置环路接口。 [edit interfaces] user@R1:A# set lt-0/1/0 unit 1 description to-E user@R1:A# set lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64 user@R1:A# set lo0 unit 1 family inet6 address 2001:db8::1/128 在逻辑系统 E 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 A。 user@R1> set cli logical-system E Logical system: E [edit] user@R1:E> edit Entering configuration mode [edit] user@R1:E# edit interfaces [edit interfaces] user@R1:E# set lt-0/1/0 unit 25 encapsulation frame-relay user@R1:E# set lt-0/1/0 unit 25 dlci 1 user@R1:E# set lt-0/1/0 unit 25 peer-unit 1 在逻辑系统 E 上，配置指向对等方 A 的链路的网络地址，并配置环路接口。 [edit interfaces] user@R1:E# set lt-0/1/0 unit 25 description to-A user@R1:E# set lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64 user@R1:E# set lo0 unit 5 family inet6 address 2001:db8::5/128 show interfaces terse 运行命令以查看 EUI-64 生成的 IPv6 地址。 此示例中的 BGP neighbor 语句中使用了 2001 地址。 注： fe80 地址是链路本地地址，此示例中不使用。 fe80 地址是链路本地地址，此示例中不使用。 user@R1:A> show interfaces terse Interface Admin Link Proto Local Remote Logical system: A betsy@tp8:A> show interfaces terse Interface Admin Link Proto Local Remote lt-0/1/0 lt-0/1/0.1 up up inet6 2001:db8:0:1:2a0:a502:0:1da/64 fe80::2a0:a502:0:1da/64 lo0 lo0.1 up up inet6 2001:db8::1 fe80::2a0:a50f:fc56:1da user@R1:E> show interfaces terse Interface Admin Link Proto Local Remote lt-0/1/0 lt-0/1/0.25 up up inet6 2001:db8:0:1:2a0:a502:0:19da/64 fe80::2a0:a502:0:19da/64 lo0 lo0.5 up up inet6 2001:db8::5 fe80::2a0:a50f:fc56:1da 在其他逻辑系统上重复接口配置。 在逻辑系统 A 上，创建 BGP 组并添加外部邻居地址。 [edit protocols bgp group external-peers] user@R1:A# set neighbor 2001:db8:0:1:2a0:a502:0:19da user@R1:A# set family inet6 unicast 在逻辑系统 E 上，创建 BGP 组并添加外部邻居地址。 [edit protocols bgp group external-peers] user@R1:E# set neighbor 2001:db8:0:1:2a0:a502:0:1da user@R1:E# set family inet6 unicast 在逻辑系统 A 上，指定外部 AS 的自治系统 （AS） 编号。 [edit protocols bgp group external-peers] user@R1:A# set peer-as 17 在逻辑系统 E 上，指定外部 AS 的自治系统 （AS） 编号。 [edit protocols bgp group external-peers] user@R1:E# set peer-as 22 在逻辑系统 A 上，将对等类型设置为 EBGP。 [edit protocols bgp group external-peers] user@R1:A# set type external 在逻辑系统 E 上，将对等类型设置为 EBGP。 [edit protocols bgp group external-peers] user@R1:E# set type external 在逻辑系统 A 上，设置自治系统 （AS） 编号和路由器 ID。 [edit routing-options] user@R1:A# set router-id 172.16.1.1 user@R1:A# set autonomous-system 22 在逻辑系统 E 上，设置 AS 编号和路由器 ID。 [edit routing-options] user@R1:E# set router-id 172.16.5.5 user@R1:E# set autonomous-system 17 对等方 A、B、C 和 D 重复这些步骤。 在配置模式下，输入 show logical-systems 命令以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 [edit] user@R1# show logical-systems A { interfaces { lt-0/1/0 { unit 1 { description to-E; encapsulation frame-relay; dlci 1; peer-unit 25; family inet6 { address 2001:db8:0:1::/64 { eui-64; } } } } lo0 { unit 1 { family inet6 { address 2001:db8::1/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:1:2a0:a502:0:19da; } } routing-options { router-id 172.16.1.1; autonomous-system 22; } } B { interfaces { lt-0/1/0 { unit 6 { description to-E; encapsulation frame-relay; dlci 6; peer-unit 5; family inet6 { address 2001:db8:0:2::/64 { eui-64; } } } } lo0 { unit 2 { family inet6 { address 2001:db8::2/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:2:2a0:a502:0:5da; } } routing-options { router-id 172.16.2.2; autonomous-system 22; } } C { interfaces { lt-0/1/0 { unit 10 { description to-E; encapsulation frame-relay; dlci 10; peer-unit 9; family inet6 { address 2001:db8:0:3::/64 { eui-64; } } } } lo0 { unit 3 { family inet6 { address 2001:db8::3/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:3:2a0:a502:0:9da; } } } routing-options { router-id 172.16.3.3; autonomous-system 22; } } D { interfaces { lt-0/1/0 { unit 7 { description to-E; encapsulation frame-relay; dlci 7; peer-unit 21; family inet6 { address 2001:db8:0:4::/64 { eui-64; } } } } lo0 { unit 4 { family inet6 { address 2001:db8::4/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:4:2a0:a502:0:15da; } } routing-options { router-id 172.16.4.4; autonomous-system 79; } } E { interfaces { lt-0/1/0 { unit 5 { description to-B; encapsulation frame-relay; dlci 6; peer-unit 6; family inet6 { address 2001:db8:0:2::/64 { eui-64; } } } unit 9 { description to-C; encapsulation frame-relay; dlci 10; peer-unit 10; family inet6 { address 2001:db8:0:3::/64 { eui-64; } } } unit 21 { description to-D; encapsulation frame-relay; dlci 7; peer-unit 7; family inet6 { address 2001:db8:0:4::/64 { eui-64; } } } unit 25 { description to-A; encapsulation frame-relay; dlci 1; peer-unit 1; family inet6 { address 2001:db8:0:1::/64 { eui-64; } } } } lo0 { unit 5 { family inet6 { address 2001:db8::5/128; } } } } protocols { bgp { group external-peers { type external; peer-as 22; neighbor 2001:db8:0:1:2a0:a502:0:1da; neighbor 2001:db8:0:2:2a0:a502:0:6da; neighbor 2001:db8:0:3:2a0:a502:0:ada; neighbor 2001:db8:0:4:2a0:a502:0:7da { peer-as 79; } } } } routing-options { router-id 172.16.5.5; autonomous-system 17; } } 如果完成设备配置，请从配置模式输入 commit 。",
      "sections": [
        {
          "title": "程序",
          "level": 4,
          "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改详细信息，以便与网络配置匹配，将命令复制并粘贴到 [edit] 层级的 CLI 中，然后从配置模式进入 commit 。 设备 A set logical-systems A interfaces lt-0/1/0 unit 1 description to-E set logical-systems A interfaces lt-0/1/0 unit 1 encapsulation frame-relay set logical-systems A interfaces lt-0/1/0 unit 1 dlci 1 set logical-systems A interfaces lt-0/1/0 unit 1 peer-unit 25 set logical-systems A interfaces lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems A interfaces lo0 unit 1 family inet6 address 2001:db8::1/128 set logical-systems A protocols bgp group external-peers type external set logical-systems A protocols bgp group external-peers peer-as 17 set logical-systems A protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:19da set logical-systems A protocols bgp group external-peers family inet6 unicast set logical-systems A routing-options router-id 172.16.1.1 set logical-systems A routing-options autonomous-system 22 设备 B set logical-systems B interfaces lt-0/1/0 unit 6 description to-E set logical-systems B interfaces lt-0/1/0 unit 6 encapsulation frame-relay set logical-systems B interfaces lt-0/1/0 unit 6 dlci 6 set logical-systems B interfaces lt-0/1/0 unit 6 peer-unit 5 set logical-systems B interfaces lt-0/1/0 unit 6 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems B interfaces lo0 unit 2 family inet6 address 2001:db8::2/128 set logical-systems B protocols bgp group external-peers type external set logical-systems B protocols bgp group external-peers peer-as 17 set logical-systems B protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:5da set logical-systems B protocols bgp group external-peers family inet6 unicast set logical-systems B routing-options router-id 172.16.2.2 set logical-systems B routing-options autonomous-system 22 设备 C set logical-systems C interfaces lt-0/1/0 unit 10 description to-E set logical-systems C interfaces lt-0/1/0 unit 10 encapsulation frame-relay set logical-systems C interfaces lt-0/1/0 unit 10 dlci 10 set logical-systems C interfaces lt-0/1/0 unit 10 peer-unit 9 set logical-systems C interfaces lt-0/1/0 unit 10 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems C interfaces lo0 unit 3 family inet6 address 2001:db8::3/128 set logical-systems C protocols bgp group external-peers type external set logical-systems C protocols bgp group external-peers peer-as 17 set logical-systems C protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:9da set logical-systems C protocols bgp group external-peers family inet6 unicast set logical-systems C routing-options router-id 172.16.3.3 set logical-systems C routing-options autonomous-system 22 设备 D set logical-systems D interfaces lt-0/1/0 unit 7 description to-E set logical-systems D interfaces lt-0/1/0 unit 7 encapsulation frame-relay set logical-systems D interfaces lt-0/1/0 unit 7 dlci 7 set logical-systems D interfaces lt-0/1/0 unit 7 peer-unit 21 set logical-systems D interfaces lt-0/1/0 unit 7 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems D interfaces lo0 unit 4 family inet6 address 2001:db8::4/128 set logical-systems D protocols bgp group external-peers type external set logical-systems D protocols bgp group external-peers peer-as 17 set logical-systems D protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:15da set logical-systems D protocols bgp group external-peers family inet6 unicast set logical-systems D routing-options router-id 172.16.4.4 set logical-systems D routing-options autonomous-system 79 设备 E set logical-systems E interfaces lt-0/1/0 unit 5 description to-B set logical-systems E interfaces lt-0/1/0 unit 5 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 5 dlci 6 set logical-systems E interfaces lt-0/1/0 unit 5 peer-unit 6 set logical-systems E interfaces lt-0/1/0 unit 5 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 9 description to-C set logical-systems E interfaces lt-0/1/0 unit 9 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 9 dlci 10 set logical-systems E interfaces lt-0/1/0 unit 9 peer-unit 10 set logical-systems E interfaces lt-0/1/0 unit 9 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 21 description to-D set logical-systems E interfaces lt-0/1/0 unit 21 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 21 dlci 7 set logical-systems E interfaces lt-0/1/0 unit 21 peer-unit 7 set logical-systems E interfaces lt-0/1/0 unit 21 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 25 description to-A set logical-systems E interfaces lt-0/1/0 unit 25 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 25 dlci 1 set logical-systems E interfaces lt-0/1/0 unit 25 peer-unit 1 set logical-systems E interfaces lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems E interfaces lo0 unit 5 family inet6 address 2001:db8::5/128 set logical-systems E protocols bgp group external-peers type external set logical-systems E protocols bgp group external-peers peer-as 22 set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:1da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:6da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:ada set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:7da peer-as 79 set logical-systems E protocols bgp group external-peers family inet6 unicast set logical-systems E routing-options router-id 172.16.5.5 set logical-systems E routing-options autonomous-system 17 下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅 CLI 用户指南中的在配置模式下使用 CLI 编辑器。 要配置 BGP 对等会话，请执行以下操作： 运行命令以 show interfaces terse 验证物理路由器是否具有逻辑隧道 （ lt ） 接口。 user@R1> show interfaces terse Interface Admin Link Proto Local Remote ... lt-0/1/0 up up ... 在逻辑系统 A 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 E。 user@R1> set cli logical-system A Logical system: A [edit] user@R1:A> edit Entering configuration mode [edit] user@R1:A# edit interfaces [edit interfaces] user@R1:A# set lt-0/1/0 unit 1 encapsulation frame-relay user@R1:A# set lt-0/1/0 unit 1 dlci 1 user@R1:A# set lt-0/1/0 unit 1 peer-unit 25 在逻辑系统 A 上，配置指向对等方 E 的链路的网络地址，并配置环路接口。 [edit interfaces] user@R1:A# set lt-0/1/0 unit 1 description to-E user@R1:A# set lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64 user@R1:A# set lo0 unit 1 family inet6 address 2001:db8::1/128 在逻辑系统 E 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 A。 user@R1> set cli logical-system E Logical system: E [edit] user@R1:E> edit Entering configuration mode [edit] user@R1:E# edit interfaces [edit interfaces] user@R1:E# set lt-0/1/0 unit 25 encapsulation frame-relay user@R1:E# set lt-0/1/0 unit 25 dlci 1 user@R1:E# set lt-0/1/0 unit 25 peer-unit 1 在逻辑系统 E 上，配置指向对等方 A 的链路的网络地址，并配置环路接口。 [edit interfaces] user@R1:E# set lt-0/1/0 unit 25 description to-A user@R1:E# set lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64 user@R1:E# set lo0 unit 5 family inet6 address 2001:db8::5/128 show interfaces terse 运行命令以查看 EUI-64 生成的 IPv6 地址。 此示例中的 BGP neighbor 语句中使用了 2001 地址。 注： fe80 地址是链路本地地址，此示例中不使用。 fe80 地址是链路本地地址，此示例中不使用。 user@R1:A> show interfaces terse Interface Admin Link Proto Local Remote Logical system: A betsy@tp8:A> show interfaces terse Interface Admin Link Proto Local Remote lt-0/1/0 lt-0/1/0.1 up up inet6 2001:db8:0:1:2a0:a502:0:1da/64 fe80::2a0:a502:0:1da/64 lo0 lo0.1 up up inet6 2001:db8::1 fe80::2a0:a50f:fc56:1da user@R1:E> show interfaces terse Interface Admin Link Proto Local Remote lt-0/1/0 lt-0/1/0.25 up up inet6 2001:db8:0:1:2a0:a502:0:19da/64 fe80::2a0:a502:0:19da/64 lo0 lo0.5 up up inet6 2001:db8::5 fe80::2a0:a50f:fc56:1da 在其他逻辑系统上重复接口配置。",
          "sections": [
            {
              "title": "CLI 快速配置",
              "level": 5,
              "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改详细信息，以便与网络配置匹配，将命令复制并粘贴到 [edit] 层级的 CLI 中，然后从配置模式进入 commit 。 设备 A set logical-systems A interfaces lt-0/1/0 unit 1 description to-E set logical-systems A interfaces lt-0/1/0 unit 1 encapsulation frame-relay set logical-systems A interfaces lt-0/1/0 unit 1 dlci 1 set logical-systems A interfaces lt-0/1/0 unit 1 peer-unit 25 set logical-systems A interfaces lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems A interfaces lo0 unit 1 family inet6 address 2001:db8::1/128 set logical-systems A protocols bgp group external-peers type external set logical-systems A protocols bgp group external-peers peer-as 17 set logical-systems A protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:19da set logical-systems A protocols bgp group external-peers family inet6 unicast set logical-systems A routing-options router-id 172.16.1.1 set logical-systems A routing-options autonomous-system 22 设备 B set logical-systems B interfaces lt-0/1/0 unit 6 description to-E set logical-systems B interfaces lt-0/1/0 unit 6 encapsulation frame-relay set logical-systems B interfaces lt-0/1/0 unit 6 dlci 6 set logical-systems B interfaces lt-0/1/0 unit 6 peer-unit 5 set logical-systems B interfaces lt-0/1/0 unit 6 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems B interfaces lo0 unit 2 family inet6 address 2001:db8::2/128 set logical-systems B protocols bgp group external-peers type external set logical-systems B protocols bgp group external-peers peer-as 17 set logical-systems B protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:5da set logical-systems B protocols bgp group external-peers family inet6 unicast set logical-systems B routing-options router-id 172.16.2.2 set logical-systems B routing-options autonomous-system 22 设备 C set logical-systems C interfaces lt-0/1/0 unit 10 description to-E set logical-systems C interfaces lt-0/1/0 unit 10 encapsulation frame-relay set logical-systems C interfaces lt-0/1/0 unit 10 dlci 10 set logical-systems C interfaces lt-0/1/0 unit 10 peer-unit 9 set logical-systems C interfaces lt-0/1/0 unit 10 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems C interfaces lo0 unit 3 family inet6 address 2001:db8::3/128 set logical-systems C protocols bgp group external-peers type external set logical-systems C protocols bgp group external-peers peer-as 17 set logical-systems C protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:9da set logical-systems C protocols bgp group external-peers family inet6 unicast set logical-systems C routing-options router-id 172.16.3.3 set logical-systems C routing-options autonomous-system 22 设备 D set logical-systems D interfaces lt-0/1/0 unit 7 description to-E set logical-systems D interfaces lt-0/1/0 unit 7 encapsulation frame-relay set logical-systems D interfaces lt-0/1/0 unit 7 dlci 7 set logical-systems D interfaces lt-0/1/0 unit 7 peer-unit 21 set logical-systems D interfaces lt-0/1/0 unit 7 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems D interfaces lo0 unit 4 family inet6 address 2001:db8::4/128 set logical-systems D protocols bgp group external-peers type external set logical-systems D protocols bgp group external-peers peer-as 17 set logical-systems D protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:15da set logical-systems D protocols bgp group external-peers family inet6 unicast set logical-systems D routing-options router-id 172.16.4.4 set logical-systems D routing-options autonomous-system 79 设备 E set logical-systems E interfaces lt-0/1/0 unit 5 description to-B set logical-systems E interfaces lt-0/1/0 unit 5 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 5 dlci 6 set logical-systems E interfaces lt-0/1/0 unit 5 peer-unit 6 set logical-systems E interfaces lt-0/1/0 unit 5 family inet6 address 2001:db8:0:2::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 9 description to-C set logical-systems E interfaces lt-0/1/0 unit 9 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 9 dlci 10 set logical-systems E interfaces lt-0/1/0 unit 9 peer-unit 10 set logical-systems E interfaces lt-0/1/0 unit 9 family inet6 address 2001:db8:0:3::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 21 description to-D set logical-systems E interfaces lt-0/1/0 unit 21 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 21 dlci 7 set logical-systems E interfaces lt-0/1/0 unit 21 peer-unit 7 set logical-systems E interfaces lt-0/1/0 unit 21 family inet6 address 2001:db8:0:4::/64 eui-64 set logical-systems E interfaces lt-0/1/0 unit 25 description to-A set logical-systems E interfaces lt-0/1/0 unit 25 encapsulation frame-relay set logical-systems E interfaces lt-0/1/0 unit 25 dlci 1 set logical-systems E interfaces lt-0/1/0 unit 25 peer-unit 1 set logical-systems E interfaces lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64 set logical-systems E interfaces lo0 unit 5 family inet6 address 2001:db8::5/128 set logical-systems E protocols bgp group external-peers type external set logical-systems E protocols bgp group external-peers peer-as 22 set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:1da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:6da set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:ada set logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:7da peer-as 79 set logical-systems E protocols bgp group external-peers family inet6 unicast set logical-systems E routing-options router-id 172.16.5.5 set logical-systems E routing-options autonomous-system 17",
              "commands_by_device": {
                "设备 A": "set logical-systems A interfaces lt-0/1/0 unit 1 description to-E\nset logical-systems A interfaces lt-0/1/0 unit 1 encapsulation frame-relay\nset logical-systems A interfaces lt-0/1/0 unit 1 dlci 1\nset logical-systems A interfaces lt-0/1/0 unit 1 peer-unit 25\nset logical-systems A interfaces lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64\nset logical-systems A interfaces lo0 unit 1 family inet6 address 2001:db8::1/128\nset logical-systems A protocols bgp group external-peers type external\nset logical-systems A protocols bgp group external-peers peer-as 17\nset logical-systems A protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:19da\nset logical-systems A protocols bgp group external-peers family inet6 unicast\nset logical-systems A routing-options router-id 172.16.1.1\nset logical-systems A routing-options autonomous-system 22",
                "设备 B": "set logical-systems B interfaces lt-0/1/0 unit 6 description to-E\nset logical-systems B interfaces lt-0/1/0 unit 6 encapsulation frame-relay\nset logical-systems B interfaces lt-0/1/0 unit 6 dlci 6\nset logical-systems B interfaces lt-0/1/0 unit 6 peer-unit 5\nset logical-systems B interfaces lt-0/1/0 unit 6 family inet6 address 2001:db8:0:2::/64 eui-64\nset logical-systems B interfaces lo0 unit 2 family inet6 address 2001:db8::2/128\nset logical-systems B protocols bgp group external-peers type external\nset logical-systems B protocols bgp group external-peers peer-as 17\nset logical-systems B protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:5da\nset logical-systems B protocols bgp group external-peers family inet6 unicast\nset logical-systems B routing-options router-id 172.16.2.2\nset logical-systems B routing-options autonomous-system 22",
                "设备 C": "set logical-systems C interfaces lt-0/1/0 unit 10 description to-E\nset logical-systems C interfaces lt-0/1/0 unit 10 encapsulation frame-relay\nset logical-systems C interfaces lt-0/1/0 unit 10 dlci 10\nset logical-systems C interfaces lt-0/1/0 unit 10 peer-unit 9\nset logical-systems C interfaces lt-0/1/0 unit 10 family inet6 address 2001:db8:0:3::/64 eui-64\nset logical-systems C interfaces lo0 unit 3 family inet6 address 2001:db8::3/128\nset logical-systems C protocols bgp group external-peers type external\nset logical-systems C protocols bgp group external-peers peer-as 17\nset logical-systems C protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:9da\nset logical-systems C protocols bgp group external-peers family inet6 unicast\nset logical-systems C routing-options router-id 172.16.3.3\nset logical-systems C routing-options autonomous-system 22",
                "设备 D": "set logical-systems D interfaces lt-0/1/0 unit 7 description to-E\nset logical-systems D interfaces lt-0/1/0 unit 7 encapsulation frame-relay\nset logical-systems D interfaces lt-0/1/0 unit 7 dlci 7\nset logical-systems D interfaces lt-0/1/0 unit 7 peer-unit 21\nset logical-systems D interfaces lt-0/1/0 unit 7 family inet6 address 2001:db8:0:4::/64 eui-64\nset logical-systems D interfaces lo0 unit 4 family inet6 address 2001:db8::4/128\nset logical-systems D protocols bgp group external-peers type external\nset logical-systems D protocols bgp group external-peers peer-as 17\nset logical-systems D protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:15da\nset logical-systems D protocols bgp group external-peers family inet6 unicast\nset logical-systems D routing-options router-id 172.16.4.4\nset logical-systems D routing-options autonomous-system 79",
                "设备 E": "set logical-systems E interfaces lt-0/1/0 unit 5 description to-B\nset logical-systems E interfaces lt-0/1/0 unit 5 encapsulation frame-relay\nset logical-systems E interfaces lt-0/1/0 unit 5 dlci 6\nset logical-systems E interfaces lt-0/1/0 unit 5 peer-unit 6\nset logical-systems E interfaces lt-0/1/0 unit 5 family inet6 address 2001:db8:0:2::/64 eui-64\nset logical-systems E interfaces lt-0/1/0 unit 9 description to-C\nset logical-systems E interfaces lt-0/1/0 unit 9 encapsulation frame-relay\nset logical-systems E interfaces lt-0/1/0 unit 9 dlci 10\nset logical-systems E interfaces lt-0/1/0 unit 9 peer-unit 10\nset logical-systems E interfaces lt-0/1/0 unit 9 family inet6 address 2001:db8:0:3::/64 eui-64\nset logical-systems E interfaces lt-0/1/0 unit 21 description to-D\nset logical-systems E interfaces lt-0/1/0 unit 21 encapsulation frame-relay\nset logical-systems E interfaces lt-0/1/0 unit 21 dlci 7\nset logical-systems E interfaces lt-0/1/0 unit 21 peer-unit 7\nset logical-systems E interfaces lt-0/1/0 unit 21 family inet6 address 2001:db8:0:4::/64 eui-64\nset logical-systems E interfaces lt-0/1/0 unit 25 description to-A\nset logical-systems E interfaces lt-0/1/0 unit 25 encapsulation frame-relay\nset logical-systems E interfaces lt-0/1/0 unit 25 dlci 1\nset logical-systems E interfaces lt-0/1/0 unit 25 peer-unit 1\nset logical-systems E interfaces lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64\nset logical-systems E interfaces lo0 unit 5 family inet6 address 2001:db8::5/128\nset logical-systems E protocols bgp group external-peers type external\nset logical-systems E protocols bgp group external-peers peer-as 22\nset logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:1:2a0:a502:0:1da\nset logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:2:2a0:a502:0:6da\nset logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:3:2a0:a502:0:ada\nset logical-systems E protocols bgp group external-peers neighbor 2001:db8:0:4:2a0:a502:0:7da peer-as 79\nset logical-systems E protocols bgp group external-peers family inet6 unicast\nset logical-systems E routing-options router-id 172.16.5.5\nset logical-systems E routing-options autonomous-system 17"
              }
            },
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "运行命令以 show interfaces terse 验证物理路由器是否具有逻辑隧道 （ lt ） 接口。",
                  "code": [
                    "user@R1> show interfaces terse",
                    "Interface               Admin Link Proto    Local                 Remote",
                    "...",
                    "lt-0/1/0                up    up  ",
                    "..."
                  ]
                },
                {
                  "step": 2,
                  "description": "在逻辑系统 A 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 E。",
                  "code": [
                    "user@R1> set cli logical-system A",
                    "Logical system: A",
                    "[edit]",
                    "user@R1:A> edit",
                    "Entering configuration mode",
                    "[edit]",
                    "user@R1:A# edit interfaces",
                    "[edit interfaces]",
                    "user@R1:A# set lt-0/1/0 unit 1 encapsulation frame-relay",
                    "user@R1:A# set lt-0/1/0 unit 1 dlci 1",
                    "user@R1:A# set lt-0/1/0 unit 1 peer-unit 25"
                  ]
                },
                {
                  "step": 3,
                  "description": "在逻辑系统 A 上，配置指向对等方 E 的链路的网络地址，并配置环路接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@R1:A# set lt-0/1/0 unit 1 description to-E",
                    "user@R1:A# set lt-0/1/0 unit 1 family inet6 address 2001:db8:0:1::/64 eui-64",
                    "user@R1:A# set lo0 unit 1 family inet6 address 2001:db8::1/128"
                  ]
                },
                {
                  "step": 4,
                  "description": "在逻辑系统 E 上，配置接口封装、对等单元编号和 DLCI 以访问逻辑系统 A。",
                  "code": [
                    "user@R1> set cli logical-system E",
                    "Logical system: E",
                    "[edit]",
                    "user@R1:E> edit",
                    "Entering configuration mode",
                    "[edit]",
                    "user@R1:E# edit interfaces",
                    "[edit interfaces]",
                    "user@R1:E# set lt-0/1/0 unit 25 encapsulation frame-relay",
                    "user@R1:E# set lt-0/1/0 unit 25 dlci 1",
                    "user@R1:E# set lt-0/1/0 unit 25 peer-unit 1"
                  ]
                },
                {
                  "step": 5,
                  "description": "在逻辑系统 E 上，配置指向对等方 A 的链路的网络地址，并配置环路接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@R1:E# set lt-0/1/0 unit 25 description to-A",
                    "user@R1:E# set lt-0/1/0 unit 25 family inet6 address 2001:db8:0:1::/64 eui-64",
                    "user@R1:E# set lo0 unit 5 family inet6 address 2001:db8::5/128"
                  ]
                },
                {
                  "step": 6,
                  "description": "show interfaces terse 运行命令以查看 EUI-64 生成的 IPv6 地址。",
                  "code": [
                    "user@R1:A> show interfaces terse",
                    "Interface               Admin Link Proto    Local                 Remote",
                    "Logical system: A",
                    "betsy@tp8:A> show interfaces terse ",
                    "Interface               Admin Link Proto    Local                 Remote",
                    "lt-0/1/0               ",
                    "lt-0/1/0.1              up    up   inet6    2001:db8:0:1:2a0:a502:0:1da/64",
                    "                                            fe80::2a0:a502:0:1da/64",
                    "lo0                    ",
                    "lo0.1                   up    up   inet6    2001:db8::1     ",
                    "                                            fe80::2a0:a50f:fc56:1da",
                    "user@R1:E> show interfaces terse",
                    "Interface               Admin Link Proto    Local                 Remote",
                    "lt-0/1/0               ",
                    "lt-0/1/0.25             up    up   inet6    2001:db8:0:1:2a0:a502:0:19da/64",
                    "                                            fe80::2a0:a502:0:19da/64",
                    "lo0                    ",
                    "lo0.5                   up    up   inet6    2001:db8::5     ",
                    "                                            fe80::2a0:a50f:fc56:1da"
                  ]
                },
                {
                  "step": 7,
                  "description": "在其他逻辑系统上重复接口配置。",
                  "code": []
                }
              ]
            }
          ]
        },
        {
          "title": "配置外部 BGP 会话",
          "level": 4,
          "content": "下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅 CLI 用户指南中的在配置模式下使用 CLI 编辑器。 要配置 BGP 对等会话，请执行以下操作： 在逻辑系统 A 上，创建 BGP 组并添加外部邻居地址。 [edit protocols bgp group external-peers] user@R1:A# set neighbor 2001:db8:0:1:2a0:a502:0:19da user@R1:A# set family inet6 unicast 在逻辑系统 E 上，创建 BGP 组并添加外部邻居地址。 [edit protocols bgp group external-peers] user@R1:E# set neighbor 2001:db8:0:1:2a0:a502:0:1da user@R1:E# set family inet6 unicast 在逻辑系统 A 上，指定外部 AS 的自治系统 （AS） 编号。 [edit protocols bgp group external-peers] user@R1:A# set peer-as 17 在逻辑系统 E 上，指定外部 AS 的自治系统 （AS） 编号。 [edit protocols bgp group external-peers] user@R1:E# set peer-as 22 在逻辑系统 A 上，将对等类型设置为 EBGP。 [edit protocols bgp group external-peers] user@R1:A# set type external 在逻辑系统 E 上，将对等类型设置为 EBGP。 [edit protocols bgp group external-peers] user@R1:E# set type external 在逻辑系统 A 上，设置自治系统 （AS） 编号和路由器 ID。 [edit routing-options] user@R1:A# set router-id 172.16.1.1 user@R1:A# set autonomous-system 22 在逻辑系统 E 上，设置 AS 编号和路由器 ID。 [edit routing-options] user@R1:E# set router-id 172.16.5.5 user@R1:E# set autonomous-system 17 对等方 A、B、C 和 D 重复这些步骤。 在配置模式下，输入 show logical-systems 命令以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 [edit] user@R1# show logical-systems A { interfaces { lt-0/1/0 { unit 1 { description to-E; encapsulation frame-relay; dlci 1; peer-unit 25; family inet6 { address 2001:db8:0:1::/64 { eui-64; } } } } lo0 { unit 1 { family inet6 { address 2001:db8::1/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:1:2a0:a502:0:19da; } } routing-options { router-id 172.16.1.1; autonomous-system 22; } } B { interfaces { lt-0/1/0 { unit 6 { description to-E; encapsulation frame-relay; dlci 6; peer-unit 5; family inet6 { address 2001:db8:0:2::/64 { eui-64; } } } } lo0 { unit 2 { family inet6 { address 2001:db8::2/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:2:2a0:a502:0:5da; } } routing-options { router-id 172.16.2.2; autonomous-system 22; } } C { interfaces { lt-0/1/0 { unit 10 { description to-E; encapsulation frame-relay; dlci 10; peer-unit 9; family inet6 { address 2001:db8:0:3::/64 { eui-64; } } } } lo0 { unit 3 { family inet6 { address 2001:db8::3/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:3:2a0:a502:0:9da; } } } routing-options { router-id 172.16.3.3; autonomous-system 22; } } D { interfaces { lt-0/1/0 { unit 7 { description to-E; encapsulation frame-relay; dlci 7; peer-unit 21; family inet6 { address 2001:db8:0:4::/64 { eui-64; } } } } lo0 { unit 4 { family inet6 { address 2001:db8::4/128; } } } } protocols { bgp { group external-peers { type external; peer-as 17; neighbor 2001:db8:0:4:2a0:a502:0:15da; } } routing-options { router-id 172.16.4.4; autonomous-system 79; } } E { interfaces { lt-0/1/0 { unit 5 { description to-B; encapsulation frame-relay; dlci 6; peer-unit 6; family inet6 { address 2001:db8:0:2::/64 { eui-64; } } } unit 9 { description to-C; encapsulation frame-relay; dlci 10; peer-unit 10; family inet6 { address 2001:db8:0:3::/64 { eui-64; } } } unit 21 { description to-D; encapsulation frame-relay; dlci 7; peer-unit 7; family inet6 { address 2001:db8:0:4::/64 { eui-64; } } } unit 25 { description to-A; encapsulation frame-relay; dlci 1; peer-unit 1; family inet6 { address 2001:db8:0:1::/64 { eui-64; } } } } lo0 { unit 5 { family inet6 { address 2001:db8::5/128; } } } } protocols { bgp { group external-peers { type external; peer-as 22; neighbor 2001:db8:0:1:2a0:a502:0:1da; neighbor 2001:db8:0:2:2a0:a502:0:6da; neighbor 2001:db8:0:3:2a0:a502:0:ada; neighbor 2001:db8:0:4:2a0:a502:0:7da { peer-as 79; } } } } routing-options { router-id 172.16.5.5; autonomous-system 17; } } 如果完成设备配置，请从配置模式输入 commit 。",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "在逻辑系统 A 上，创建 BGP 组并添加外部邻居地址。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:A# set neighbor 2001:db8:0:1:2a0:a502:0:19da",
                    "user@R1:A# set family inet6 unicast"
                  ]
                },
                {
                  "step": 2,
                  "description": "在逻辑系统 E 上，创建 BGP 组并添加外部邻居地址。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:E# set neighbor 2001:db8:0:1:2a0:a502:0:1da ",
                    "user@R1:E# set family inet6 unicast"
                  ]
                },
                {
                  "step": 3,
                  "description": "在逻辑系统 A 上，指定外部 AS 的自治系统 （AS） 编号。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:A# set peer-as 17"
                  ]
                },
                {
                  "step": 4,
                  "description": "在逻辑系统 E 上，指定外部 AS 的自治系统 （AS） 编号。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:E# set peer-as 22"
                  ]
                },
                {
                  "step": 5,
                  "description": "在逻辑系统 A 上，将对等类型设置为 EBGP。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:A# set type external"
                  ]
                },
                {
                  "step": 6,
                  "description": "在逻辑系统 E 上，将对等类型设置为 EBGP。",
                  "code": [
                    "[edit protocols bgp group external-peers]",
                    "user@R1:E# set type external"
                  ]
                },
                {
                  "step": 7,
                  "description": "在逻辑系统 A 上，设置自治系统 （AS） 编号和路由器 ID。",
                  "code": [
                    "[edit routing-options]",
                    "user@R1:A# set router-id 172.16.1.1",
                    "user@R1:A# set autonomous-system 22"
                  ]
                },
                {
                  "step": 8,
                  "description": "在逻辑系统 E 上，设置 AS 编号和路由器 ID。",
                  "code": [
                    "[edit routing-options]",
                    "user@R1:E# set router-id 172.16.5.5",
                    "user@R1:E# set autonomous-system 17"
                  ]
                },
                {
                  "step": 9,
                  "description": "对等方 A、B、C 和 D 重复这些步骤。",
                  "code": []
                }
              ]
            },
            {
              "title": "结果",
              "level": 5,
              "content": "在配置模式下，输入 show logical-systems 命令以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 如果完成设备配置，请从配置模式输入 commit 。",
              "code": [
                "[edit]\nuser@R1#show logical-systemsA {\n    interfaces {\n        lt-0/1/0 {\n            unit 1 {\n                description to-E;\n                encapsulation frame-relay;\n                dlci 1;\n                peer-unit 25;\n                family inet6 {\n                    address 2001:db8:0:1::/64 {\n                        eui-64;\n                    }\n                }\n            }\n        }\n        lo0 {\n            unit 1 {\n                family inet6 {\n                    address 2001:db8::1/128;\n                }\n            }\n        }\n    }\n    protocols {\n        bgp {\n            group external-peers {\n                type external;\n                peer-as 17;\n                neighbor 2001:db8:0:1:2a0:a502:0:19da;\n            }\n        }\n        routing-options {\n            router-id 172.16.1.1;\n            autonomous-system 22;\n        }\n    }\n    B {\n        interfaces {\n            lt-0/1/0 {\n                unit 6 {\n                    description to-E;\n                    encapsulation frame-relay;\n                    dlci 6;\n                    peer-unit 5;\n                    family inet6 {\n                        address 2001:db8:0:2::/64 {\n                            eui-64;\n                        }\n                    }\n                }\n            }\n            lo0 {\n                unit 2 {\n                    family inet6 {\n                        address 2001:db8::2/128;\n                    }\n                }\n            }\n        }\n        protocols {\n            bgp {\n                group external-peers {\n                    type external;\n                    peer-as 17;\n                    neighbor 2001:db8:0:2:2a0:a502:0:5da;\n                }\n            }\n            routing-options {\n                router-id 172.16.2.2;\n                autonomous-system 22;\n            }\n        }\n        C {\n            interfaces {\n                lt-0/1/0 {\n                    unit 10 {\n                        description to-E;\n                        encapsulation frame-relay;\n                        dlci 10;\n                        peer-unit 9;\n                        family inet6 {\n                            address 2001:db8:0:3::/64 {\n                                eui-64;\n                            }\n                        }\n                    }\n                }\n                lo0 {\n                    unit 3 {\n                        family inet6 {\n                            address 2001:db8::3/128;\n                        }\n                    }\n                }\n            }\n            protocols {\n                bgp {\n                    group external-peers {\n                        type external;\n                        peer-as 17;\n                        neighbor 2001:db8:0:3:2a0:a502:0:9da;\n                    }\n                }\n            }\n            routing-options {\n                router-id 172.16.3.3;\n                autonomous-system 22;\n            }\n        }\n        D {\n            interfaces {\n                lt-0/1/0 {\n                    unit 7 {\n                        description to-E;\n                        encapsulation frame-relay;\n                        dlci 7;\n                        peer-unit 21;\n                        family inet6 {\n                            address 2001:db8:0:4::/64 {\n                                eui-64;\n                            }\n                        }\n                    }\n                }\n                lo0 {\n                    unit 4 {\n                        family inet6 {\n                            address 2001:db8::4/128;\n                        }\n                    }\n                }\n            }\n            protocols {\n                bgp {\n                    group external-peers {\n                        type external;\n                        peer-as 17;\n                        neighbor 2001:db8:0:4:2a0:a502:0:15da;\n                    }\n                }\n                routing-options {\n                    router-id 172.16.4.4;\n                    autonomous-system 79;\n                }\n            }\n            E {\n                interfaces {\n                    lt-0/1/0 {\n                        unit 5 {\n                            description to-B;\n                            encapsulation frame-relay;\n                            dlci 6;\n                            peer-unit 6;\n                            family inet6 {\n                                address 2001:db8:0:2::/64 {\n                                    eui-64;\n                                }\n                            }\n                        }\n                        unit 9 {\n                            description to-C;\n                            encapsulation frame-relay;\n                            dlci 10;\n                            peer-unit 10;\n                            family inet6 {\n                                address 2001:db8:0:3::/64 {\n                                    eui-64;\n                                }\n                            }\n                        }\n                        unit 21 {\n                            description to-D;\n                            encapsulation frame-relay;\n                            dlci 7;\n                            peer-unit 7;\n                            family inet6 {\n                                address 2001:db8:0:4::/64 {\n                                    eui-64;\n                                }\n                            }\n                        }\n                        unit 25 {\n                            description to-A;\n                            encapsulation frame-relay;\n                            dlci 1;\n                            peer-unit 1;\n                            family inet6 {\n                                address 2001:db8:0:1::/64 {\n                                    eui-64;\n                                }\n                            }\n                        }\n                    }\n                    lo0 {\n                        unit 5 {\n                            family inet6 {\n                                address 2001:db8::5/128;\n                            }\n                        }\n                    }\n                }\n                protocols {\n                    bgp {\n                        group external-peers {\n                            type external;\n                            peer-as 22;\n                            neighbor 2001:db8:0:1:2a0:a502:0:1da;\n                            neighbor 2001:db8:0:2:2a0:a502:0:6da;\n                            neighbor 2001:db8:0:3:2a0:a502:0:ada;\n                            neighbor 2001:db8:0:4:2a0:a502:0:7da {\n                                peer-as 79;\n                            }\n                        }\n                    }\n                }\n                routing-options {\n                    router-id 172.16.5.5;\n                    autonomous-system 17;\n                }\n            }"
              ]
            }
          ]
        }
      ]
    }
  ],
  "content": "此示例说明如何在具有 IPv6 接口的逻辑系统上配置外部 BGP （EBGP） 点对点会话。 要求 在此示例中，不需要除设备初始化之外的特殊配置。 概述 Junos OS 通过 IPv6 地址支持 EBGP 对等会话。在语句中 neighbor 指定 IPv6 地址时，可以配置 IPv6 对等会话。此示例使用 EUI-64 生成自动应用于接口的 IPv6 地址。EUI-64 地址是使用 IEEE EUI-64 格式作为地址的接口标识符部分（最后 64 位）的 IPv6 地址。 注： 或者，您可以使用手动分配的 128 位 IPv6 地址配置 EBGP 会话。 如果对接口使用 128 位链路本地地址，则必须包含该 local-interface 语句。此语句仅对 128 位 IPv6 链路本地地址有效，并且对于配置 IPv6 EBGP 链路本地对等会话是必需的。 使用链路本地地址配置 EBGP 对等仅适用于直接连接的接口。不支持多跃点对等互连。 接口启动后，您可以使用 show interfaces terse 命令查看接口上 EUI-64 生成的 IPv6 地址。您必须在 BGP neighbor 语句中使用这些生成的地址。此示例演示完整的端到端过程。 在此示例中，帧中继接口封装应用于逻辑隧道 （ lt ） 接口。这是一项要求，因为在接口上 lt 配置 IPv6 地址时，仅支持帧中继封装。 图 3 显示了具有 BGP 对等会话的网络。在示例网络中，路由器 R1 配置了五个逻辑系统。自治系统 （AS） 17 中的设备 E 与一组名为 的 external-peers 对等方具有 的 BGP 对等会话。对等方 A、B 和 C 位于 AS 22 中。此示例显示了逻辑系统 A 和逻辑系统 E 上的分步配置"
}
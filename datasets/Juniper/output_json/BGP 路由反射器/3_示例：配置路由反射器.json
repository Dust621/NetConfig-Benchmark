{
  "title": "示例：配置路由反射器",
  "sections": [
    {
      "title": "要求",
      "level": 3,
      "content": "在配置此示例之前，不需要除设备初始化之外的特殊配置。"
    },
    {
      "title": "概述",
      "level": 3,
      "content": "通常，支持 BGP （IBGP） 的内部设备需要完全网状化，因为 IBGP 不会将更新重新播发到其他支持 IBGP 的设备。全网格是通过在每个启用 IBGP 的设备上配置多个 neighbor 语句来实现的逻辑网格。全网格不一定是物理全网格。在大型部署中，维护完整网格（逻辑或物理）不能很好地扩展。 图 4 显示了以设备 A 充当路由反射器的 IBGP 网络。设备 B 和设备 C 是路由反射器的客户端。设备 D 和设备 E 位于群集外部，因此它们不是路由反射器的客户端。 在设备 A（路由反射器）上，必须通过包含 neighbor 客户端（设备 B 和设备 C）和非客户端（设备 D 和设备 E）的语句，与所有启用 IBGP 的设备形成对等关系。您还必须包含 cluster 语句和集群标识符。群集标识符可以是任何 32 位值。此示例使用路由反射器的环路接口 IP 地址。 在设备 B 和设备 C（路由反射器客户端）上，您只需要一个 neighbor 与路由反射器（设备 A）形成对等关系的语句。 在设备 D 和设备 E（非客户端）上，您需要为每个非客户端设备（D 到 E 和 E-to-D）提供语句 neighbor 。您还需要路由 neighbor 反射器（D 到 A 和 E 到 A）的语句。设备 D 和设备 E 不需要 neighbor 客户端设备（设备 B 和设备 C）的语句。 提示： 设备 D 和设备 E 被视为非客户端，因为它们彼此之间显式配置了对等关系。要使其成为 RRroute 反射器客户端，请从设备 D 上的配置中删除该 neighbor 192.168.5.5 语句，然后从设备 E 上的配置中删除该 neighbor 192.168.0.1 语句。 图 4： 使用路由反射器的 IBGP 网络 通常，支持 BGP （IBGP） 的内部设备需要完全网状化，因为 IBGP 不会将更新重新播发到其他支持 IBGP 的设备。全网格是通过在每个启用 IBGP 的设备上配置多个 neighbor 语句来实现的逻辑网格。全网格不一定是物理全网格。在大型部署中，维护完整网格（逻辑或物理）不能很好地扩展。 图 4 显示了以设备 A 充当路由反射器的 IBGP 网络。设备 B 和设备 C 是路由反射器的客户端。设备 D 和设备 E 位于群集外部，因此它们不是路由反射器的客户端。 在设备 A（路由反射器）上，必须通过包含 neighbor 客户端（设备 B 和设备 C）和非客户端（设备 D 和设备 E）的语句，与所有启用 IBGP 的设备形成对等关系。您还必须包含 cluster 语句和集群标识符。群集标识符可以是任何 32 位值。此示例使用路由反射器的环路接口 IP 地址。 在设备 B 和设备 C（路由反射器客户端）上，您只需要一个 neighbor 与路由反射器（设备 A）形成对等关系的语句。 在设备 D 和设备 E（非客户端）上，您需要为每个非客户端设备（D 到 E 和 E-to-D）提供语句 neighbor 。您还需要路由 neighbor 反射器（D 到 A 和 E 到 A）的语句。设备 D 和设备 E 不需要 neighbor 客户端设备（设备 B 和设备 C）的语句。 提示： 设备 D 和设备 E 被视为非客户端，因为它们彼此之间显式配置了对等关系。要使其成为 RRroute 反射器客户端，请从设备 D 上的配置中删除该 neighbor 192.168.5.5 语句，然后从设备 E 上的配置中删除该 neighbor 192.168.0.1 语句。 设备 D 和设备 E 被视为非客户端，因为它们彼此之间显式配置了对等关系。要使其成为 RRroute 反射器客户端，请从设备 D 上的配置中删除该 neighbor 192.168.5.5 语句，然后从设备 E 上的配置中删除该 neighbor 192.168.0.1 语句。 图 4： 使用路由反射器的 IBGP 网络"
    },
    {
      "title": "配置",
      "level": 3,
      "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改与您的网络配置匹配所需的任何详细信息，然后将命令复制并粘贴到层次结构级别的 CLI [edit] 中。 设备 A set interfaces fe-0/0/0 unit 1 description to-B set interfaces fe-0/0/0 unit 1 family inet address 10.10.10.1/30 set interfaces fe-0/0/1 unit 3 description to-D set interfaces fe-0/0/1 unit 3 family inet address 10.10.10.9/30 set interfaces lo0 unit 1 family inet address 192.168.6.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.6.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers cluster 192.168.6.5 set protocols bgp group internal-peers neighbor 192.163.6.4 set protocols bgp group internal-peers neighbor 192.168.40.4 set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.1 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.1 set protocols ospf area 0.0.0.0 interface fe-0/0/1.3 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.6.5 set routing-options autonomous-system 17 设备 B set interfaces fe-0/0/0 unit 2 description to-A set interfaces fe-0/0/0 unit 2 family inet address 10.10.10.2/30 set interfaces fe-0/0/1 unit 5 description to-C set interfaces fe-0/0/1 unit 5 family inet address 10.10.10.5/30 set interfaces lo0 unit 2 family inet address 192.163.6.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.163.6.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.2 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.2 set protocols ospf area 0.0.0.0 interface fe-0/0/1.5 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.163.6.4 set routing-options autonomous-system 17 设备 C set interfaces fe-0/0/0 unit 6 description to-B set interfaces fe-0/0/0 unit 6 family inet address 10.10.10.6/30 set interfaces lo0 unit 3 family inet address 192.168.40.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.40.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.3 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.6 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.40.4 set routing-options autonomous-system 17 设备 D set interfaces fe-0/0/0 unit 4 description to-A set interfaces fe-0/0/0 unit 4 family inet address 10.10.10.10/30 set interfaces fe-0/0/1 unit 7 description to-E set interfaces fe-0/0/1 unit 7 family inet address 10.10.10.13/30 set interfaces lo0 unit 4 family inet address 192.168.0.1/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.0.1 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.4 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.4 set protocols ospf area 0.0.0.0 interface fe-0/0/1.7 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.0.1 set routing-options autonomous-system 17 设备 E set interfaces fe-0/0/0 unit 8 description to-D set interfaces fe-0/0/0 unit 8 family inet address 10.10.10.14/30 set interfaces lo0 unit 5 family inet address 192.168.5.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.5.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.5 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.8 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.5.5 set routing-options autonomous-system 17 分步过程 下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅《Junos OS CLI 用户指南》中的在配置模式下使用 CLI 编辑器。 要使用瞻博网络设备 A 作为路由反射器在网络中配置 IBGP，请执行以下操作： 配置接口。 [edit interfaces] user@A# set fe-0/0/0 unit 1 description to-B user@A# set fe-0/0/0 unit 1 family inet address 10.10.10.1/30 user@A# set fe-0/0/1 unit 3 description to-D user@A# set fe-0/0/1 unit 3 family inet address 10.10.10.9/30 user@A# set lo0 unit 1 family inet address 192.168.6.5/32 配置 BGP，包括集群标识符以及与自治系统 （AS） 中所有启用 IBGP 的设备的邻居关系。 同时应用将 OSPF 路由重新分发到 BGP 的策略。 [edit protocols bgp group internal-peers] user@A# set type internal user@A# set local-address 192.168.6.5 user@A# set export send-ospf user@A# set cluster 192.168.6.5 user@A# set neighbor192.163.6.4 user@A# set neighbor 192.168.40.4 user@A# set neighbor 192.168.0.1 user@A# set neighbor 192.168.5.5 配置静态路由或内部网关协议 （IGP）。 此示例使用 OSPF。 [edit protocols ospf area 0.0.0.0] user@A# set interface lo0.1 passive user@A# set interface fe-0/0/0.1 user@A# set interface fe-0/0/1.3 配置将 OSPF 路由重新分发到 BGP 的策略。 [edit policy-options policy-statement send-ospf term 2] user@A# set from protocol ospf user@A# set then accept 配置路由器 ID 和自治系统 （AS） 编号。 [edit routing-options] user@A# set router-id 192.168.6.5 user@A# set autonomous-system 17 在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 user@A# show interfaces fe-0/0/0 { unit 1 { description to-B; family inet { address 10.10.10.1/30; } } } fe-0/0/1 { unit 3 { description to-D; family inet { address 10.10.10.9/30; } } } lo0 { unit 1 { family inet { address 192.168.6.5/32; } } } user@A# show protocols bgp { group internal-peers { type internal; local-address 192.168.6.5; export send-ospf; cluster 192.168.6.5; neighbor 192.163.6.4; neighbor 192.168.40.4; neighbor 192.168.0.1; neighbor 192.168.5.5; } } ospf { area 0.0.0.0 { interface lo0.1 { passive; } interface fe-0/0/0.1; interface fe-0/0/1.3; } } user@A# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@A# show routing-options router-id 192.168.6.5; autonomous-system 17; 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 要配置客户端对等方： [edit interfaces] user@B# set fe-0/0/0 unit 2 description to-A user@B# set fe-0/0/0 unit 2 family inet address 10.10.10.2/30 user@B# set fe-0/0/1 unit 5 description to-C user@B# set fe-0/0/1 unit 5 family inet address 10.10.10.5/30 user@B# set lo0 unit 2 family inet address 192.163.6.4/32 配置与路由反射器的 BGP 邻居关系。 [edit protocols bgp group internal-peers] user@B# set type internal user@B# set local-address 192.163.6.4 user@B# set export send-ospf user@B# set neighbor 192.168.6.5 配置 OSPF。 [edit protocols ospf area 0.0.0.0] user@B# set interface lo0.2 passive user@B# set interface fe-0/0/0.2 user@B# set interface fe-0/0/1.5 [edit policy-options policy-statement send-ospf term 2] user@B# set from protocol ospf user@B# set then accept 配置路由器 ID 和 AS 编号。 [edit routing-options] user@B# set router-id 192.163.6.4 user@B# set autonomous-system 17 user@B# show interfaces fe-0/0/0 { unit 2 { description to-A; family inet { address 10.10.10.2/30; } } } fe-0/0/1 { unit 5 { description to-C; family inet { address 10.10.10.5/30; } } } lo0 { unit 2 { family inet { address 192.163.6.4/32; } } } user@B# show protocols bgp { group internal-peers { type internal; local-address 192.163.6.4; export send-ospf; neighbor 192.168.6.5; } } ospf { area 0.0.0.0 { interface lo0.2 { passive; } interface fe-0/0/0.2; interface fe-0/0/1.5; } } user@B# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@B# show routing-options router-id 192.163.6.4; autonomous-system 17; 注： 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 要配置非客户端对等方： [edit interfaces] user@D# set fe-0/0/0 unit 4 description to-A user@D# set fe-0/0/0 unit 4 family inet address 10.10.10.10/30 user@D# set fe-0/0/1 unit 7 description to-E user@D# set fe-0/0/1 unit 7 family inet address 10.10.10.13/30 user@D# set lo0 unit 4 family inet address 192.168.0.1/32 配置 BGP 邻居与 RRroute 反射器和其他非客户端对等方的关系。 [edit protocols bgp group internal-peers] user@D# set type internal user@D# set local-address 192.168.0.1 user@D# set export send-ospf user@D# set neighbor 192.168.6.5 user@D# set neighbor 192.168.5.5 [edit protocols ospf area 0.0.0.0] user@D# set interface lo0.4 passive user@D# set interface fe-0/0/0.4 user@D# set interface fe-0/0/1.7 [edit policy-options policy-statement send-ospf term 2] user@D# set from protocol ospf user@D# set then accept [edit routing-options] user@D# set router-id 192.168.0.1 user@D# set autonomous-system 17 user@D# show interfaces fe-0/0/0 { unit 4 { description to-A; family inet { address 10.10.10.10/30; } } } fe-0/0/1 { unit 7 { description to-E; family inet { address 10.10.10.13/30; } } } lo0 { unit 4 { family inet { address 192.168.0.1/32; } } } user@D# show protocols bgp { group internal-peers { type internal; local-address 192.168.0.1; export send-ospf; neighbor 192.168.6.5; neighbor 192.168.5.5; } } ospf { area 0.0.0.0 { interface lo0.4 { passive; } interface fe-0/0/0.4; interface fe-0/0/1.7; } } user@D# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@D# show routing-options router-id 192.168.0.1; autonomous-system 17; 注： 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
      "sections": [
        {
          "title": "程序",
          "level": 4,
          "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改与您的网络配置匹配所需的任何详细信息，然后将命令复制并粘贴到层次结构级别的 CLI [edit] 中。 设备 A set interfaces fe-0/0/0 unit 1 description to-B set interfaces fe-0/0/0 unit 1 family inet address 10.10.10.1/30 set interfaces fe-0/0/1 unit 3 description to-D set interfaces fe-0/0/1 unit 3 family inet address 10.10.10.9/30 set interfaces lo0 unit 1 family inet address 192.168.6.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.6.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers cluster 192.168.6.5 set protocols bgp group internal-peers neighbor 192.163.6.4 set protocols bgp group internal-peers neighbor 192.168.40.4 set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.1 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.1 set protocols ospf area 0.0.0.0 interface fe-0/0/1.3 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.6.5 set routing-options autonomous-system 17 设备 B set interfaces fe-0/0/0 unit 2 description to-A set interfaces fe-0/0/0 unit 2 family inet address 10.10.10.2/30 set interfaces fe-0/0/1 unit 5 description to-C set interfaces fe-0/0/1 unit 5 family inet address 10.10.10.5/30 set interfaces lo0 unit 2 family inet address 192.163.6.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.163.6.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.2 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.2 set protocols ospf area 0.0.0.0 interface fe-0/0/1.5 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.163.6.4 set routing-options autonomous-system 17 设备 C set interfaces fe-0/0/0 unit 6 description to-B set interfaces fe-0/0/0 unit 6 family inet address 10.10.10.6/30 set interfaces lo0 unit 3 family inet address 192.168.40.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.40.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.3 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.6 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.40.4 set routing-options autonomous-system 17 设备 D set interfaces fe-0/0/0 unit 4 description to-A set interfaces fe-0/0/0 unit 4 family inet address 10.10.10.10/30 set interfaces fe-0/0/1 unit 7 description to-E set interfaces fe-0/0/1 unit 7 family inet address 10.10.10.13/30 set interfaces lo0 unit 4 family inet address 192.168.0.1/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.0.1 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.4 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.4 set protocols ospf area 0.0.0.0 interface fe-0/0/1.7 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.0.1 set routing-options autonomous-system 17 设备 E set interfaces fe-0/0/0 unit 8 description to-D set interfaces fe-0/0/0 unit 8 family inet address 10.10.10.14/30 set interfaces lo0 unit 5 family inet address 192.168.5.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.5.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.5 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.8 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.5.5 set routing-options autonomous-system 17 分步过程",
          "sections": [
            {
              "title": "CLI 快速配置",
              "level": 5,
              "content": "要快速配置此示例，请复制以下命令，将其粘贴到文本文件中，删除所有换行符，更改与您的网络配置匹配所需的任何详细信息，然后将命令复制并粘贴到层次结构级别的 CLI [edit] 中。 设备 A set interfaces fe-0/0/0 unit 1 description to-B set interfaces fe-0/0/0 unit 1 family inet address 10.10.10.1/30 set interfaces fe-0/0/1 unit 3 description to-D set interfaces fe-0/0/1 unit 3 family inet address 10.10.10.9/30 set interfaces lo0 unit 1 family inet address 192.168.6.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.6.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers cluster 192.168.6.5 set protocols bgp group internal-peers neighbor 192.163.6.4 set protocols bgp group internal-peers neighbor 192.168.40.4 set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.1 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.1 set protocols ospf area 0.0.0.0 interface fe-0/0/1.3 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.6.5 set routing-options autonomous-system 17 设备 B set interfaces fe-0/0/0 unit 2 description to-A set interfaces fe-0/0/0 unit 2 family inet address 10.10.10.2/30 set interfaces fe-0/0/1 unit 5 description to-C set interfaces fe-0/0/1 unit 5 family inet address 10.10.10.5/30 set interfaces lo0 unit 2 family inet address 192.163.6.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.163.6.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.2 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.2 set protocols ospf area 0.0.0.0 interface fe-0/0/1.5 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.163.6.4 set routing-options autonomous-system 17 设备 C set interfaces fe-0/0/0 unit 6 description to-B set interfaces fe-0/0/0 unit 6 family inet address 10.10.10.6/30 set interfaces lo0 unit 3 family inet address 192.168.40.4/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.40.4 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.3 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.6 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.40.4 set routing-options autonomous-system 17 设备 D set interfaces fe-0/0/0 unit 4 description to-A set interfaces fe-0/0/0 unit 4 family inet address 10.10.10.10/30 set interfaces fe-0/0/1 unit 7 description to-E set interfaces fe-0/0/1 unit 7 family inet address 10.10.10.13/30 set interfaces lo0 unit 4 family inet address 192.168.0.1/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.0.1 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols bgp group internal-peers neighbor 192.168.5.5 set protocols ospf area 0.0.0.0 interface lo0.4 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.4 set protocols ospf area 0.0.0.0 interface fe-0/0/1.7 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.0.1 set routing-options autonomous-system 17 设备 E set interfaces fe-0/0/0 unit 8 description to-D set interfaces fe-0/0/0 unit 8 family inet address 10.10.10.14/30 set interfaces lo0 unit 5 family inet address 192.168.5.5/32 set protocols bgp group internal-peers type internal set protocols bgp group internal-peers local-address 192.168.5.5 set protocols bgp group internal-peers export send-ospf set protocols bgp group internal-peers neighbor 192.168.0.1 set protocols bgp group internal-peers neighbor 192.168.6.5 set protocols ospf area 0.0.0.0 interface lo0.5 passive set protocols ospf area 0.0.0.0 interface fe-0/0/0.8 set policy-options policy-statement send-ospf term 2 from protocol ospf set policy-options policy-statement send-ospf term 2 then accept set routing-options router-id 192.168.5.5 set routing-options autonomous-system 17",
              "commands_by_device": {
                "设备 A": "set interfaces fe-0/0/0 unit 1 description to-B\nset interfaces fe-0/0/0 unit 1 family inet address 10.10.10.1/30\nset interfaces fe-0/0/1 unit 3 description to-D\nset interfaces fe-0/0/1 unit 3 family inet address 10.10.10.9/30\nset interfaces lo0 unit 1 family inet address 192.168.6.5/32\nset protocols bgp group internal-peers type internal\nset protocols bgp group internal-peers local-address 192.168.6.5\nset protocols bgp group internal-peers export send-ospf\nset protocols bgp group internal-peers cluster 192.168.6.5\nset protocols bgp group internal-peers neighbor 192.163.6.4\nset protocols bgp group internal-peers neighbor 192.168.40.4\nset protocols bgp group internal-peers neighbor 192.168.0.1\nset protocols bgp group internal-peers neighbor 192.168.5.5\nset protocols ospf area 0.0.0.0 interface lo0.1 passive\nset protocols ospf area 0.0.0.0 interface fe-0/0/0.1\nset protocols ospf area 0.0.0.0 interface fe-0/0/1.3\nset policy-options policy-statement send-ospf term 2 from protocol ospf\nset policy-options policy-statement send-ospf term 2 then accept\nset routing-options router-id 192.168.6.5\nset routing-options autonomous-system 17",
                "设备 B": "set interfaces fe-0/0/0 unit 2 description to-A\nset interfaces fe-0/0/0 unit 2 family inet address 10.10.10.2/30\nset interfaces fe-0/0/1 unit 5 description to-C\nset interfaces fe-0/0/1 unit 5 family inet address 10.10.10.5/30\nset interfaces lo0 unit 2 family inet address 192.163.6.4/32\nset protocols bgp group internal-peers type internal\nset protocols bgp group internal-peers local-address 192.163.6.4\nset protocols bgp group internal-peers export send-ospf\nset protocols bgp group internal-peers neighbor 192.168.6.5\nset protocols ospf area 0.0.0.0 interface lo0.2 passive\nset protocols ospf area 0.0.0.0 interface fe-0/0/0.2\nset protocols ospf area 0.0.0.0 interface fe-0/0/1.5\nset policy-options policy-statement send-ospf term 2 from protocol ospf\nset policy-options policy-statement send-ospf term 2 then accept\nset routing-options router-id 192.163.6.4\nset routing-options autonomous-system 17",
                "设备 C": "set interfaces fe-0/0/0 unit 6 description to-B\nset interfaces fe-0/0/0 unit 6 family inet address 10.10.10.6/30\nset interfaces lo0 unit 3 family inet address 192.168.40.4/32\nset protocols bgp group internal-peers type internal\nset protocols bgp group internal-peers local-address 192.168.40.4\nset protocols bgp group internal-peers export send-ospf\nset protocols bgp group internal-peers neighbor 192.168.6.5\nset protocols ospf area 0.0.0.0 interface lo0.3 passive\nset protocols ospf area 0.0.0.0 interface fe-0/0/0.6\nset policy-options policy-statement send-ospf term 2 from protocol ospf\nset policy-options policy-statement send-ospf term 2 then accept\nset routing-options router-id 192.168.40.4\nset routing-options autonomous-system 17",
                "设备 D": "set interfaces fe-0/0/0 unit 4 description to-A\nset interfaces fe-0/0/0 unit 4 family inet address 10.10.10.10/30\nset interfaces fe-0/0/1 unit 7 description to-E\nset interfaces fe-0/0/1 unit 7 family inet address 10.10.10.13/30\nset interfaces lo0 unit 4 family inet address 192.168.0.1/32\nset protocols bgp group internal-peers type internal\nset protocols bgp group internal-peers local-address 192.168.0.1\nset protocols bgp group internal-peers export send-ospf\nset protocols bgp group internal-peers neighbor 192.168.6.5\nset protocols bgp group internal-peers neighbor 192.168.5.5\nset protocols ospf area 0.0.0.0 interface lo0.4 passive\nset protocols ospf area 0.0.0.0 interface fe-0/0/0.4\nset protocols ospf area 0.0.0.0 interface fe-0/0/1.7\nset policy-options policy-statement send-ospf term 2 from protocol ospf\nset policy-options policy-statement send-ospf term 2 then accept\nset routing-options router-id 192.168.0.1\nset routing-options autonomous-system 17",
                "设备 E": "set interfaces fe-0/0/0 unit 8 description to-D\nset interfaces fe-0/0/0 unit 8 family inet address 10.10.10.14/30\nset interfaces lo0 unit 5 family inet address 192.168.5.5/32\nset protocols bgp group internal-peers type internal\nset protocols bgp group internal-peers local-address 192.168.5.5\nset protocols bgp group internal-peers export send-ospf\nset protocols bgp group internal-peers neighbor 192.168.0.1\nset protocols bgp group internal-peers neighbor 192.168.6.5\nset protocols ospf area 0.0.0.0 interface lo0.5 passive\nset protocols ospf area 0.0.0.0 interface fe-0/0/0.8\nset policy-options policy-statement send-ospf term 2 from protocol ospf\nset policy-options policy-statement send-ospf term 2 then accept\nset routing-options router-id 192.168.5.5\nset routing-options autonomous-system 17"
              }
            },
            {
              "title": "分步过程",
              "level": 5
            }
          ]
        },
        {
          "title": "配置路由反射器",
          "level": 4,
          "content": "下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅《Junos OS CLI 用户指南》中的在配置模式下使用 CLI 编辑器。 要使用瞻博网络设备 A 作为路由反射器在网络中配置 IBGP，请执行以下操作： 配置接口。 [edit interfaces] user@A# set fe-0/0/0 unit 1 description to-B user@A# set fe-0/0/0 unit 1 family inet address 10.10.10.1/30 user@A# set fe-0/0/1 unit 3 description to-D user@A# set fe-0/0/1 unit 3 family inet address 10.10.10.9/30 user@A# set lo0 unit 1 family inet address 192.168.6.5/32 配置 BGP，包括集群标识符以及与自治系统 （AS） 中所有启用 IBGP 的设备的邻居关系。 同时应用将 OSPF 路由重新分发到 BGP 的策略。 [edit protocols bgp group internal-peers] user@A# set type internal user@A# set local-address 192.168.6.5 user@A# set export send-ospf user@A# set cluster 192.168.6.5 user@A# set neighbor192.163.6.4 user@A# set neighbor 192.168.40.4 user@A# set neighbor 192.168.0.1 user@A# set neighbor 192.168.5.5 配置静态路由或内部网关协议 （IGP）。 此示例使用 OSPF。 [edit protocols ospf area 0.0.0.0] user@A# set interface lo0.1 passive user@A# set interface fe-0/0/0.1 user@A# set interface fe-0/0/1.3 配置将 OSPF 路由重新分发到 BGP 的策略。 [edit policy-options policy-statement send-ospf term 2] user@A# set from protocol ospf user@A# set then accept 配置路由器 ID 和自治系统 （AS） 编号。 [edit routing-options] user@A# set router-id 192.168.6.5 user@A# set autonomous-system 17 在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 user@A# show interfaces fe-0/0/0 { unit 1 { description to-B; family inet { address 10.10.10.1/30; } } } fe-0/0/1 { unit 3 { description to-D; family inet { address 10.10.10.9/30; } } } lo0 { unit 1 { family inet { address 192.168.6.5/32; } } } user@A# show protocols bgp { group internal-peers { type internal; local-address 192.168.6.5; export send-ospf; cluster 192.168.6.5; neighbor 192.163.6.4; neighbor 192.168.40.4; neighbor 192.168.0.1; neighbor 192.168.5.5; } } ospf { area 0.0.0.0 { interface lo0.1 { passive; } interface fe-0/0/0.1; interface fe-0/0/1.3; } } user@A# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@A# show routing-options router-id 192.168.6.5; autonomous-system 17; 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "配置接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@A# set fe-0/0/0 unit 1 description to-B",
                    "user@A# set fe-0/0/0 unit 1 family inet address 10.10.10.1/30",
                    "user@A# set fe-0/0/1 unit 3 description to-D",
                    "user@A# set fe-0/0/1 unit 3 family inet address 10.10.10.9/30",
                    "user@A# set lo0 unit 1 family inet address 192.168.6.5/32"
                  ]
                },
                {
                  "step": 2,
                  "description": "配置 BGP，包括集群标识符以及与自治系统 （AS） 中所有启用 IBGP 的设备的邻居关系。",
                  "code": [
                    "[edit protocols bgp group internal-peers]",
                    "user@A# set type internal",
                    "user@A# set local-address 192.168.6.5",
                    "user@A# set export send-ospf",
                    "user@A# set cluster 192.168.6.5",
                    "user@A# set neighbor192.163.6.4",
                    "user@A# set neighbor 192.168.40.4",
                    "user@A# set neighbor 192.168.0.1",
                    "user@A# set neighbor 192.168.5.5"
                  ]
                },
                {
                  "step": 3,
                  "description": "配置静态路由或内部网关协议 （IGP）。",
                  "code": [
                    "[edit protocols ospf area 0.0.0.0]",
                    "user@A# set interface lo0.1 passive",
                    "user@A# set interface fe-0/0/0.1",
                    "user@A# set interface fe-0/0/1.3"
                  ]
                },
                {
                  "step": 4,
                  "description": "配置将 OSPF 路由重新分发到 BGP 的策略。",
                  "code": [
                    "[edit  policy-options policy-statement send-ospf term 2]",
                    "user@A# set from protocol ospf",
                    "user@A# set then accept"
                  ]
                },
                {
                  "step": 5,
                  "description": "配置路由器 ID 和自治系统 （AS） 编号。",
                  "code": [
                    "[edit routing-options]",
                    "user@A# set router-id 192.168.6.5",
                    "user@A# set autonomous-system 17"
                  ]
                }
              ]
            },
            {
              "title": "结果",
              "level": 5,
              "content": "在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，请对您正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
              "code": [
                "user@A#show interfacesfe-0/0/0 {\n    unit 1 {\n        description to-B;\n        family inet {\n            address 10.10.10.1/30;\n        }\n    }\n}\nfe-0/0/1 {\n    unit 3 {\n        description to-D;\n        family inet {\n            address 10.10.10.9/30;\n        }\n    }\n}\nlo0 {\n    unit 1 {\n        family inet {\n            address 192.168.6.5/32;\n        }\n    }\n}",
                "user@A#show protocolsbgp {\n    group internal-peers {\n        type internal;\n        local-address 192.168.6.5;\n        export send-ospf;\n        cluster 192.168.6.5;\n        neighbor 192.163.6.4;\n        neighbor 192.168.40.4;\n        neighbor 192.168.0.1;\n        neighbor 192.168.5.5;\n    }\n}\nospf {\n    area 0.0.0.0 {\n        interface lo0.1 {\n            passive;\n        }\n        interface fe-0/0/0.1;\n        interface fe-0/0/1.3;\n    }\n}",
                "user@A#show policy-optionspolicy-statement send-ospf {\n    term 2 {\n        from protocol ospf;\n        then accept;\n    }\n}",
                "user@A#show routing-optionsrouter-id 192.168.6.5;\nautonomous-system 17;"
              ]
            }
          ]
        },
        {
          "title": "配置客户端对等方",
          "level": 4,
          "content": "下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅《Junos OS CLI 用户指南》中的在配置模式下使用 CLI 编辑器。 要配置客户端对等方： 配置接口。 [edit interfaces] user@B# set fe-0/0/0 unit 2 description to-A user@B# set fe-0/0/0 unit 2 family inet address 10.10.10.2/30 user@B# set fe-0/0/1 unit 5 description to-C user@B# set fe-0/0/1 unit 5 family inet address 10.10.10.5/30 user@B# set lo0 unit 2 family inet address 192.163.6.4/32 配置与路由反射器的 BGP 邻居关系。 同时应用将 OSPF 路由重新分发到 BGP 的策略。 [edit protocols bgp group internal-peers] user@B# set type internal user@B# set local-address 192.163.6.4 user@B# set export send-ospf user@B# set neighbor 192.168.6.5 配置 OSPF。 [edit protocols ospf area 0.0.0.0] user@B# set interface lo0.2 passive user@B# set interface fe-0/0/0.2 user@B# set interface fe-0/0/1.5 配置将 OSPF 路由重新分发到 BGP 的策略。 [edit policy-options policy-statement send-ospf term 2] user@B# set from protocol ospf user@B# set then accept 配置路由器 ID 和 AS 编号。 [edit routing-options] user@B# set router-id 192.163.6.4 user@B# set autonomous-system 17 在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 user@B# show interfaces fe-0/0/0 { unit 2 { description to-A; family inet { address 10.10.10.2/30; } } } fe-0/0/1 { unit 5 { description to-C; family inet { address 10.10.10.5/30; } } } lo0 { unit 2 { family inet { address 192.163.6.4/32; } } } user@B# show protocols bgp { group internal-peers { type internal; local-address 192.163.6.4; export send-ospf; neighbor 192.168.6.5; } } ospf { area 0.0.0.0 { interface lo0.2 { passive; } interface fe-0/0/0.2; interface fe-0/0/1.5; } } user@B# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@B# show routing-options router-id 192.163.6.4; autonomous-system 17; 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "配置接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@B# set fe-0/0/0 unit 2 description to-A",
                    "user@B# set fe-0/0/0 unit 2 family inet address 10.10.10.2/30",
                    "user@B# set fe-0/0/1 unit 5 description to-C",
                    "user@B# set fe-0/0/1 unit 5 family inet address 10.10.10.5/30",
                    "user@B# set lo0 unit 2 family inet address 192.163.6.4/32"
                  ]
                },
                {
                  "step": 2,
                  "description": "配置与路由反射器的 BGP 邻居关系。",
                  "code": [
                    "[edit protocols bgp group internal-peers]",
                    "user@B# set type internal",
                    "user@B# set local-address 192.163.6.4",
                    "user@B# set export send-ospf",
                    "user@B# set neighbor 192.168.6.5"
                  ]
                },
                {
                  "step": 3,
                  "description": "配置 OSPF。",
                  "code": [
                    "[edit protocols ospf area 0.0.0.0]",
                    "user@B# set interface lo0.2 passive",
                    "user@B# set interface fe-0/0/0.2",
                    "user@B# set interface fe-0/0/1.5"
                  ]
                },
                {
                  "step": 4,
                  "description": "配置将 OSPF 路由重新分发到 BGP 的策略。",
                  "code": [
                    "[edit  policy-options policy-statement send-ospf term 2]",
                    "user@B# set from protocol ospf",
                    "user@B# set then accept"
                  ]
                },
                {
                  "step": 5,
                  "description": "配置路由器 ID 和 AS 编号。",
                  "code": [
                    "[edit routing-options]",
                    "user@B# set router-id 192.163.6.4",
                    "user@B# set autonomous-system 17"
                  ]
                }
              ]
            },
            {
              "title": "结果",
              "level": 5,
              "content": "在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他客户端设备来自瞻博网络，则对正在配置的群集中的每个客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
              "code": [
                "user@B#show interfacesfe-0/0/0 {\n    unit 2 {\n        description to-A;\n        family inet {\n            address 10.10.10.2/30;\n        }\n    }\n}\nfe-0/0/1 {\n    unit 5 {\n        description to-C;\n        family inet {\n            address 10.10.10.5/30;\n        }\n    }\n}\nlo0 {\n    unit 2 {\n        family inet {\n            address 192.163.6.4/32;\n        }\n    }\n}",
                "user@B#show protocolsbgp {\n    group internal-peers {\n        type internal;\n        local-address 192.163.6.4;\n        export send-ospf;\n        neighbor 192.168.6.5;\n    }\n}\nospf {\n    area 0.0.0.0 {\n        interface lo0.2 {\n            passive;\n        }\n        interface fe-0/0/0.2;\n        interface fe-0/0/1.5;\n    }\n}",
                "user@B#show policy-optionspolicy-statement send-ospf {\n    term 2 {\n        from protocol ospf;\n        then accept;\n    }\n}",
                "user@B#show routing-optionsrouter-id 192.163.6.4;\nautonomous-system 17;"
              ]
            }
          ]
        },
        {
          "title": "配置非客户端对等方",
          "level": 4,
          "content": "下面的示例要求您在各个配置层级中进行导航。有关导航 CLI 的信息，请参阅《Junos OS CLI 用户指南》中的在配置模式下使用 CLI 编辑器。 要配置非客户端对等方： 配置接口。 [edit interfaces] user@D# set fe-0/0/0 unit 4 description to-A user@D# set fe-0/0/0 unit 4 family inet address 10.10.10.10/30 user@D# set fe-0/0/1 unit 7 description to-E user@D# set fe-0/0/1 unit 7 family inet address 10.10.10.13/30 user@D# set lo0 unit 4 family inet address 192.168.0.1/32 配置 BGP 邻居与 RRroute 反射器和其他非客户端对等方的关系。 同时应用将 OSPF 路由重新分发到 BGP 的策略。 [edit protocols bgp group internal-peers] user@D# set type internal user@D# set local-address 192.168.0.1 user@D# set export send-ospf user@D# set neighbor 192.168.6.5 user@D# set neighbor 192.168.5.5 配置 OSPF。 [edit protocols ospf area 0.0.0.0] user@D# set interface lo0.4 passive user@D# set interface fe-0/0/0.4 user@D# set interface fe-0/0/1.7 配置将 OSPF 路由重新分发到 BGP 的策略。 [edit policy-options policy-statement send-ospf term 2] user@D# set from protocol ospf user@D# set then accept 配置路由器 ID 和 AS 编号。 [edit routing-options] user@D# set router-id 192.168.0.1 user@D# set autonomous-system 17 在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 user@D# show interfaces fe-0/0/0 { unit 4 { description to-A; family inet { address 10.10.10.10/30; } } } fe-0/0/1 { unit 7 { description to-E; family inet { address 10.10.10.13/30; } } } lo0 { unit 4 { family inet { address 192.168.0.1/32; } } } user@D# show protocols bgp { group internal-peers { type internal; local-address 192.168.0.1; export send-ospf; neighbor 192.168.6.5; neighbor 192.168.5.5; } } ospf { area 0.0.0.0 { interface lo0.4 { passive; } interface fe-0/0/0.4; interface fe-0/0/1.7; } } user@D# show policy-options policy-statement send-ospf { term 2 { from protocol ospf; then accept; } } user@D# show routing-options router-id 192.168.0.1; autonomous-system 17; 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
          "sections": [
            {
              "title": "分步过程",
              "level": 5,
              "step_by_step": [
                {
                  "step": 1,
                  "description": "配置接口。",
                  "code": [
                    "[edit interfaces]",
                    "user@D# set fe-0/0/0 unit 4 description to-A",
                    "user@D# set fe-0/0/0 unit 4 family inet address 10.10.10.10/30",
                    "user@D# set fe-0/0/1 unit 7 description to-E",
                    "user@D# set fe-0/0/1 unit 7 family inet address 10.10.10.13/30",
                    "user@D# set lo0 unit 4 family inet address 192.168.0.1/32"
                  ]
                },
                {
                  "step": 2,
                  "description": "配置 BGP 邻居与 RRroute 反射器和其他非客户端对等方的关系。",
                  "code": [
                    "[edit protocols bgp group internal-peers]",
                    "user@D# set type internal",
                    "user@D# set local-address 192.168.0.1",
                    "user@D# set export send-ospf",
                    "user@D# set neighbor 192.168.6.5",
                    "user@D# set neighbor 192.168.5.5"
                  ]
                },
                {
                  "step": 3,
                  "description": "配置 OSPF。",
                  "code": [
                    "[edit protocols ospf area 0.0.0.0]",
                    "user@D# set interface lo0.4 passive",
                    "user@D# set interface fe-0/0/0.4",
                    "user@D# set interface fe-0/0/1.7"
                  ]
                },
                {
                  "step": 4,
                  "description": "配置将 OSPF 路由重新分发到 BGP 的策略。",
                  "code": [
                    "[edit  policy-options policy-statement send-ospf term 2]",
                    "user@D# set from protocol ospf",
                    "user@D# set then accept"
                  ]
                },
                {
                  "step": 5,
                  "description": "配置路由器 ID 和 AS 编号。",
                  "code": [
                    "[edit routing-options]",
                    "user@D# set router-id 192.168.0.1",
                    "user@D# set autonomous-system 17"
                  ]
                }
              ]
            },
            {
              "title": "结果",
              "level": 5,
              "content": "在配置模式下，输入 show interfaces 、 show protocols 、 show policy-options 和 show routing-options 命令，以确认您的配置。如果输出未显示预期的配置，请重复此示例中的说明，以便进行更正。 如果完成设备配置，请从配置模式输入 commit 。 注： 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。 如果其他非客户端设备来自瞻博网络，则对正在配置的群集中的每个非客户端 BGP 对等方重复这些步骤。否则，请参阅设备的文档以获取说明。",
              "code": [
                "user@D#show interfacesfe-0/0/0 {\n    unit 4 {\n        description to-A;\n        family inet {\n            address 10.10.10.10/30;\n        }\n    }\n}\nfe-0/0/1 {\n    unit 7 {\n        description to-E;\n        family inet {\n            address 10.10.10.13/30;\n        }\n    }\n}\nlo0 {\n    unit 4 {\n        family inet {\n            address 192.168.0.1/32;\n        }\n    }\n}",
                "user@D#show protocolsbgp {\n    group internal-peers {\n        type internal;\n        local-address 192.168.0.1;\n        export send-ospf;\n        neighbor 192.168.6.5;\n        neighbor 192.168.5.5;\n    }\n}\nospf {\n    area 0.0.0.0 {\n        interface lo0.4 {\n            passive;\n        }\n        interface fe-0/0/0.4;\n        interface fe-0/0/1.7;\n    }\n}",
                "user@D#show policy-optionspolicy-statement send-ospf {\n    term 2 {\n        from protocol ospf;\n        then accept;\n    }\n}",
                "user@D#show routing-optionsrouter-id 192.168.0.1;\nautonomous-system 17;"
              ]
            }
          ]
        }
      ]
    }
  ],
  "content": "此示例说明如何配置路由反射器。 要求 在配置此示例之前，不需要除设备初始化之外的特殊配置。 概述 通常，支持 BGP （IBGP） 的内部设备需要完全网状化，因为 IBGP 不会将更新重新播发到其他支持 IBGP 的设备。全网格是通过在每个启用 IBGP 的设备上配置多个 neighbor 语句来实现的逻辑网格。全网格不一定是物理全网格。在大型部署中，维护完整网格（逻辑或物理）不能很好地扩展。 图 4 显示了以设备 A 充当路由反射器的 IBGP 网络。设备 B 和设备 C 是路由反射器的客户端。设备 D 和设备 E 位于群集外部，因此它们不是路由反射器的客户端。 在设备 A（路由反射器）上，必须通过包含 neighbor 客户端（设备 B 和设备 C）和非客户端（设备 D 和设备 E）的语句，与所有启用 IBGP 的设备形成对等关系。您还必须包含 cluster 语句和集群标识符。群集标识符可以是任何 32 位值。此示例使用路由反射器的环路接口 IP 地址。 在设备 B 和设备 C（路由反射器客户端）上，您只需要一个 neighbor 与路由反射器（设备 A）形成对等关系的语句。 在设备 D 和设备 E（非客户端）上，您需要为每个非客户端设备（D 到 E 和 E-to-D）提供语句 neighbor 。您还需要路由 neighbor 反射器（D 到 A 和 E 到 A）的语句。设备 D 和设备 E 不需要 neighbor 客户端设备（设备 B 和设备 C）的语句。 提示： 设备 D 和设备 E 被视为非客户端，因为它们彼此之间显式配置了对等关系。要使其成为 RRroute 反射器客户端，请从设备 D 上的配置中删除该 neighbor 192.168.5.5 语句，然后从设备 E 上的配置中删除该 neighbor 192.168.0.1 语句"
}
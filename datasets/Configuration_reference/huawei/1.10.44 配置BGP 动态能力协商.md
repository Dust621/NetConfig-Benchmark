```markdown
# 1.10.44 配置BGP 动态能力协商

通过配置BGP动态能力协商，可以解决演进过程中部署的原有业务受损的问题。当前仅支持地址族、扩展下一跳能力编码动态协商更新。

## 应用场景

BGP通常需要在已经部署的IPv4单播业务基础上，部署新的地址族或者去部署已有地址族用于业务变更或者演进。当部署的业务与原有业务共用BGP会话时，使能新的地址族能力会导致BGP邻居重建，使得演进过程中部署的原有业务受损。可以通过配置BGP动态能力协商解决该问题。

例如：在VPNv4地址族的基础上，先使能BGP动态能力协商，再重新部署EVPN地址族，即可保证已有对等体连接不中断。

## 操作步骤

### 步骤1
执行命令 `system-view`，进入系统视图。

### 步骤2
执行命令 `bgp as-number`，进入BGP视图。

### 步骤3
执行命令 `peer { ipv4-address | ipv6-address | group-name } dynamic-capability no-negotiated multi-protocol`，使能BGP对等体（组）动态协商地址族能力。

### 说明
- 动态能力协商功能不支持BGP多实例，不支持BGP分布式对等体，不支持BGP网段对等体。
- 对于IPv6类型的BGP对等体，在IPv4单播、VPNv4、MVPNv4、IPv4 Flow地址族使能 `peer enable` 命令，会同时协商扩展下一跳编码能力。
- BGP对等体两端需要先使能动态能力协商功能，然后在地址族下使能或者去使能 `peer enable` 命令，才能保证对等体连接不中断。
- 当设备内存处于危险态且使能动态能力协商功能时，在地址族下使能 `peer enable` 命令后，该地址族无法协商。设备内存退出危险态时，恢复该地址族的协商。

### 步骤4
执行命令 `commit`，提交配置。

## 检查配置结果

完成配置后，可以通过以下命令来检查配置结果：

- 使用 `display bgp peer verbose` 命令查看BGP对等体的详细信息。
```
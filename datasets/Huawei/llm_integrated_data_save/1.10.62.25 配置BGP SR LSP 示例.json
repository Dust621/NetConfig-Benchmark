{
  "topology": "基于网络拓扑图分析，增强后的网络拓扑描述如下：\n\n**设备配置：**\n- DeviceA: Loopback1 1.1.1.1/32，Interface1 10.1.1.1/24，Interface2 10.1.1.2/24\n- DeviceB: Loopback1 2.2.2.2/32，Interface1 10.1.2.2/24，Interface2 10.1.2.1/24\n- DeviceC: Loopback1 3.3.3.3/32，Interface1 10.1.3.1/24，Interface2 10.1.3.2/24\n- DeviceD: Loopback1 4.4.4.4/32，Interface1 10.1.4.1/24，Interface2 10.1.4.2/24\n- DeviceE: Loopback1 5.5.5.5/32\n\n**物理连接：**\n- DeviceA Interface1 ↔ DeviceB Interface1\n- DeviceA Interface2 ↔ DeviceB Interface2\n- DeviceB Interface1 ↔ DeviceC Interface1\n- DeviceB Interface2 ↔ DeviceC Interface2\n- DeviceC Interface1 ↔ DeviceD Interface1\n- DeviceC Interface2 ↔ DeviceD Interface2\n- DeviceD Interface1 ↔ DeviceE Interface1\n- DeviceD Interface2 ↔ DeviceE Interface2\n\n**IGP域划分：**\n- IGP域1：DeviceA-DeviceB-DeviceC，运行OSPF协议\n- IGP域2：DeviceC-DeviceD，运行IS-IS协议\n- IGP域3：DeviceD-DeviceE，运行OSPF协议\n\n**协议配置：**\n- 所有设备部署在同一BGP AS内\n- DeviceC作为OSPF与IS-IS的边界路由器\n- DeviceD作为IS-IS与OSPF的边界路由器\n- 通过LDP LSP建立MPLS标签分发协议\n- 配置BGP SR LSP实现1.1.1.1到5.5.5.5的端到端MPLS隧道\n- 设备间通过冗余链路连接，提供链路备份和负载均衡",
  "requirement": "通过在同一AS内的设备中部署一条完整的BGP SR LSP，实现端到端的业务互通。配置一条从1.1.1.1到5.5.5.5的内层MPLS隧道，即内层BGP SR LSP，使得从1.1.1.1到5.5.5.5的流量采用MPLS转发。",
  "steps": [
    "配置接口IP：为各设备的接口配置IP地址。",
    "配置IGP域：在DeviceA～DeviceC之间配置OSPF，DeviceC～DeviceD之间配置IS-IS，DeviceD～DeviceE之间配置OSPF。",
    "配置MPLS基本能力和MPLS LDP：在各设备上配置MPLS基本能力和MPLS LDP，建立LDP LSP。",
    "配置BGP SR LSP：配置BGP SR LSP，实现跨IGP域的MPLS转发。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nmpls lsr-id 1.1.1.1\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 1.1.1.1 255.255.255.255\n#\nbgp 100\n segment-routing global-block 16000\n peer 3.3.3.3 as-number 100\n peer 3.3.3.3 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n network 1.1.1.1 255.255.255.255 label-index 10\n peer 3.3.3.3 enable\n peer 3.3.3.3 route-policy policy1 export\n peer 3.3.3.3 label-route-capability\n peer 3.3.3.3 prefix-sid\n#\nospf 1\n router-id 1.1.1.1\n area 0.0.0.0\n network 1.1.1.1 0.0.0.0\n network 10.1.1.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n apply mpls-label\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nmpls lsr-id 2.2.2.2\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.2.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 2.2.2.2 255.255.255.255\n#\nospf 1\n router-id 2.2.2.2\n area 0.0.0.0\n network 2.2.2.2 0.0.0.0\n network 10.1.1.0 0.0.0.255\n network 10.1.2.0 0.0.0.255\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nmpls lsr-id 3.3.3.3\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\nisis 1\n network-entity 10.0000.0000.0000.0010.00\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.3.1 255.255.255.0\n isis enable\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.2.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 3.3.3.3 255.255.255.255\n isis enable\n#\nbgp 100\n segment-routing global-block 18000\n peer 1.1.1.1 as-number 100\n peer 1.1.1.1 connect-interface LoopBack1\n peer 4.4.4.4 as-number 100\n peer 4.4.4.4 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n peer 1.1.1.1 enable\n peer 1.1.1.1 route-policy policy1 export\n peer 1.1.1.1 reflect-client\n peer 1.1.1.1 next-hop-local\n peer 1.1.1.1 label-route-capability\n peer 1.1.1.1 prefix-sid\n peer 4.4.4.4 enable\n peer 4.4.4.4 route-policy policy1 export\n peer 4.4.4.4 reflect-client\n peer 4.4.4.4 next-hop-local\n peer 4.4.4.4 label-route-capability\n peer 4.4.4.4 prefix-sid\n#\nospf 1\n router-id 3.3.3.3\n area 0.0.0.0\n network 3.3.3.3 0.0.0.0\n network 10.1.2.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n if-match mpls-label\n apply mpls-label\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nmpls lsr-id 4.4.4.4\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\nisis 1\n network-entity 10.0000.0000.0000.0020.00\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.4.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.2 255.255.255.0\n isis enable\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 4.4.4.4 255.255.255.255\n isis enable\n#\nbgp 100\n segment-routing global-block 20000\n peer 3.3.3.3 as-number 100\n peer 3.3.3.3 connect-interface LoopBack1\n peer 5.5.5.5 as-number 100\n peer 5.5.5.5 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n peer 3.3.3.3 enable\n peer 3.3.3.3 route-policy policy1 export\n peer 3.3.3.3 reflect-client\n peer 3.3.3.3 next-hop-local\n peer 3.3.3.3 label-route-capability\n peer 3.3.3.3 prefix-sid\n peer 5.5.5.5 enable\n peer 5.5.5.5 route-policy policy1 export\n peer 5.5.5.5 reflect-client\n peer 5.5.5.5 next-hop-local\n peer 5.5.5.5 label-route-capability\n peer 5.5.5.5 prefix-sid\n#\nospf 2\n router-id 4.4.4.4\n area 0.0.0.0\n network 4.4.4.4 0.0.0.0\n network 10.1.4.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n if-match mpls-label\n apply mpls-label\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\nmpls lsr-id 5.5.5.5\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.4.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 5.5.5.5 255.255.255.255\n#\nbgp 100\n segment-routing global-block 22000\n peer 4.4.4.4 as-number 100\n peer 4.4.4.4 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n network 5.5.5.5 255.255.255.255 label-index 10\n peer 4.4.4.4 enable\n peer 4.4.4.4 route-policy policy1 export\n peer 4.4.4.4 label-route-capability\n peer 4.4.4.4 prefix-sid\n#\nospf 2\n router-id 5.5.5.5\n area 0.0.0.0\n network 5.5.5.5 0.0.0.0\n network 10.1.4.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n apply mpls-label\n#\nreturn"
  },
  "related_images": [
    "图1-167 配置BGP SR LSP.png"
  ],
  "topology_original": "DeviceA～DeviceC运行OSPF，DeviceC和DeviceD运行IS-IS，DeviceD和DeviceE运行OSPF。DeviceA～DeviceC在一个IGP域，DeviceC～DeviceD在一个IGP域，DeviceD～DeviceE在一个IGP域。"
}
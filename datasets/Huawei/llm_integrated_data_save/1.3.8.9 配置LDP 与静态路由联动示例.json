{
  "topology": "基于网络拓扑图，增强后的网络拓扑描述如下：\n\n该MPLS网络拓扑由四台LSR设备组成：LSR A、LSR B、LSR C和LSR D，形成一个菱形网络结构。\n\n**物理连接关系：**\n- LSR A通过Interface1连接到LSR B的Interface2\n- LSR A通过Interface2连接到LSR C的Interface1  \n- LSR B通过Interface2连接到LSR D的Interface1\n- LSR C通过Interface2连接到LSR D的Interface1\n- 每台LSR设备均配置Loopback0接口作为LSR-ID\n\n**LSP路径配置：**\n- 主用LSP路径：LSR A → LSR B → LSR D（通过LinkA）\n- 备用LSP路径：LSR A → LSR C → LSR D（通过LinkB）\n- 两条LSP基于静态路由建立，LSR之间通过LDP协议建立标签分发会话\n\n**网络特性：**\n- LinkA为主用链路，承载主要MPLS流量\n- LinkB为备用链路，在主链路故障时提供冗余路径\n- 静态路由指定了到达LSR D的双路径：优选通过LSR B，备选通过LSR C\n- LDP会话建立在静态路由基础上，实现MPLS标签的分发和LSP的建立\n\n**故障场景：**\n当LinkA的LDP会话中断或LinkA故障恢复时，由于静态路由与LDP协议不联动，可能导致MPLS流量的短时中断。",
  "requirement": "在存在主备 LSP 的 MPLS 组网中，LSR 之间依靠静态路由建立 LSP。当主链路的 LDP 会话故障（非链路故障导致）时，或者主链路故障后再恢复时，由于静态路由与 LDP 的不联动，会导致 MPLS 流量的中断（短时中断）。通过配置 LDP 与静态路由联动功能，使得 LinkA 上的 LDP 会话中断或者 LinkA 发生故障再恢复的情况下，保证 MPLS 流量不中断。",
  "steps": [
    "各 LSR 上配置到其他 LSR 的静态路由，使网络互通。",
    "LSR 的全局及接口下使能 MPLS、MPLS LDP 能力。",
    "使能 LDP 和静态路由联动能力，并检查配置结果。"
  ],
  "configs": {
    "LSRA": "#\nsysname LSRA\n#\nmpls lsr-id 1.1.1.1\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n static-route timer ldp-sync hold-down 20\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.2.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 1.1.1.1 255.255.255.255\n#\n ip route-static 2.2.2.2 255.255.255.255 GigabitEthernet1/0/0 10.1.1.2\n ip route-static 3.3.3.3 255.255.255.255 GigabitEthernet2/0/0 10.2.1.2\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet1/0/0 10.1.1.2 preference 40 ldp-sync\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.2.1.2 preference 50\n ip route-static 10.3.1.0 255.255.255.252 GigabitEthernet1/0/0\n ip route-static 10.4.1.0 255.255.255.252 GigabitEthernet2/0/0\n#\nreturn",
    "LSRB": "#\nsysname LSRB\n#\nmpls lsr-id 2.2.2.2\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.3.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack2\n ip address 2.2.2.2 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.1.1.1\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.3.1.2\n#\nreturn",
    "LSRC": "#\nsysname LSRC\n#\nmpls lsr-id 3.3.3.3\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.2.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack3\n ip address 3.3.3.3 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.2.1.1\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.4.1.2\n#\nreturn",
    "LSRD": "#\nsysname LSRD\n#\nmpls lsr-id 4.4.4.4\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.3.1.2 255.255.255.0\n static-route timer ldp-sync hold-down 20\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack4\n ip address 4.4.4.4 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.3.1.1 preference 40 ldp-sync\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet2/0/0 10.4.1.1 preference 50\n ip route-static 2.2.2.2 255.255.255.255 GigabitEthernet1/0/0 10.3.1.1\n ip route-static 3.3.3.3 255.255.255.255 GigabitEthernet2/0/0 10.4.1.1\n ip route-static 10.1.1.0 255.255.255.252 GigabitEthernet1/0/0\n ip route-static 10.2.1.0 255.255.255.252 GigabitEthernet2/0/0\n#\nreturn"
  },
  "related_images": [
    "图1-27 配置LDP与静态路由联动组网图.png"
  ],
  "topology_original": "LSRA 有分别经过 LSRB 和 LSRC 到 LSRD 的静态路由，并基于静态路由建立了 LDP 会话。其中 LinkA 为主用链路，LinkB 为备用链路。"
}
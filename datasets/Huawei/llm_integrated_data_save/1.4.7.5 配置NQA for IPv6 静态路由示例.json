{
  "topology": "在IP城域网组网中，网络设计成冗余备份链路。DeviceB为主用设备，DeviceC为备用设备。正常情况下，业务流量走主用链路DeviceB→SwitchA；当主用链路出现故障后，业务流量切换到备用链路DeviceC→SwitchA。",
  "requirement": "通过配置NQA for IPv6静态路由可以快速检测到网络的故障，控制静态路由的发布，实现业务切换。当网络比较简单，或者路由器不能通过动态路由协议建立到达目的网络的路由时，可以配置静态路由。但是，静态路由自身没有检测机制，当网络发生故障时，静态路由无法感知，需要由管理员介入，这样无法保证及时进行链路切换，可能造成业务较长时间中断。部署BFD for静态路由的方案可以适应链路的变化情况，但是BFD for静态路由要求链路两端的设备都支持BFD功能。如果链路两端有设备不支持BFD功能，可以配置NQA for IPv6静态路由示例，NQA测试例检测到链路故障后，会通知路由管理模块把与其绑定的静态路由从IPv6路由表中删除，使业务流量切换到无链路故障的路由，避免业务的长时间中断。",
  "steps": [
    "创建ICMP类型的NQA测试例，用来检测主用链路的故障。",
    "配置静态路由，在主用链路上绑定NQA测试例。",
    "配置动态路由协议。",
    "OSPF协议引入静态路由，并为主用链路设置较低的开销值。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nospfv3 router-id 1.1.1.1 area 0.0.0.0\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:1::1/64\n ospfv3 1 area 0.0.0.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2::1/64\n ospfv3 1 area 0.0.0.0\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nospfv3 router-id 2.2.2.2\n import-route static cost 10 area 0.0.0.0\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:1::2/64\n ospfv3 1 area 0.0.0.0\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:3::1/64\n#\ninterface GigabitEthernet1/0/2\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:5::1/64\n#\nipv6 route-static 2001:db8:7:: 64 GigabitEthernet1/0/1 2001:db8:3::2 track nqa admin test\n#\nnqa test-instance admin test\n test-type icmp\n destination-address ipv6 2001:db8:3::\n interval seconds 3\n frequency 10\n start now\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nospfv3 router-id 3.3.3.3\n import-route static cost 20 area 0.0.0.0\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:6::1/64\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:4::1/64\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2::2/64\n ospfv3 1 area 0.0.0.0\n#\nipv6 route-static 2001:db8:7:: 64 GigabitEthernet1/0/0 2001:db8:6::\n#\nreturn"
  },
  "related_images": [
    "图1-33 配置NQA for IPv6静态路由组网图.png"
  ]
}
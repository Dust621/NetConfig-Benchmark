{
  "topology": "基于网络拓扑图分析，增强后的网络拓扑描述如下：\n\n该网络采用冗余备份设计，由6台路由器设备组成。Device A作为核心汇聚设备，通过interface1(172.16.3.1/24)连接Device B的interface1(172.16.3.2/24)，通过interface2(172.16.4.1/24)连接Device C的interface1(172.16.4.2/24)，形成主备路径架构。\n\nDevice A与Device B、Device C建立BGP邻居关系。Device B和Device C均配置默认静态路由并通过BGP引入静态路由，通过设置不同的协议首选值实现Device B为主用设备、Device C为备用设备的负载均衡策略。\n\nDevice B通过双链路连接至Device D，形成链路冗余：\n- 主链路：Device B interface2(172.16.1.1/24) ↔ Device B1 interface1(172.16.1.2/24)，Device B1 interface2(172.16.7.1/24) ↔ Device D interface1(172.16.7.2/24)\n- 备用链路：Device B interface3(172.16.2.1/24) ↔ Device B2 interface1(172.16.2.2/24)，Device B2 interface2(172.16.5.2/24) ↔ Device D interface2(172.16.5.1/24)\n\nDevice C通过单链路连接Device D：Device C interface2(172.16.6.1/24) ↔ Device D interface3(172.16.6.2/24)。\n\n配置NQA Group检测Device B到Device D的双链路状态，当检测到链路故障时自动失活相关静态路由，实现业务流量从主用路径Device B→Device D快速切换至备用路径Device C→Device D，确保网络连续性和可靠性。",
  "requirement": "配置NQA Group for IPv4静态路由可以利用NQA Group关联多个NQA测试例，实现对多条链路的检测，快速检测到网络的故障，控制IPv4静态路由的发布，实现业务切换。正常情况下，要求业务流量走主用链路DeviceB→DeviceD。当主用链路出现故障后，即DeviceB的默认IPv4静态路由绑定的NQA Group通过检测DeviceB到DeviceD的两条链路判断IPv4静态路由不活跃，则业务流量切换到备用链路DeviceC→DeviceD。",
  "steps": [
    "创建ICMP类型的NQA测试例。",
    "创建NQA Group。",
    "配置静态路由。",
    "配置BGP路由协议。",
    "BGP协议引入IPv4静态路由。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nrouter id 1.1.1.1\n#\ninterface LoopBack0\n ip address 1.1.1.1 255.255.255.255\n#\ninterface GigabitEthernet 1/0/0\n ip address 172.16.3.1 255.255.255.0\n#\ninterface GigabitEthernet 1/0/1\n ip address 172.16.4.1 255.255.255.0\n#\nbgp 100\n peer 2.2.2.2 as-number 100\n peer 2.2.2.2 connect-interface LoopBack0\n peer 3.3.3.3 as-number 100\n peer 3.3.3.3 connect-interface LoopBack0\n #\n ipv4-family unicast\n  undo synchronization\n  peer 2.2.2.2 enable\n  peer 3.3.3.3 enable\n#\nip route-static 2.2.2.2 255.255.255.255 GigabitEthernet 1/0/0 172.16.3.2\nip route-static 3.3.3.3 255.255.255.255 GigabitEthernet 1/0/1 172.16.4.2\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nrouter id 2.2.2.2\n#\ninterface LoopBack0\n ip address 2.2.2.2 255.255.255.255\n#\ninterface GigabitEthernet 1/0/0\n ip address 172.16.3.2 255.255.255.0\n#\ninterface GigabitEthernet 1/0/1\n ip address 172.16.1.1 255.255.255.0\n#\ninterface GigabitEthernet 1/0/2\n ip address 172.16.2.1 255.255.255.0\n#\nbgp 100\n peer 1.1.1.1 as-number 100\n peer 1.1.1.1 connect-interface LoopBack0\n #\n ipv4-family unicast\n  import-route static\n  peer 1.1.1.1 preferred-value 200\n#\nip route-static 0.0.0.0 32 NULL0 track nqa-group group1\nip route-static 1.1.1.1 255.255.255.255 GigabitEthernet 1/0/0 172.16.3.1\n#\nnqa test-instance user1 test1\n test-type icmp\n destination-address ipv4 172.16.1.2\n interval seconds 5\n timeout 4\n probe-count 3\n frequency 10\n start now\n#\nnqa test-instance user2 test2\n test-type icmp\n destination-address ipv4 172.16.2.2\n interval seconds 5\n timeout 4\n probe-count 3\n frequency 10\n start now\n#\nnqa group group1\n nqa test-instance user1 test1\n nqa test-instance user2 test2\n operator or\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nrouter id 3.3.3.3\n#\ninterface LoopBack0\n ip address 3.3.3.3 255.255.255.255\n#\ninterface GigabitEthernet1/0/0\n ip address 172.16.6.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/1\n ip address 172.16.4.2 255.255.255.0\n#\nbgp 100\n peer 1.1.1.1 as-number 100\n peer 1.1.1.1 connect-interface LoopBack0\n #\n ipv4-family unicast\n  import-route static\n  peer 1.1.1.1 preferred-value 100\n#\nip route-static 0.0.0.0 32 NULL0\nip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/1 172.16.4.1\n#\nreturn"
  },
  "related_images": [
    "图1-24 NQA Group for IPv4 静态路由实现组网图.png"
  ],
  "topology_original": "网络设计成冗余备份链路。DeviceA分别与DeviceB、DeviceC建立BGP邻居。在DeviceB和DeviceC上都配置默认静态路由，且配置BGP路由协议引入静态路由，通过设置不同的协议首选值，设置DeviceB为主用设备，DeviceC为备用设备。DeviceB与DeviceD之间分别通过DeviceB1和DeviceB2有两条链路连接。"
}
{
  "topology": "基于网络拓扑图的详细分析，增强后的网络拓扑描述如下：\n\n**网络拓扑结构：**\n- 网络由5台路由器设备组成：DeviceA、DeviceB、DeviceC、DeviceD、DeviceE\n- Client通过172.16.1.2/24连接到DeviceA的interface1（172.16.1.1/24）\n- Server通过192.168.3.2/24连接到DeviceE的interface2（192.168.3.1/24）\n\n**设备连接关系：**\n- DeviceA interface2（10.0.0.1/24）↔ DeviceB interface1（10.0.0.2/24）\n- DeviceB interface2（100.1.2/24）↔ DeviceC interface2（100.2.2/24）\n- DeviceC interface1（10.0.1.1/24）↔ DeviceD interface1（10.0.1.2/24）\n- DeviceD interface2（10.0.3.1/24）↔ DeviceE interface1（10.0.3.2/24）\n- DeviceC interface2（10.0.2.1/24）↔ DeviceD interface1（10.0.2.2/24）\n\n**协议配置：**\n- 所有设备（DeviceA、DeviceB、DeviceC、DeviceD、DeviceE）运行OSPF协议\n- DeviceB与DeviceD之间建立MPLS TE-Tunnel10隧道\n- DeviceB的Tunnel10接口启用IGP Shortcut功能\n- DeviceB启用OSPF本地MT（Multi-Topology）特性，用于解决组播环境下TE-Tunnel跨越路由器的组播加入报文感知问题\n\n**网络功能：**\n- 网络同时支持单播路由（OSPF）、组播转发和MPLS流量工程\n- TE-Tunnel提供流量工程路径优化\n- IGP Shortcut使得IGP路由能够利用TE隧道作为下一跳\n- OSPF本地MT确保组播流量正确处理TE隧道场景",
  "requirement": "网络中同时部署了组播和MPLS TE-Tunnel，且TE-Tunnel配置了IGP Shortcut。为了解决组播加入报文被TE-Tunnel跨越的路由器无法感知的问题，在DeviceB使能OSPF本地MT特性。",
  "steps": [
    "在各路由器上使能OSPF，配置OSPF基本功能。",
    "在各路由器上使能组播PIM-SM功能。",
    "配置MPLS RSVP-TE隧道。",
    "在DeviceB上配置MPLS TE-Tunnel，并使能IGP-Shortcut。",
    "在DeviceB上使能OSPF本地MT特性。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nrouter id 1.1.1.1\n#\nmulticast routing-enable\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.0.1 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 172.16.1.1 255.255.255.0\n pim sm\n igmp enable\n igmp version 2\n#\ninterface LoopBack0\n ip address 1.1.1.1 255.255.255.255\n#\nospf 1\n area 0.0.0.0\n  network 172.16.1.0 0.0.0.255\n  network 10.0.0.0 0.0.0.255\n  network 1.1.1.1 0.0.0.0\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nrouter id 2.2.2.2\n#\nmulticast routing-enable\n#\nmpls lsr-id 2.2.2.2\n#\nmpls\n mpls te\n mpls rsvp-te\n mpls te cspf\n#\nospf 1\n opaque-capability enable\n enable traffic-adjustment\n local-mt enable\n area 0.0.0.0\n  network 10.0.0.0 0.0.0.255\n  network 10.0.1.0 0.0.0.255\n  network 2.2.2.2 0.0.0.0\n  mpls-te enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.0.2 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.1.2 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n ip address 2.2.2.2 255.255.255.255\n pim sm\n#\ninterface Tunnel10\n ip address unnumbered interface LoopBack0\n tunnel-protocol mpls te\n destination 4.4.4.4\n mpls te tunnel-id 100\n mpls te igp shortcut ospf\n mpls te igp metric relative -10\n#\npim\n C-BSR LoopBack0\n C-RP LoopBack0\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nrouter id 3.3.3.3\n#\nmulticast routing-enable\n#\nmpls lsr-id 3.3.3.3\n#\nmpls\n mpls te\n mpls rsvp-te\n#\nospf 1\n opaque-capability enable\n area 0.0.0.0\n  network 10.0.1.0 0.0.0.255\n  network 10.0.2.0 0.0.0.255\n  network 3.3.3.3 0.0.0.0\n  mpls-te enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.1.1 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.2.2 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n undo shutdown\n ip address 3.3.3.3 255.255.255.255\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nrouter id 4.4.4.4\n#\nmulticast routing-enable\n#\nmpls lsr-id 4.4.4.4\n#\nmpls\n mpls te\n mpls rsvp-te\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.3.1 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.2.1 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n ip address 4.4.4.4 255.255.255.255\n pim sm\n#\nospf 1\n opaque-capability enable\n area 0.0.0.0\n  network 10.0.2.0 0.0.0.255\n  network 10.0.3.0 0.0.0.255\n  network 4.4.4.4 0.0.0.0\n  mpls-te enable\n#\npim\n C-BSR LoopBack0\n C-RP LoopBack0\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\nrouter id 5.5.5.5\n#\nmulticast routing-enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.3.2 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 192.168.3.1 255.255.255.0\n pim sm\n#\ninterface LoopBack0\n ip address 5.5.5.5 255.255.255.255\n pim sm\n#\nospf 1\n area 0.0.0.0\n  network 10.0.3.0 0.0.0.255\n  network 192.168.3.0 0.0.0.255\n  network 5.5.5.5 0.0.0.0\n#\nreturn"
  },
  "related_images": [
    "图1-49 配置OSPF本地MT特性组网图.png"
  ],
  "topology_original": "DeviceA、DeviceB、DeviceC、DeviceD、DeviceE都运行OSPF协议。DeviceB和DeviceD之间建立了一条MPLS TE-Tunnel10，并且在DeviceB的Tunnel10上使能了IGP Shortcut。"
}
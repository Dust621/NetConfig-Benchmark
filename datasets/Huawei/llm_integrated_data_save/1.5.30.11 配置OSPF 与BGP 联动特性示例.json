{
  "topology": "网络拓扑由6台路由器组成，分布在两个自治系统中：\n\n**物理连接：**\n- DeviceA通过interface1(10.1.1.1/30)连接DeviceB的interface1(10.1.1.2/30)\n- DeviceA通过interface2(10.1.2.2/30)连接DeviceC的interface2(10.1.2.1/30)\n- DeviceB通过interface2(10.1.3.1/30)连接DeviceD的interface2(10.1.3.2/30)\n- DeviceC通过interface1(10.1.4.1/30)连接DeviceD的interface1(10.1.4.2/30)\n- DeviceD通过interface3(10.2.1.1/30)连接DeviceE的interface2(10.2.1.2/30)\n- DeviceE通过interface1(10.3.1.2/30)连接DeviceF的interface1(10.3.1.1/30)\n\n**AS划分：**\n- AS10：包含DeviceA、DeviceB、DeviceC、DeviceD\n- AS20：包含DeviceE、DeviceF\n\n**协议配置：**\n- AS10内部运行OSPF作为IGP，所有设备间建立IBGP邻居关系\n- DeviceD与DeviceE之间建立EBGP连接，实现AS间路由交换\n- AS20内部DeviceE与DeviceF建立IBGP连接\n\n**组网需求：**\n在DeviceB上配置OSPF与BGP联动功能，确保DeviceB重启时从DeviceA到AS20的流量路径能够快速切换，避免业务中断。",
  "requirement": "在DeviceB上使能OSPF与BGP联动功能，使得当DeviceB重启后，从DeviceA到AS20的流量不发生中断。",
  "steps": [
    "在DeviceA、DeviceB、DeviceC和DeviceD上使能OSPF协议，指定相同区域内的网段。",
    "在DeviceA、DeviceB、DeviceC和DeviceD之间建立IBGP连接。",
    "在DeviceC上配置OSPF协议的开销值。",
    "在DeviceD和DeviceE之间配置EBGP连接。",
    "在DeviceD上配置BGP引入直连路由和OSPF进程。",
    "在DeviceE上配置BGP。",
    "在DeviceB上使能OSPF与BGP联动功能。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nrouter id 1.1.1.1\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.252\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.2.1 255.255.255.252\n#\ninterface LoopBack0\n ip address 1.1.1.1 255.255.255.255\n#\nbgp 10\n router-id 1.1.1.1\n peer 2.2.2.2 as-number 10\n peer 2.2.2.2 connect-interface LoopBack0\n peer 3.3.3.3 as-number 10\n peer 3.3.3.3 connect-interface LoopBack0\n peer 4.4.4.4 as-number 10\n peer 4.4.4.4 connect-interface LoopBack0\n#\nospf 1\n area 0.0.0.0\n  network 1.1.1.1 0.0.0.0\n  network 10.1.1.0 0.0.0.3\n  network 10.1.2.0 0.0.0.3\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nrouter id 2.2.2.2\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.252\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.1 255.255.255.252\n#\ninterface LoopBack0\n ip address 2.2.2.2 255.255.255.255\n#\nbgp 10\n router-id 2.2.2.2\n peer 1.1.1.1 as-number 10\n peer 1.1.1.1 connect-interface LoopBack0\n peer 3.3.3.3 as-number 10\n peer 3.3.3.3 connect-interface LoopBack0\n peer 4.4.4.4 as-number 10\n peer 4.4.4.4 connect-interface LoopBack0\n#\nospf 1\n stub-router on-startup\n area 0.0.0.0\n  network 10.1.1.0 0.0.0.3\n  network 10.1.3.0 0.0.0.3\n  network 2.2.2.2 0.0.0.0\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nrouter id 3.3.3.3\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.4.1 255.255.255.252\n ospf cost 2\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.2.2 255.255.255.252\n ospf cost 2\n#\ninterface LoopBack0\n ip address 3.3.3.3 255.255.255.255\n#\nbgp 10\n router-id 3.3.3.3\n peer 1.1.1.1 as-number 10\n peer 1.1.1.1 connect-interface LoopBack0\n peer 2.2.2.2 as-number 10\n peer 2.2.2.2 connect-interface LoopBack0\n peer 4.4.4.4 as-number 10\n peer 4.4.4.4 connect-interface LoopBack0\n#\nospf 1\n area 0.0.0.0\n  network 10.1.2.0 0.0.0.3\n  network 10.1.4.0 0.0.0.3\n  network 3.3.3.3 0.0.0.0\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nrouter id 4.4.4.4\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.4.2 255.255.255.252\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.2 255.255.255.252\n#\ninterface GigabitEthernet3/0/0\n undo shutdown\n ip address 10.2.1.1 255.255.255.252\n#\ninterface LoopBack0\n ip address 4.4.4.4 255.255.255.255\n#\nbgp 10\n router-id 4.4.4.4\n peer 10.2.1.2 as-number 20\n peer 1.1.1.1 as-number 10\n peer 1.1.1.1 connect-interface LoopBack0\n peer 2.2.2.2 as-number 10\n peer 2.2.2.2 connect-interface LoopBack0\n peer 3.3.3.3 as-number 10\n peer 3.3.3.3 connect-interface LoopBack0\n#\n ipv4-family unicast\n  undo synchronization\n  import-route direct\n  import-route ospf 1\n  peer 10.2.1.2 enable\n#\nospf 1\n area 0.0.0.0\n  network 4.4.4.4 0.0.0.0\n  network 10.1.3.0 0.0.0.3\n  network 10.1.4.0 0.0.0.3\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\nrouter id 5.5.5.5\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.2.1.2 255.255.255.252\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.3.1.1 255.255.255.0\n#\ninterface LoopBack0\n ip address 5.5.5.5 255.255.255.255\n#\nbgp 20\n router-id 5.5.5.5\n peer 10.2.1.1 as-number 10\n#\n ipv4-family unicast\n  undo synchronization\n  network 10.3.1.0 255.255.255.0\n  peer 10.2.1.1 enable\n#\nreturn"
  },
  "related_images": [
    "图1-52 配置OSPF 与BGP 联动组网图.png"
  ],
  "topology_original": "所有路由器均为BGP设备，DeviceD和DeviceE之间建立EBGP连接。在AS10内的设备之间建立IBGP连接，并且使用OSPF作为IGP协议。DeviceA、DeviceB、DeviceC和DeviceD位于AS10，DeviceE位于AS20。"
}
{
  "topology": "网络拓扑由两个自治系统组成：AS65008和AS65009。\n\n**AS65008包含三台路由器：**\n- DeviceA（核心路由器）：配置4个接口\n  - interface1: 10.2.1.2/24 连接DeviceD\n  - interface2: 10.1.2.1/24 连接DeviceC（跨AS连接）\n  - interface3: 10.2.1.1/24 连接内部网络\n  - interface4: 10.2.2.1/24 连接DeviceE\n- DeviceD：interface1配置10.2.1.2/24，通过IBGP与DeviceA建立邻居关系\n- DeviceE：interface1配置10.2.2.2/24，通过IBGP与DeviceA建立邻居关系\n\n**AS65009包含两台路由器：**\n- DeviceB：interface1配置10.1.1.2/24，通过EBGP连接外部网络\n- DeviceC：interface1配置10.1.2.2/24，通过EBGP与DeviceA建立跨AS邻居关系\n\n**BGP配置特点：**\nDeviceA作为动态对等体服务器，配置动态对等体组功能，侦听10.2.0.0/16网段（覆盖AS65008内部设备）和10.1.0.0/16网段（覆盖跨AS连接）的BGP连接请求。AS内部使用IBGP协议，AS间使用EBGP协议建立邻居关系。\n\n**网络分段：**\n- 10.2.1.0/24网段：DeviceA与DeviceD互联\n- 10.2.2.0/24网段：DeviceA与DeviceE互联  \n- 10.1.2.0/24网段：DeviceA与DeviceC跨AS互联\n- 10.1.1.0/24网段：DeviceB外部连接",
  "requirement": "在BGP网络中，多个对等体经常发生变动，邻居的建立情况随之发生变动。配置BGP动态对等体功能，使BGP侦听指定网段的BGP连接请求并动态建立BGP对等体，同时将这些对等体加入到同一个动态对等体组中。这样当对等体发生变动时，无需在本端进行增加或删除BGP对等体的配置，减少网络维护的工作量。",
  "steps": [
    "在DeviceA上配置IBGP动态对等体组，侦听10.2.0.0/16网段的BGP连接请求。",
    "在DeviceA上配置EBGP动态对等体组，侦听10.1.0.0/16网段的BGP连接请求。",
    "DeviceD、DeviceE上分别与DeviceA配置IBGP连接。",
    "DeviceB、DeviceC上分别与DeviceA配置EBGP连接。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/2\n undo shutdown\n ip address 10.1.2.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/3\n undo shutdown\n ip address 10.2.1.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/4\n undo shutdown\n ip address 10.2.2.1 255.255.255.0\n#\nbgp 65008\n bgp dynamic-session-limit\n group a listen internal\n peer a listen-net 10.2.0.0 255.255.0.0\n group b listen external\n peer b listen-as 65009\n peer b listen-net 10.1.0.0 255.255.0.0\n#\n ipv4-family unicast\n  peer a enable\n  peer b enable\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n#\nbgp 65009\n peer 10.1.1.1 as-number 65008\n#\n ipv4-family unicast\n  peer 10.1.1.1 enable\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.1.2.2 255.255.255.0\n#\nbgp 65009\n peer 10.1.2.1 as-number 65008\n#\n ipv4-family unicast\n  peer 10.1.2.1 enable\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.2.1.2 255.255.255.0\n#\nbgp 65008\n peer 10.2.1.1 as-number 65008\n#\n ipv4-family unicast\n  peer 10.2.1.1 enable\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.2.2.2 255.255.255.0\n#\nbgp 65008\n peer 10.2.2.1 as-number 65008\n#\n ipv4-family unicast\n  peer 10.2.2.1 enable\n#\nreturn"
  },
  "related_images": [
    "图1-165 配置BGP动态对等体组组网图.png"
  ],
  "topology_original": "DeviceA、DeviceD和DeviceE处于AS65008，DeviceB和DeviceC处于AS65009。DeviceA上配置动态对等体组，侦听10.2.0.0/16和10.1.0.0/16网段的BGP连接请求。"
}
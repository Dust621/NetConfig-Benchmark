{
  "topology": "基于网络拓扑图分析，增强后的网络拓扑描述如下：\n\n**网络拓扑结构：**\n\n该网络由四台设备组成，包括一台核心交换机SwitchA和三台路由设备（DeviceA、DeviceB、DeviceC、DeviceD）。\n\n**物理连接关系：**\n- DeviceA通过Interface1（2001:db8:2000::3/64）连接到SwitchA的Interface1\n- DeviceB通过Interface1（2001:db8:2000::4/64）连接到SwitchA的Interface3  \n- SwitchA通过Interface2连接到DeviceC的Interface2（2001:db8:2001::1/64）\n- DeviceC通过Interface1连接到AS100区域内的DeviceD，DeviceD的Interface1地址为2001:db8:2001::2/64\n\n**VLAN配置：**\n- SwitchA配置VLAN10，将DeviceA和DeviceB划分在同一VLAN内\n- DeviceC配置VLANIF10接口（2001:db8:2000::1/64）作为VLAN10的网关\n\n**路由协议配置：**\n- DeviceC和DeviceD部署在AS100自治系统内\n- DeviceC与DeviceD之间运行BGP协议进行路由交换\n- 所有设备采用IPv6寻址方案\n\n**网络分段：**\n- 用户网段：2001:db8:2000::/64（包含DeviceA和DeviceB）\n- 互连网段：2001:db8:2001::/64（DeviceC与DeviceD之间）\n\n**特殊需求：**\nDeviceD仅需与DeviceB建立通信，不与DeviceA互访。通过在DeviceC上配置IPv6 NDP Vlink直连路由发布和路由策略，过滤到DeviceA的明细路由，实现精确的流量控制。",
  "requirement": "通过发布IPv6 NDP Vlink直连路由，可以使远端设备获得VLAN内的明细路由，从而实现对流量的精确控制。在DeviceC上配置发布IPv6 NDP Vlink直连路由，并利用路由策略过滤掉网段路由和到DeviceA的路由。",
  "steps": [
    "在SwitchA和DeviceC上创建VLANIF，并且配置IPv6地址，保证DeviceA、DeviceB、SwitchA和DeviceC之间的互通。",
    "在DeviceC和DeviceD之间配置BGP4+协议，保证DeviceC和DeviceD之间可以相互传递IPv6路由。",
    "在DeviceC上配置发布IPv6 NDP Vlink直连路由，使IPv6 NDP Vlink直连路由可发布。",
    "在DeviceC上配置路由策略，只允许来源于DeviceB的IPv6路由通过。",
    "在DeviceC上配置BGP4+引入IPv6直连路由，并且应用路由策略只引入来源于DeviceB的IPv6路由。",
    "在DeviceC上配置BGP4+使用路由出口过滤策略，过滤掉VLAN所在网段路由，使DeviceD无法看到网段路由，只能使用IPv6 NDP Vlink直连路由与VLAN内的用户通信，这样便于控制VLAN内用户与VLAN外的通信。"
  ],
  "configs": {
    "SwitchA": "#\nsysname SwitchA\n#\nvlan batch 10\n#\ninterface Vlanif10\n ipv6 enable\n ipv6 address 2001:db8:2000::2/64\n#\ninterface GigabitEthernet1/0/0\n portswitch\n undo shutdown\n port link-type access\n port default vlan 10\n#\ninterface GigabitEthernet2/0/0\n portswitch\n undo shutdown\n port link-type access\n port default vlan 10\n#\ninterface GigabitEthernet3/0/0\n portswitch\n undo shutdown\n port link-type access\n port default vlan 10\n#\nreturn",
    "DeviceA": "#\nsysname DeviceA\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2000::3/64\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2000::4/64\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nip ipv6-prefix prefix1 index 10 permit 2001:db8:2000::4 128\n#\nip ipv6-prefix prefix2 index 10 deny 2001:db8:2000:: 64\n#\nip ipv6-prefix prefix2 index 20 permit :: 0 less-equal 128\n#\nroute-policy policy1 permit node 10\n if-match ipv6 address prefix-list prefix1\n#\nroute-policy policy2 permit node 10\n if-match ipv6 address prefix-list prefix2\n#\nipv6 nd vlink-direct-route advertise route-policy policy1\n#\nvlan batch 10\n#\ninterface Vlanif10\n ipv6 enable\n ipv6 address 2001:db8:2000::1/64\n#\ninterface GigabitEthernet1/0/0\n portswitch\n undo shutdown\n port link-type access\n port default vlan 10\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2001::1/64\n#\nbgp 100\n router-id 1.1.1.1\n peer 2001:db8:2001::2 as-number 100\n ipv4-family unicast\n  undo synchronization\n ipv6-family unicast\n  undo synchronization\n  import-route direct\n  peer 2001:db8:2001::2 enable\n  peer 2001:db8:2001::2 route-policy policy2 export\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ipv6 enable\n ipv6 address 2001:db8:2001::2/64\n#\nbgp 100\n router-id 2.2.2.2\n peer 2001:db8:2001::1 as-number 100\n ipv4-family unicast\n  undo synchronization\n ipv6-family unicast\n  undo synchronization\n  peer 2001:db8:2001::1 enable\n#\nreturn"
  },
  "related_images": [
    "图1-17 配置BGP4_引入IPv6 NDP Vlink 直连路由组网图.png"
  ],
  "topology_original": "DeviceC通过VLANIF接口连接了两个用户（DeviceA和DeviceB）。DeviceD只需要与DeviceB互访，而与DeviceA没有互访需求。"
}
{
  "topology": "**网络拓扑架构详细描述**\n\n**物理拓扑结构：**\n本网络由四台路由器构成混合路由域架构，设备间通过以太网接口互联。R1、R2、R3构成OSPF域骨干区域，R3作为边界路由器与R4组成IS-IS Level-1区域。拓扑呈现典型的双协议域互联结构，其中R3承担协议边界网关角色。\n\n**接口连接关系：**\n- R1-R2：GE0/0/2接口直连，网段10.0.12.0/24（R1: 10.0.12.1/24, R2: 10.0.12.2/24）\n- R1-R3：GE0/0/2接口连接，网段10.0.13.0/24（R1: 10.0.13.1/24, R3: 10.0.13.3/24）  \n- R2-R3：GE0/0/3接口连接，网段10.0.23.0/24（R2: 10.0.23.2/24, R3: 10.0.23.3/24）\n- R3-R4：GE0/0/3接口直连，网段10.0.34.0/24（R3: 10.0.34.3/24, R4: 10.0.34.4/24）\n- R4-R5：GE0/0/2接口连接，网段10.0.45.0/24（R4: 10.0.45.4/24, R5: 10.0.45.5/24）\n\n**IP地址分配方案：**\n- 环回接口：各设备Loopback0采用10.0.x.x/32格式，x为设备编号\n- 互联网段：采用10.0.xy.0/24格式，xy代表连接的两台设备编号\n- 业务网段：R1通过Loopback1/2/3模拟三个业务网段A、B、C，地址为172.16.1.0/24、172.16.2.0/24、172.16.3.0/24、172.16.4.0/24\n- AS边界：R5属于AS 200，地址段172.16.0.0/24系列，R4-R5链路跨越AS 64512到AS 200\n\n**路由协议部署：**\n\n*OSPF区域配置：*\n- R1、R2、R3构成OSPF骨干区域Area 0\n- 激活接口：所有互联接口和Loopback0接口\n- R1作为ASBR，负责外部路由引入\n- R3作为ABR角色，同时连接IS-IS域\n\n*IS-IS区域配置：*\n- R3、R4组成IS-IS Area 49.0001\n- 路由器类型：均配置为Level-1路由器\n- 系统ID格式：0000.0000.000x（x为设备编号）\n- R3承担Level-1/Level-2边界功能\n\n**路由策略与过滤机制：**\n\n*R1路由引入策略：*\n- 通过Route-Policy将直连业务网段路由引入OSPF\n- 策略配置：拒绝C业务网段路由引入，允许A、B业务网段\n- 路由标记：A业务网段标记tag 10，B业务网段标记tag 20\n- 实现业务网段的选择性发布\n\n*R2接收过滤策略：*\n- 配置Filter-Policy对OSPF接收路由进行过滤\n- 过滤规则：拒绝A业务网段路由，仅接收B业务网段路由\n- 满足不同部门的业务访问需求差异化\n\n*R3重分发策略：*\n- 将OSPF外部路由重分发至IS-IS域\n- 通过Route-Policy匹配路由标记tag 10\n- 仅引入A业务网段路由，过滤B业务网段\n- 实现IS-IS域对特定业务的受控访问\n\n**网络功能特征：**\n- 双协议域架构：OSPF域承载企业内部路由，IS-IS域服务特定业务区域\n- 路由策略控制：通过标记和过滤实现细粒度的路由发布控制\n- 业务隔离：不同网段采用差异化路由策略，满足安全和访问控制需求\n- 边界网关功能：R3作为协议转换点，负责域间路由信息的受控交换\n- 可扩展架构：支持后续业务网段扩展和路由策略调整",
  "requirement": "公司网络中有两部分路由区域，一部分运行OSPF，另外一部分运行IS-IS，OSPF 区域的边界路由器连接了一些其他公司的业务网段，为了能够正常访问这几个业务网段，需要将业务网段路由引入到OSPF 区域内，同时为了让IS-IS 区域内也能够正常访问业务网段，需要将OSPF外部路由引入到IS-IS。公司网络中不同部门对业务网段访问需求不同，为此需要部署路由策略、过滤策略限制路由的接收、发布。",
  "steps": [
    "设备基础IP 地址配置。",
    "配置R1、R2、R3 之间的OSPF，在互联接口、Loopback0 接口上激活OSPF。在R3、R4之间配置IS-IS。",
    "在R1 上将直连路由引入到OSPF 中，同时配置路由策略不引入C 业务网段的路由，将A、B 业务网段路由分别打上路由标记10、20。",
    "在R2 上配置Filter-Policy 对接收的OSPF 路由进行过滤，只接收B 业务网段的路由。",
    "在R3 上将OSPF 路由引入到IS-IS 中，通过Route-Policy 匹配路由标记，只引入A 业务网段的OSPF 外部路由。"
  ],
  "configs": {
    "R1": "sysname R1 \ninterface GigabitEthernet0/0/2 \n ip address 10.0.12.1 255.255.255.0 \ninterface LoopBack0 \n ip address 10.0.1.1 255.255.255.255 \ninterface LoopBack1 \n ip address 172.16.1.1 255.255.255.0 \ninterface LoopBack2 \n ip address 172.16.2.1 255.255.255.0 \ninterface LoopBack3 \n ip address 172.16.3.1 255.255.255.0 \nospf 1 router-id 10.0.1.1 \n import-route direct route-policy hcip \n area 0.0.0.0 \n  network 10.0.1.1 0.0.0.0 \n  network 10.0.12.1 0.0.0.0 \nroute-policy hcip permit node 10 \n if-match ip-prefix 1 \n apply tag 10 \nroute-policy hcip permit node 20 \n if-match ip-prefix 2 \n apply tag 20 \nip ip-prefix 1 index 10 permit 172.16.1.0 24 greater-equal 24 less-equal 24 \nip ip-prefix 2 index 10 permit 172.16.2.0 24 greater-equal 24 less-equal 24 \nreturn",
    "R2": "sysname R2 \nacl number 2000 \n rule 5 deny source 172.16.1.0 0.0.0.255 \n rule 10 permit \ninterface GigabitEthernet0/0/2 \n ip address 10.0.23.2 255.255.255.0 \ninterface GigabitEthernet0/0/3 \n ip address 10.0.12.2 255.255.255.0 \ninterface LoopBack0 \n ip address 10.0.2.2 255.255.255.255 \nospf 1 router-id 10.0.2.2 \n filter-policy 2000 import \n area 0.0.0.0 \n  network 10.0.2.2 0.0.0.0 \n  network 10.0.23.2 0.0.0.0 \n  network 10.0.12.2 0.0.0.0 \nreturn",
    "R3": "sysname R3 \nisis 1 \n is-level level-1 \n network-entity 49.0001.0000.0000.0003.00 \n import-route ospf 1 level-1 route-policy hcip \ninterface GigabitEthernet0/0/2 \n ip address 10.0.34.3 255.255.255.0 \n isis enable 1 \ninterface GigabitEthernet0/0/3 \n ip address 10.0.23.3 255.255.255.0 \ninterface LoopBack0 \n ip address 10.0.3.3 255.255.255.255 \nospf 1 router-id 10.0.3.3 \n area 0.0.0.0 \n  network 10.0.3.3 0.0.0.0 \n  network 10.0.23.3 0.0.0.0 \nroute-policy hcip permit node 10 \n if-match tag 10 \nreturn",
    "R4": "sysname R4 \nisis 1 \n is-level level-1 \n network-entity 49.0001.0000.0000.0004.00 \ninterface GigabitEthernet0/0/3 \n ip address 10.0.34.4 255.255.255.0 \n isis enable 1 \ninterface LoopBack0 \n ip address 10.0.4.4 255.255.255.255 \n isis enable 1 \nreturn"
  },
  "topology_original": "设备互联方式、互联地址如图所示，所有设备均创建Loopback0，其IP 地址为10.0.x.x/32，其中x 为设备编号，R1、R2、R3 在互联接口、Loopback0 接口上激活OSPF。 R3、R4 属于IS-IS Area 49.0001，两者都是Level-1 路由器，R3、R4 的系统ID 采用0000.0000.000x 格式，其中x 为设备编号。 R1 上存在三个业务网段A、B、C（使用Loopback1、2、3 接口路由模拟），在R1 上将直连路由引入到OSPF，但是OSPF 域内的路由器上不需要C 业务的路由，为此在R1 上引入直连路由时通过Route-Policy 过滤引入的路由。 R2 上不需要A 业务网段的路由，但是R3 上需要A、B 业务网段的路由，为此在R2 上配置Filter-Policy 对OSPF 接收的路由进行过滤。 IS-IS 域内的路由器需要访问A 业务，因此需要在R3 上执行路由重分发，将OSPF 路由引入到IS-IS，但是IS-IS 域内的路由器不需要访问B 业务，为此在R1 上引入直连路由时为A、B业务网段路由打上不同的路由标记，R3 上执行重分发时根据路由标记过滤B 业务网段路由。"
}
{
  "topology": "## 网络拓扑详细描述\n\n### 物理拓扑结构\n该网络拓扑采用星型结构，由5台路由器组成，分为两个IS-IS区域。核心连接通过以太网链路实现，形成了一个典型的两层IS-IS架构。\n\n**设备连接关系：**\n- R1通过GE0/0/1接口连接交换机S5\n- R2通过GE0/0/1接口连接交换机S5，通过GE0/0/5接口连接交换机S1\n- R3通过GE0/0/1接口连接交换机S5，通过GE0/0/2接口连接交换机S1\n- R4通过GE0/0/5接口连接交换机S1，通过GE0/0/2接口连接R5\n- R5通过GE0/0/3接口连接R4\n\n**物理介质：**\n- 所有连接均为千兆以太网链路\n- S1和S5为二层交换机，提供广播域支持\n- R4-R5之间为点对点直连链路\n\n### IP地址分配方案\n**Loopback接口配置：**\n- R1: Loopback0 - 10.0.1.1/32\n- R2: Loopback0 - 10.0.2.2/32\n- R3: Loopback0 - 10.0.3.3/32\n- R4: Loopback0 - 10.0.4.4/32\n- R5: Loopback0 - 10.0.5.5/32\n\n**互连接口IP地址：**\n- R1 GE0/0/1: 10.0.123.1/24（连接S5）\n- R2 GE0/0/1: 10.0.123.2/24（连接S5）\n- R2 GE0/0/5: 10.0.24.2/24（连接S1）\n- R3 GE0/0/1: 10.0.123.3/24（连接S5）\n- R3 GE0/0/2: 10.0.34.3/24（连接S1）\n- R4 GE0/0/5: 10.0.24.4/24（连接S1）\n- R4 GE0/0/2: 10.0.45.4/24（连接R5）\n- R5 GE0/0/3: 10.0.45.5/24（连接R4）\n\n### IS-IS协议架构\n**区域划分：**\n- 49.0001区域：包含R1、R2、R3\n- 49.0002区域：包含R4、R5\n\n**路由器等级配置：**\n- R1：Level-1路由器（L1），仅维护49.0001区域内路由\n- R2：Level-1-2路由器（L1-L2），作为区域边界路由器\n- R3：Level-1-2路由器（L1-L2），作为区域边界路由器\n- R4：Level-2路由器（L2），维护区域间路由\n- R5：Level-2路由器（L2），维护区域间路由\n\n**DIS选举配置：**\n- 在10.0.123.0/24网段（S5连接的广播域）中，R1将被手动配置为DIS\n- 通过提高R1 GE0/0/1接口的IS-IS DIS优先级实现\n\n### 关键配置特征\n**外部路由引入：**\n- R5上创建Loopback1接口（192.168.1.0/24）\n- 该网段作为外部路由引入IS-IS Level-2\n\n**流量工程控制：**\n- R4的GE0/0/3接口IS-IS Cost值需手动调整，影响R4到R1的路径选择\n- 通过Cost调整使R4优选经过R2的路径到达R1\n\n**路由渗透配置：**\n- R3上配置IS-IS路由渗透（Route Leaking）\n- 将Level-2明细路由渗透到Level-1，使R1能够学习到49.0002区域的具体路由\n- 通过最长匹配原则，R1将优选经过R3的路径到达49.0002区域\n\n### 网络流量路径分析\n**正常情况下的路径：**\n- R1 → R5：R1 → R2 → R4 → R5（通过默认路由）\n- R5 → R1：R5 → R4 → R2 → R1\n\n**优化后的期望路径：**\n- R1 → R5：R1 → R3 → R4 → R5（通过路由渗透实现）\n- R5 → R1：R5 → R4 → R3 → R1（通过Cost调整实现）\n\n### 设备角色定义\n- **R1**：Level-1终端路由器，作为49.0001区域内主机的网关\n- **R2/R3**：ABR（Area Border Router），连接不同IS-IS Level\n- **R4**：Level-2骨干路由器，提供区域间连接\n- **R5**：Level-2边界路由器，负责外部路由引入\n\n该拓扑设计实现了IS-IS两层架构的典型部署，通过精确的Cost调整和路由渗透机制实现了双向流量的路径控制。",
  "requirement": "某客户的网络使用IS-IS 协议作为IGP，R4 和R5 运行在49.0002 区域，都是Level-2 路由器。R1、R2、R3 运行在49.0001 区域，其中R1 是Level-1 路由器，R2 和R3 作为Level-1-2 路由器。R5 上引入了外部路由192.168.1.0/24。要求：R1 可以访问R5 引入的外部路由；R1 的GE0/0/1 接口作为DIS；R1 与R5 之间的双向流量要求沿着R3、R4 这条路径转发，可以通过cost 和路由渗透进行选路控制。",
  "steps": [
    "设备IP 地址配置。",
    "按照规划配置IS-IS。",
    "检查IS-IS 配置结果，分别在R1、R4 检查IS-IS 邻居信息。",
    "手动修改R1 GE0/0/1 接口的DIS 优先级，使其成为DIS。",
    "在R5 上创建Loopback1，作为外部路由引入到IS-IS 中，分别在R4、R1 上观察IS-IS 路由表，并测试R1 与外部路由地址之间的连通性。",
    "手动在R4 上修改GE0/0/3 的IS-IS Cost 值，使得R4 优选下一跳为R2 的路由前往R1。",
    "在R3 上配置IS-IS 的路由渗透，使得R1 从R3 上学习到L2 区域的明细路由，使得R1 根据最长匹配原则，优选下一跳为R3 的明细路由前往L2 区域。"
  ],
  "configs": {
    "R1": "sysname R1\nisis 1\n is-level level-1\n network-entity 49.0001.0000.0000.0001.00\ninterface GigabitEthernet0/0/1\n ip address 10.0.123.1 255.255.255.0\n isis enable 1\nisis authentication-mode md5 huawei\n isis dis-priority 127\ninterface LoopBack0\n ip address 10.0.1.1 255.255.255.255\n isis enable 1",
    "R2": "sysname R2\nisis 1\n network-entity 49.0001.0000.0000.0002.00\ninterface GigabitEthernet0/0/1\n ip address 10.0.123.2 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface GigabitEthernet0/0/5\n ip address 10.0.24.2 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface LoopBack0\n ip address 10.0.2.2 255.255.255.255\n isis enable 1",
    "R3": "sysname R3\nisis 1\n network-entity 49.0001.0000.0000.0003.00\n import-route isis level-2 into level-1\ninterface GigabitEthernet0/0/1\n ip address 10.0.123.3 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface GigabitEthernet0/0/2\n ip address 10.0.34.3 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface LoopBack0\n ip address 10.0.3.3 255.255.255.255\n isis enable 1",
    "R4": "sysname R4\nisis 1\n is-level level-2\n network-entity 49.0002.0000.0000.0004.00\ninterface GigabitEthernet0/0/2\n ip address 10.0.45.4 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface GigabitEthernet0/0/3\n ip address 10.0.34.4 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\n isis cost 15\ninterface GigabitEthernet0/0/5\n ip address 10.0.24.4 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface LoopBack0\n ip address 10.0.4.4 255.255.255.255\n isis enable 1",
    "R5": "sysname R5\nisis 1\n is-level level-2\n network-entity 49.0002.0000.0000.0005.00\n import-route direct\ninterface GigabitEthernet0/0/3\n ip address 10.0.45.5 255.255.255.0\n isis enable 1\n isis authentication-mode md5 huawei\ninterface LoopBack0\n ip address 10.0.5.5 255.255.255.255\n isis enable 1\n isis authentication-mode md5 huawei\ninterface LoopBack1\n ip address 192.168.1.1 255.255.255.255"
  },
  "topology_original": "IP 地址、IS-IS 区域、IS-IS 路由器等级如图所示，其中R1、R2、R3 属于49.0001 区域，R4、R5 属于49.0002 区域，所有路由器均创建Loopback0 接口，其IP 地址为10.0.x.x/32，其中x为设备编号。"
}
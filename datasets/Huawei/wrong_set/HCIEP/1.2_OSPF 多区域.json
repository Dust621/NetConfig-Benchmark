{
  "topology": "基于提供的网络拓扑图和实验需求，以下是完善后的网络拓扑描述：\n\n## 物理拓扑结构\n\n**设备配置：** 5台华为AR系列路由器（R1、R2、R3、R4、R5）\n- **总部设备：** R2、R4作为骨干核心路由器\n- **分部设备：** R1、R3、R5作为分支接入路由器\n\n**物理连接关系：**\n- R1 ↔ S1：GE0/0/3 - GE0/0/3 (10.0.123.1/24 - 10.0.123.3/24)\n- S1 ↔ R2：GE0/0/1 - GE0/0/2 (10.0.123.3/24 - 10.0.123.2/24)  \n- S1 ↔ R3：GE0/0/4 - GE0/0/4 (10.0.123.3/24 - 10.0.123.3/24)\n- R2 ↔ R4：GE0/0/2 - GE0/0/3 (10.0.24.2/24 - 10.0.24.4/24)\n- R4 ↔ R5：GE0/0/2 - GE0/0/3 (10.0.45.4/24 - 10.0.45.5/24)\n\n**特殊接口配置：**\n- R2额外接口：GE0/0/4 (10.0.123.2/24) 连接至区域2网段\n- 所有设备Loopback0：10.0.x.x/24（x为设备编号）\n- R2 Loopback1、Loopback2：模拟外部网段接入点\n\n## OSPF多区域逻辑架构\n\n**区域0（骨干区域）：**\n- **设备角色：** R2、R4作为ABR（Area Border Router）\n- **接口归属：** R2-R4互联接口、两设备的Loopback0接口\n- **功能定位：** OSPF骨干传输区域，承载LSA Type-1/2传播\n\n**区域1（分支区域）：**\n- **设备角色：** R4作为ABR，R5作为内部路由器\n- **接口归属：** R4-R5互联接口、R5的Loopback0/1/2接口\n- **汇总配置：** 在R4上配置区域间路由汇总\n\n**区域2（分支区域）：**\n- **设备角色：** R2作为ABR，R1、R3作为内部路由器，S1作为中转设备\n- **接口归属：** R1、R3的所有接口，R2的GE0/0/4接口\n- **汇总配置：** 在R2上配置区域间路由汇总\n\n## 高级OSPF配置特征\n\n**Router-ID固定化：**\n- 各设备使用Loopback0地址作为固定Router-ID\n- 避免接口状态变化影响OSPF邻接关系\n\n**度量值优化：**\n- 参考带宽修改为10Gbps（10000Mbps）\n- 实现GE/FE接口OSPF开销的精确区分\n- 千兆接口开销=1，百兆接口开销=10\n\n**外部路由处理：**\n- R2作为ASBR引入外部网段（通过Loopback1/2模拟）\n- 配置缺省路由并引入OSPF域（模拟Internet接入）\n- R1设备承担Internet网关角色\n\n**路由优先级调整：**\n- OSPF域内路由：默认优先级10\n- OSPF域间路由：调整优先级避免环路\n- OSPF外部路由：调整优先级控制路径选择\n\n## 网络设计关键特性\n\n**LSA洪泛控制：**\n- 通过多区域设计限制LSA传播范围\n- ABR执行LSA过滤和汇总功能\n- 减少LSDB规模和SPF计算开销\n\n**路由汇总策略：**\n- 区域间汇总：ABR上配置area range命令\n- 外部路由汇总：ASBR上配置summary命令\n- 实现路由表规模控制和收敛优化\n\n**邻接关系优化：**\n- 共享网段通过DR/BDR选举减少邻接数量\n- 配置合适的Hello/Dead定时器\n- 确保区域间连通性和冗余性\n\n此拓扑设计实现了层次化的OSPF部署，通过合理的区域划分、路由汇总和参数优化，构建了一个可扩展、高效的企业网络架构。",
  "requirement": "你是公司的网络管理员。现在公司的网络中有五台AR 路由器，其中R2 和R4 在公司总部，R1、R3、R5 在公司分部。由于网络规模较大，为了控制LSA 的洪泛，你设计了多区域的OSPF。 为了明确设备的Router-ID，你配置设备使用固定的地址作为Router ID。 为了使路由器进行路由转发时效率更高，你在区域的边界配置了自动汇总。 R1 路由器连接到Internet，你需要配置一条缺省路由，引入到OSPF 区域，以便于OSPF 区域的所有路由器都知道如何访问Internet。 同时OSPF 路由信息中区分了内部路由和外部路由，你修改了OSPF 路由信息的优先级信息，以避免潜在的风险。 OSPF 中特定路由信息的度量值是将到达目的网络经过的所有链路的代价值进行累加得到的。而链路的代价值是路由器将接口带宽与参考带宽进行对比得到。参考带宽值为100Mbps，实际接口带宽可能为1000Mbps，而度量值都是整数，所以快速以太网接口和千兆以太网接口的OSPF 代价值均为1。为了能够相互区分这些链路，你定义参考带宽值为10Gbps。",
  "steps": [
    "设备IP 地址配置。",
    "按照规划配置OSPF 区域。",
    "检查OSPF 配置结果，检查OSPF 邻居关系状态，在ABR 上查看OSPF LSDB。",
    "在ABR、ASBR 上配置路由汇总，减少区域间、外部路由数量。",
    "修改OSPF 的参考带宽值。",
    "在OSPF 中引入缺省路由。",
    "修改OSPF 域内、域间路由和域外路由的缺省路由优先级。"
  ],
  "configs": {
    "R1": "# \nsysname R1 \n# \ninterface GigabitEthernet0/0/3 \n ip address 10.0.123.1 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.1.1 255.255.255.0 \n ospf network-type broadcast               \n# \nospf 1 router-id 10.0.1.1 \n default-route-advertise always type 1 \n preference 20 \n preference ase 50 \n bandwidth-reference 10000 \n area 0.0.0.2 \n  network 10.0.1.1 0.0.0.0 \n  network 10.0.123.1 0.0.0.0 \n# \nip route-static 0.0.0.0 0.0.0.0 LoopBack0 \n#",
    "R2": "# \nsysname R2 \n# \ninterface GigabitEthernet0/0/2 \n ip address 10.0.24.2 255.255.255.0 \n# \ninterface GigabitEthernet0/0/4 \n ip address 10.0.123.2 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.2.2 255.255.255.0          \n ospf network-type broadcast \n# \ninterface LoopBack1 \n ip address 10.2.0.1 255.255.255.0 \n# \ninterface LoopBack2 \n ip address 10.2.1.1 255.255.255.0 \n# \nospf 1 router-id 10.0.2.2 \n asbr-summary 10.2.0.0 255.255.254.0 \n import-route direct \n bandwidth-reference 10000 \n area 0.0.0.0 \n  network 10.0.2.2 0.0.0.0 \n  network 10.0.24.2 0.0.0.0 \n area 0.0.0.2 \n  abr-summary 10.3.0.0 255.255.254.0 \n  network 10.0.123.2 0.0.0.0 \n#",
    "R3": "# \nsysname R3 \n# \ninterface GigabitEthernet0/0/4 \n ip address 10.0.123.3 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.3.3 255.255.255.0          \n ospf network-type broadcast \n# \ninterface LoopBack1 \n ip address 10.3.0.1 255.255.255.0 \n ospf network-type broadcast \n# \ninterface LoopBack2 \n ip address 10.3.1.1 255.255.255.0 \n ospf network-type broadcast \n# \nospf 1 router-id 10.0.3.3 \n preference 20 \n preference ase 50 \n bandwidth-reference 10000 \n area 0.0.0.2 \n  network 10.0.123.3 0.0.0.0 \n  network 10.0.3.3 0.0.0.0 \n  network 10.3.0.1 0.0.0.0 \n  network 10.3.1.1 0.0.0.0 \n#",
    "R4": "# \nsysname R4 \n# \ninterface GigabitEthernet0/0/2 \n ip address 10.0.45.4 255.255.255.0 \n# \ninterface GigabitEthernet0/0/3 \n ip address 10.0.24.4 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.4.4 255.255.255.0          \n ospf network-type broadcast \n# \nospf 1 router-id 10.0.4.4 \n bandwidth-reference 10000 \n area 0.0.0.0 \n  network 10.0.24.4 0.0.0.0 \n  network 10.0.4.4 0.0.0.0 \n area 0.0.0.1 \n  abr-summary 10.5.0.0 255.255.254.0 \n  network 10.0.45.4 0.0.0.0 \n#",
    "R5": "# \nsysname R5 \n# \ninterface GigabitEthernet0/0/3 \n ip address 10.0.45.5 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.5.5 255.255.255.0 \n ospf network-type broadcast \n#                                          \ninterface LoopBack1 \n ip address 10.5.0.1 255.255.255.0 \n ospf network-type broadcast \n# \ninterface LoopBack2 \n ip address 10.5.1.1 255.255.255.0 \n ospf network-type broadcast \n# \nospf 1 router-id 10.0.5.5 \n bandwidth-reference 10000 \n area 0.0.0.0 \n area 0.0.0.1 \n  network 10.0.5.5 0.0.0.0 \n  network 10.5.0.1 0.0.0.0 \n  network 10.5.1.1 0.0.0.0 \n  network 10.0.45.5 0.0.0.0 \n#"
  },
  "topology_original": "互联接口、IP 地址如上图所示，所有设备均创建Loopback0，其IP 地址为10.0.x.x/24，其中x为设备编号。 R1、R3 的所有接口以及R2 的GE0/0/4 接口属于OSPF 区域2，R2、R4 的Loopback0 接口及互联接口属于OSPF 区域0，R4、R5 的互联接口、R5 的Loopback0、1、2 接口属于OSPF 区域1。 R2 上创建Loopback1、2 接口用于模拟外部网段。"
}
{
  "topology": "基于拓扑图的深度分析，完善的网络拓扑描述如下：\n\n## 网络拓扑架构分析\n\n### 1. 物理拓扑结构\n**设备配置：**\n- 5台华为AR系列路由器（AR2220平台）\n- 1台核心交换机S2700-LSW1（作为广播域扩展）\n\n**物理连接拓扑：**\n- **区域2广播域**：R1(AR2220-AR1)、R2(AR2220-AR2)、R3(AR2220-AR3)通过核心交换机S2700-LSW1互联\n  • R1-GE0/0/0 ↔ S2700-LSW1-Ethernet0/0/2\n  • R2-GE0/0/1 ↔ S2700-LSW1-Ethernet0/0/3  \n  • R3-GE0/0/0 ↔ S2700-LSW1-Ethernet0/0/5\n  • 共享网段：10.0.123.0/24（三层广播域）\n\n- **骨干链路**：R2(AR2220-AR2) ↔ R4(AR2220-AR4)点对点连接\n  • R2-GE0/0/0 ↔ R4-GE0/0/0\n  • 骨干网段：10.0.24.0/24\n\n- **区域1连接**：R4(AR2220-AR4) ↔ R5(AR2220-AR5)点对点连接\n  • R4-GE0/0/1 ↔ R5-GE0/0/0\n  • 跨区域网段：10.0.45.0/24\n\n### 2. OSPF多区域逻辑架构\n\n**区域0（骨干区域）- ABR核心：**\n- **参与设备**：R2、R4（均为ABR角色）\n- **包含接口**：\n  • R2：GE0/0/0(10.0.24.2/24)、Loopback0(10.0.2.2/24)\n  • R4：GE0/0/0(10.0.24.4/24)、Loopback0(10.0.4.4/24)\n- **功能特性**：LSA Type-1/2传播，区域间路由汇总\n\n**区域1（分部网络）- 标准区域：**\n- **参与设备**：R4（ABR）、R5（内部路由器）\n- **包含接口**：\n  • R4：GE0/0/1(10.0.45.4/24)\n  • R5：GE0/0/0(10.0.45.5/24)、Loopback0/1/2(10.0.5.5/24, 10.5.0.1/24, 10.5.1.1/24)\n- **业务网段**：10.5.0.0/24、10.5.1.0/24\n\n**区域2（分部网络）- 标准区域：**\n- **参与设备**：R2（ABR）、R1、R3（内部路由器）\n- **包含接口**：\n  • R2：GE0/0/1(10.0.123.2/24)\n  • R1：GE0/0/0(10.0.123.1/24)、Loopback0/1/2(10.0.1.1/24, 10.2.0.1/24, 10.2.1.1/24)\n  • R3：GE0/0/0(10.0.123.3/24)、Loopback0/1/2(10.0.3.3/24, 10.3.0.1/24, 10.3.1.1/24)\n- **广播网络特性**：DR/BDR选举机制，LSA Type-2网络LSA生成\n- **业务网段**：10.3.0.0/24、10.3.1.0/24\n\n### 3. 关键网络设计特征\n\n**Router-ID固定策略：**\n- 基于Loopback0接口地址确定：R1(10.0.1.1)、R2(10.0.2.2)、R3(10.0.3.3)、R4(10.0.4.4)、R5(10.0.5.5)\n\n**地址规划方案：**\n- **管理网段**：10.0.x.x/24（x为设备编号）\n- **互联网段**：10.0.xy.0/24（x、y为互联设备编号）\n- **业务网段**：10.x.0.0/24、10.x.1.0/24（x为设备编号）\n- **外部模拟**：10.2.0.0/24、10.2.1.0/24（R2上模拟Internet网段）\n\n**OSPF协议优化配置：**\n- **参考带宽**：10Gbps（区分GE/FE接口成本值）\n- **ABR汇总**：区域边界自动路由聚合\n- **ASBR功能**：R1作为ASBR引入外部缺省路由\n- **路由优先级**：域内(10) < 域间(110) < 域外(150)\n\n**网络冗余和收敛特性：**\n- **多路径**：区域2内R1/R3可通过R2到达其他区域\n- **快速收敛**：标准OSPF LSA洪泛和SPF计算\n- **负载均衡**：等价路径自动负载分担\n\n**安全和管理特征：**\n- **区域隔离**：LSA洪泛边界控制\n- **外部路由控制**：Type-5 LSA由ASBR统一发布\n- **网络分段**：业务流量与管理流量分离\n\n### 4. 协议邻接关系预期\n- **区域0**：R2 ↔ R4（点对点邻居）\n- **区域1**：R4 ↔ R5（点对点邻居）\n- **区域2**：R1 ↔ R2 ↔ R3（广播网络DR/BDR邻接）\n\n此拓扑实现了标准的OSPF多区域设计，具备良好的可扩展性、收敛性和管理性。",
  "requirement": "你是公司的网络管理员。现在公司的网络中有五台 AR 路由器，其中 R2 和 R4 在公司总部R1、R3、R5 在公司分部。由于网络规模较大，为了控制 LSA 的洪泛，你设计了多区域的OSPF。为了明确设备的 Router-D，你配置设备使用固定的地址作为 Router ID。为了使路由器进行路由转发时效率更高，你在区域的边界配置了自动汇总。R1 路由器连接到 Internet，你需要配置一条缺省路由，引入到 OSPF 区域，以便于 OSPF 区域的所有路由器都知道如何访问 Internet。同时 OSPF 路由信息中区分了内部路由和外部路由，你修改了 OSPF 路由信息的优先级信息以避免潜在的风险。OSPF 中特定路由信息的度量值是将到达目的网络经过的所有链路的代价值进行累加得到的。而链路的代价值是路由器将接口带宽与参考带宽进行对比得到。参考带宽值为100Mbps，实际接口带宽可能为 1000Mbps，而度量值都是整数，所以快速以太网接口和干兆以太网接口的OSPF 代价值均为1。为了能够相互区分这些链路，你定义参考带宽值为 10Gbps。互联接口、IP 地址如上图所示，所有设备均创建 Loopback0，其 IP 地址为 10.0.x.x/24，其中x为设备编号。R1、R3 的所有接口以及 R2 的 GE0/0/1 接口属于 OSPF 区域 2，R2、R4的 Loopback0 接口及互联接口属于 OSPF 区域 0，R4、R5 的互联接口、R5 的 Loopback0、1、2 接口属于 OSPF区域1。R2 上创建 Loopback1、2 接口用于模拟外部网段。",
  "steps": [
    "1. 设备 IP 地址配置。",
    "2. 按照规划配置 OSPF 区域。",
    "3. 检查 OSPF 配置结果，检查 OSPF 邻居关系状态，在 ABR 上查看 OSPF LSDB。",
    "4. 在 ABR、ASBR 上配置路由汇总，减少区域间、外部路由数量。",
    "5. 修改 OSPF 的参考带宽值。",
    "6. 在 OSPF 中引入缺省路由。",
    "7. 修改 OSPF 域内、域间路由和域外路由的缺省路由优先级"
  ],
  "configs": {
    "R1": "# \nsysname R1 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.123.1 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.1.1 255.255.255.0 \n# \nospf router-id 10.0.1.1 \n area 2 \n network 10.0.123.1 0.0.0.0 \n network 10.0.1.1 0.0.0.0 \n interface LoopBack0 \n ospf network-type broadcast \n# \nip route-static 0.0.0.0 0.0.0.0 LoopBack 0 \n ospf 1 \n default-route-advertise always type 1 \nospf 1 \n preference 20 \n preference ase 50\nreturn",
    "R2": "# \nsysname R2 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.24.2 255.255.255.0 \n# \ninterface GigabitEthernet0/0/1 \n ip address 10.0.123.2 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.2.2 255.255.255.0 \n interface LoopBack1 \n ip address 10.2.0.1 255.255.255.0 \n interface LoopBack2 \n ip address 10.2.1.1 255.255.255.0 \n# \nospf router-id 10.0.2.2 \n area 0 \n network 10.0.24.2 0.0.0.0 \n area 2 \n network 10.0.123.2 0.0.0.0 \n network 10.0.2.2 0.0.0.0 \n interface LoopBack0 \n ospf network-type broadcast \nospf 1 \n area 2 \n abr-summary 10.3.0.0 255.255.254.0 \nospf 1 \n import-route direct \nospf 1 \n asbr-summary 10.2.0.0 255.255.254.0 \nreturn",
    "R3": "# \nsysname R3 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.123.3 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.3.3 255.255.255.0 \n interface LoopBack1 \n ip address 10.3.0.1 255.255.255.0 \n interface LoopBack2 \n ip address 10.3.1.1 255.255.255.0 \n# \nospf router-id 10.0.3.3 \n area 2 \n network 10.0.123.3 0.0.0.0 \n network 10.0.3.3 0.0.0.0 \n network 10.3.0.1 0.0.0.0 \n network 10.3.1.1 0.0.0.0 \n interface LoopBack0 \n ospf network-type broadcast \n interface LoopBack1 \n ospf network-type broadcast \n interface LoopBack2 \n ospf network-type broadcast \nreturn",
    "R4": "# \nsysname R4 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.24.4 255.255.255.0 \n# \ninterface GigabitEthernet0/0/1 \n ip address 10.0.45.4 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.4.4 255.255.255.0 \n# \nospf router-id 10.0.4.4 \n area 0 \n network 10.0.24.4 0.0.0.0 \n network 10.0.4.4 0.0.0.0 \n area 1 \n network 10.0.45.4 0.0.0.0 \n interface LoopBack0 \n ospf network-type broadcast \nospf 1 \n abr-summary 10.5.0.0 255.255.254.0\nreturn",
    "R5": "# \nsysname R5 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.45.5 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.5.5 255.255.255.0 \n interface LoopBack1 \n ip address 10.5.0.1 255.255.255.0 \n interface LoopBack2 \n ip address 10.5.1.1 255.255.255.0 \n# \nospf router-id 10.0.5.5 \n area 1 \n network 10.0.5.5 0.0.0.0 \n network 10.5.0.1 0.0.0.0 \n network 10.5.1.1 0.0.0.0 \n network 10.0.45.5 0.0.0.0 \n interface LoopBack0 \n ospf network-type broadcast \n interface LoopBack1 \n ospf network-type broadcast \n interface LoopBack2 \n ospf network-type broadcast \nreturn"
  },
  "topology_original": "网络包含5台AR路由器（R1-R5）和3个OSPF区域，拓扑架构如下：\n\n1. 物理连接拓扑：\n   - 区域2（分部网络）：\n     • R1(GE0/0/0) ↔ R2(GE0/0/1)：10.0.123.0/24（跨区域连接）\n     • R3(GE0/0/0) ↔ R2(GE0/0/1)：10.0.123.0/24（同一广播域）\n   - 区域0（骨干区域）：\n     • R2(GE0/0/0) ↔ R4(GE0/0/0)：10.0.24.0/24（核心骨干链路）\n   - 区域1（分部网络）：\n     • R4(GE0/0/1) ↔ R5(GE0/0/0)：10.0.45.0/24（跨区域连接）\n\n2. 逻辑区域划分：\n   - 区域0（骨干）：\n     • R2/R4的GE0/0/0接口（10.0.24.0/24）\n     • R2/R4的Loopback0接口（10.0.2.2/24、10.0.4.4/24）\n   - 区域2（分部）：\n     • R1/R3所有接口（含Loopback0/1/2）\n     • R2的GE0/0/1接口（10.0.123.2/24）\n   - 区域1（分部）：\n     • R5所有接口（含Loopback0/1/2）\n     • R4的GE0/0/1接口（10.0.45.4/24）\n\n3. 关键地址规划：\n   - 管理环回地址（/24）：\n     • R1:10.0.1.1  R2:10.0.2.2  R3:10.0.3.3  R4:10.0.4.4  R5:10.0.5.5\n   - 业务网段（/24）：\n     • R2模拟外部网段：10.2.0.0/24、10.2.1.0/24\n     • R3业务网段：10.3.0.0/24、10.3.1.0/24\n     • R5业务网段：10.5.0.0/24、10.5.1.0/24"
}
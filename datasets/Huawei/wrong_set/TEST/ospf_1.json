{
  "topology": "## 网络拓扑详细分析\n\n### 1. 物理拓扑结构\n**设备组成：**\n- 3台华为AR2220系列路由器（AR2220-AR1、AR2220-AR2、AR2220-AR3）\n- 1台华为S3700系列三层交换机（S3700-LSW1）\n\n**物理连接关系：**\n- 星型拓扑结构，以S3700-LSW1交换机为中心节点\n- 所有路由器通过GigabitEthernet接口连接至交换机：\n  - AR2220-AR1 [GE0/0/0] ↔ S3700-LSW1 [Ethernet0/0/1]\n  - AR2220-AR2 [GE0/0/0] ↔ S3700-LSW1 [Ethernet0/0/2] \n  - AR2220-AR3 [GE0/0/0] ↔ S3700-LSW1 [Ethernet0/0/3]\n\n**连接介质特征：**\n- 全千兆以太网链路连接\n- 广播式多路访问网络（Broadcast Multi-Access）\n- 单一冲突域，支持CSMA/CD协议\n\n### 2. 逻辑网络架构\n\n**IP地址规划方案：**\n- **互联网段：** 10.0.123.0/24（CIDR块）\n  - AR2220-AR1: 10.0.123.1/24\n  - AR2220-AR2: 10.0.123.2/24  \n  - AR2220-AR3: 10.0.123.3/24\n  - 网关地址池：10.0.123.1-10.0.123.3\n\n- **环回接口地址：** \n  - AR1 Loopback0: 10.0.1.1/24\n  - AR2 Loopback0: 10.0.2.2/24\n  - AR3 Loopback0: 10.0.3.3/24\n\n**网络分段策略：**\n- 管理平面：Loopback接口用于设备管理和Router ID\n- 数据平面：GE接口承载业务流量转发\n- 控制平面：OSPF协议报文交换\n\n### 3. OSPF协议配置架构\n\n**区域设计：**\n- **单区域部署：** 所有接口均属于Area 0（骨干区域）\n- **激活接口范围：**\n  - 所有GE0/0/0互联接口\n  - 所有Loopback0管理接口\n\n**Router ID分配：**\n- 手动指定Router ID（建议使用Loopback0地址）\n- AR1: 10.0.1.1\n- AR2: 10.0.2.2  \n- AR3: 10.0.3.3\n\n**网络类型特征：**\n- 默认网络类型：Broadcast（广播型）\n- DR/BDR选举机制：基于优先级和Router ID\n- Hello间隔：10秒，Dead间隔：40秒\n\n### 4. 安全认证配置\n\n**区域认证机制：**\n- **认证类型：** Area Authentication（区域认证）\n- **认证方式：** Simple Password Authentication（明文认证）\n- **认证密码：** \"huawei\"\n- **应用范围：** Area 0内所有OSPF邻接关系\n\n**安全加固目标：**\n- 防止恶意路由器注入虚假LSA\n- 确保OSPF域内设备身份合法性\n- 抵御路由协议攻击和拓扑污染\n\n### 5. 高级配置优化\n\n**接口Cost值调优：**\n- 手动修改OSPF接口Cost值\n- 影响最短路径树（SPT）计算\n- 实现流量工程和负载均衡\n\n**网络类型修改：**\n- R2 Loopback0接口网络类型变更\n- 观察路由表中掩码长度变化\n- 理解Point-to-Point vs Broadcast网络类型差异\n\n**邻接关系状态：**\n- Full状态：完全邻接，LSA数据库同步完成\n- 预期邻居数量：每台设备2个Full邻居\n- LSA泛洪范围：Area 0内全网泛洪\n\n### 6. 网络收敛特性\n\n**拓扑收敛流程：**\n1. Hello报文交换建立邻接\n2. 区域认证验证设备合法性  \n3. DD报文交换同步LSDB\n4. LSR/LSU完成数据库同步\n5. SPF算法计算最短路径树\n6. 生成OSPF路由表项\n\n**故障恢复机制：**\n- 链路故障检测：基于Hello超时\n- LSA重新泛洪：通知拓扑变化\n- SPF重新计算：更新路由表\n- 收敛时间：秒级收敛能力",
  "requirement": "你是公司的网络管理员。现在公司的网络中有三台 AR 路由器，通过以太网实现相互的连通。在以太网这样的广播式多路访问网络上，可能存在安全隐患，所有你选择采用 OSPF 区域认证的方法来避免恶意的路由攻击。R1、R2、R3 之间通过交换机 S1 相连，其接口、IP 地址如图所示。R1、R2、R3 上均创建Loopback0，IP 地址为 10.0.x.x/24，其中x为设备编号。R1、R2、R3 所有接口都属于区域 0，在互联接口、Loopback0 接口上激活 OSPF。",
  "steps": [
    "1. 设备 IP 地址配置",
    "2. 在 R1、R2、R3 上配置 OSPF，手动指定 Router ID，并在互联接口、Loopback0 接口上激活 OSPF",
    "3. 为保证安全性，配置 OSPF 的区域认证，使用明文方式，密码配置为“huawei”",
    "4. 手动修改 R2 Loopback0 接口的网络类型，观察 OSPF 路由的掩码长度变化",
    "5. 手动修改 OSPF 接口的 Cost 值"
  ],
  "configs": {
    "R1": "# \nsysname R1 \n# \ninterface g0/0/0 \n ip address 10.0.123.1 24 \n# \ninterface LoopBack 0 \n ip address 10.0.1.1 24 \n# \nospf 1 router-id 10.0.1.1 \nospf 1 area 0 \n network 10.0.123.1 0.0.0.0 \n network 10.0.1.1 0.0.0.0 \n# \nospf 1 \n area 0 \n authentication-mode simple plain huawei \n return",
    "R2": "# \nsysname R2 \n# \ninterface g0/0/0 \n ip address 10.0.123.2 24 \n# \ninterface LoopBack 0 \n ip address 10.0.2.2 24 \n# \nospf 1 router-id 10.0.2.2 \nospf 1 area 0 \n network 10.0.123.2 0.0.0.0 \n network 10.0.2.2 0.0.0.0 \n# \nospf 1 \n area 0 \n authentication-mode simple plain huawei \n return",
    "R3": "# \nsysname R3 \n# \ninterface g0/0/0 \n ip address 10.0.123.3 24 \n# \ninterface LoopBack 0 \n ip address 10.0.3.3 24 \n# \nospf 1 router-id 10.0.3.3 \nospf 1 area 0 \n network 10.0.123.3 0.0.0.0 \n network 10.0.3.3 0.0.0.0 \n# \nospf 1 \n area 0 \n authentication-mode simple plain huawei \n return"
  },
  "topology_original": "网络由3台AR路由器（AR1/AR2/AR3）和1台S3700交换机组成，拓扑结构如下：\n\n1. 物理连接拓扑：\n   - 所有路由器通过GE0/0/0接口连接到LSW1交换机：\n     • AR1(GE0/0/0) ↔ LSW1：10.0.123.1/24\n     • AR2(GE0/0/0) ↔ LSW1：10.0.123.2/24\n     • AR3(GE0/0/0) ↔ LSW1：10.0.123.3/24\n\n2. 逻辑网络划分：\n   - OSPF Area 0：\n     • 包含所有互联接口（10.0.123.0/24网段）\n     • 包含各设备Loopback0接口（10.0.x.x/24）\n   - 关键地址规划：\n     • 管理环回地址：\n       ▪ AR1:10.0.1.1/24\n       ▪ AR2:10.0.2.2/24\n       ▪ AR3:10.0.3.3/24\n     • 互联地址段：10.0.123.0/24"
}
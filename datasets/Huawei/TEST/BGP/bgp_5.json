{
    "topology": "网络包含5台路由器（R1-R5）和3个自治系统，拓扑架构如下：\n\n1. 自治系统划分：\n   - AS 64512（总部核心）：R2/R3/R4组成环形拓扑，运行OSPF Area 0\n   - AS 64513（分支机构1）：R1通过EBGP连接核心\n   - AS 64514（分支机构5）：R5通过EBGP连接核心\n\n2. 物理连接拓扑：\n   - 核心网络（AS64512）：\n     • R2(GE0/0/0) ↔ R1(GE0/0/0)：10.0.12.0/24（跨AS连接）\n     • R2(GE0/0/1)-R3(GE0/0/0)：10.0.23.0/24（OSPF骨干链路）\n     • R3(GE0/0/1)-R4(GE0/0/0)：10.0.34.0/24（OSPF骨干链路）\n     • R4(GE0/0/1) ↔ R5(GE0/0/0)：10.0.45.0/24（跨AS连接）\n\n3. 协议部署：\n   - OSPF区域0：\n     • 覆盖AS64512所有物理接口（10.0.23.0/24、10.0.34.0/24）\n     • 宣告各设备Loopback0地址（10.0.2.2/32、10.0.3.3/32、10.0.4.4/32）\n   - BGP对等关系：\n     • IBGP全互联：R2-R3-R4通过Loopback0建立邻居（10.0.2.2↔10.0.3.3↔10.0.4.4）\n     • EBGP邻居：\n       ▪ R1(AS64513)-R2(10.0.2.2) 跨AS连接\n       ▪ R5(AS64514)-R4(10.0.4.4) 跨AS连接\n\n4. 关键地址规划：\n   - 管理环回地址（/32）：\n     • R1:10.0.1.1  R2:10.0.2.2  R3:10.0.3.3  R4:10.0.4.4  R5:10.0.5.5\n   - 业务网段（/24）：\n     • R1 Loopback1:10.1.1.0/24\n     • R5 Loopback1:10.1.5.0/24\n   - 下一跳配置：\n     • R2/R4对iBGP邻居启用next-hop-local\n     • EBGP连接使用Loopback0建立（需配置ebgp-max-hop）",
    "requirement": "你是公司的网络管理员。公司的网络采用了BGP协议作为路由协议。公司的网络由多个自治系统组成，不同的分支机构使用了不同的AS号，现在你需要完成公司网络的搭建工作。在公司总部使用了OSPF作为IGP，公司内部不同分支机构使用的是私有的BGP AS号。配置好网络后，还需要观察BGP路由信息的传递。",
    "steps": [
      "1. 设备 IP 地址配置。",
      "2. 配置 AS 64512 内的 OSPF。",
      "3. 配置 AS 64512 内的全互联 IBGP 对等体关系。",
      "4. 配置 AS 64512、AS 64513、AS 64514 之间的 EBGP 对等体关系。",
      "5. 在 R1、R5 上将 Loopback1 接口路由发布到 BGP，在 R2、R4 上修改 BGP 下一跳地址"
    ],
    "configs": {
      "R1": "# \nsysname R1 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.12.1 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.1.1 255.255.255.255 \n# \ninterface LoopBack1 \n ip address 10.1.1.1 255.255.255.0 \n# \nospf 1 router-id 10.0.1.1 \n area 0.0.0.0 \n network 10.0.12.1 0.0.0.0 \n network 10.0.1.1 0.0.0.0 \n# \nbgp 65413 \n router-id 10.0.1.1 \n peer 10.0.2.2 as-number 64512 \n peer 10.0.2.2 ebgp-max-hop 2 \n peer 10.0.2.2 connect-interface LoopBack0 \n network 10.1.1.1 255.255.255.0",
      "R2": "# \nsysname R2 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.12.2 255.255.255.0 \n interface GigabitEthernet0/0/1 \n ip address 10.0.23.2 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.2.2 255.255.255.255 \n# \nospf 1 router-id 10.0.2.2 \n area 0 \n network 10.0.23.2 0.0.0.0 \n network 10.0.2.2 0.0.0.0 \n# \nbgp 64512 \n router-id 10.0.2.2 \n peer 10.0.3.3 as-number 64512 \n peer 10.0.3.3 connect-interface LoopBack0 \n peer 10.0.4.4 as-number 64512 \n peer 10.0.4.4 connect-interface LoopBack0 \n peer 10.0.3.3 next-hop-local \n peer 10.0.4.4 next-hop-local",
      "R3": "# \nsysname R3 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.23.3 255.255.255.0 \n interface GigabitEthernet0/0/1 \n ip address 10.0.34.3 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.3.3 255.255.255.255 \n# \nospf 1 router-id 10.0.3.3 \n area 0 \n network 10.0.23.3 0.0.0.0 \n network 10.0.34.3 0.0.0.0 \n network 10.0.3.3 0.0.0.0 \n# \nbgp 64512 \n router-id 10.0.3.3 \n peer 10.0.2.2 as-number 64512 \n peer 10.0.2.2 connect-interface LoopBack0 \n peer 10.0.4.4 as-number 64512 \n peer 10.0.4.4 connect-interface LoopBack0 \n peer 10.0.2.2 next-hop-local \n peer 10.0.4.4 next-hop-local",
      "R4": "# \nsysname R4 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.34.4 255.255.255.0 \n interface GigabitEthernet0/0/1 \n ip address 10.0.45.4 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.4.4 255.255.255.255 \n# \nospf 1 router-id 10.0.4.4 \n area 0 \n network 10.0.34.4 0.0.0.0 \n network 10.0.4.4 0.0.0.0 \n# \nbgp 64512 \n router-id 10.0.4.4 \n peer 10.0.2.2 as-number 64512 \n peer 10.0.2.2 connect-interface LoopBack0 \n peer 10.0.3.3 as-number 64512 \n peer 10.0.3.3 connect-interface LoopBack0 \n peer 10.0.2.2 next-hop-local \n peer 10.0.3.3 next-hop-local",
      "R5": "# \nsysname R5 \n# \ninterface GigabitEthernet0/0/0 \n ip address 10.0.45.5 255.255.255.0 \n# \ninterface LoopBack0 \n ip address 10.0.5.5 255.255.255.255 \n interface LoopBack1 \n ip address 10.1.5.5 255.255.255.0 \n# \nbgp 65414 \n router-id 10.0.5.5 \n peer 10.0.4.4 as-number 64512 \n peer 10.0.4.4 ebgp-max-hop 2 \n peer 10.0.4.4 connect-interface LoopBack0 \n network 10.1.5.5 255.255.255.0"
    }
}
  
{
  "topology": "基于网络拓扑图和配置文件分析，完善的网络拓扑描述如下：\n\n该网络拓扑包含5台设备，均为路由器，运行OSPF协议，所有设备位于OSPF区域0.0.0.0。网络采用星型加链型混合拓扑结构：\n\n**设备连接关系：**\n- Client（172.16.1.2/24）通过interface1连接到DeviceA的GigabitEthernet1/0/0（172.16.1.1/24）\n- DeviceA的GigabitEthernet2/0/0（10.0.0.1/24）连接到DeviceB的GigabitEthernet1/0/0（10.0.0.2/24）\n- DeviceB的GigabitEthernet2/0/0（10.0.1.2/24）连接到DeviceC的GigabitEthernet1/0/0（10.0.1.1/24）\n- DeviceC的GigabitEthernet2/0/0（10.0.2.2/24）连接到DeviceD的GigabitEthernet2/0/0（10.0.2.1/24）\n- DeviceD的GigabitEthernet1/0/0（10.0.3.1/24）连接到DeviceE的GigabitEthernet1/0/0（10.0.3.2/24）\n- DeviceE的interface2连接到Server（192.168.3.1/24）\n\n**特殊配置：**\n- DeviceB和DeviceD之间建立MPLS TE-Tunnel10（tunnel-id 100），DeviceB作为隧道头端（2.2.2.2），DeviceD作为隧道尾端（4.4.4.4）\n- DeviceB的Tunnel10配置IGP Shortcut功能，IGP度量值相对调整-10\n- DeviceB、DeviceC、DeviceD启用MPLS TE和RSVP-TE功能\n- DeviceB启用OSPF本地MT（local-mt）特性和流量调整功能\n\n**组播配置：**\n- 所有设备启用组播路由，相关接口配置PIM-SM\n- DeviceB和DeviceD配置为C-BSR和C-RP\n- DeviceA的GigabitEthernet1/0/0启用IGMP v2\n\n**Loopback接口：**\n- DeviceA: 1.1.1.1/32\n- DeviceB: 2.2.2.2/32  \n- DeviceC: 3.3.3.3/32\n- DeviceD: 4.4.4.4/32\n- DeviceE: 5.5.5.5/32\n\n网络实现了组播和MPLS TE共存，通过OSPF本地MT特性解决TE-Tunnel对组播路径感知的影响。",
  "requirement": "网络中同时部署了组播和MPLS TE-Tunnel，且TE-Tunnel配置了IGP Shortcut。为了解决组播加入报文被TE-Tunnel跨越的路由器无法感知的问题，在DeviceB使能OSPF本地MT特性。",
  "steps": [
    "在各路由器上使能OSPF，配置OSPF基本功能。",
    "在各路由器上使能组播PIM-SM功能。",
    "配置MPLS RSVP-TE隧道。",
    "在DeviceB上配置MPLS TE-Tunnel，并使能IGP-Shortcut。",
    "在DeviceB上使能OSPF本地MT特性。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nrouter id 1.1.1.1\n#\nmulticast routing-enable\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.0.1 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 172.16.1.1 255.255.255.0\n pim sm\n igmp enable\n igmp version 2\n#\ninterface LoopBack0\n ip address 1.1.1.1 255.255.255.255\n#\nospf 1\n area 0.0.0.0\n  network 172.16.1.0 0.0.0.255\n  network 10.0.0.0 0.0.0.255\n  network 1.1.1.1 0.0.0.0\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nrouter id 2.2.2.2\n#\nmulticast routing-enable\n#\nmpls lsr-id 2.2.2.2\n#\nmpls\n mpls te\n mpls rsvp-te\n mpls te cspf\n#\nospf 1\n opaque-capability enable\n enable traffic-adjustment\n local-mt enable\n area 0.0.0.0\n  network 10.0.0.0 0.0.0.255\n  network 10.0.1.0 0.0.0.255\n  network 2.2.2.2 0.0.0.0\n  mpls-te enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.0.2 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.1.2 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n ip address 2.2.2.2 255.255.255.255\n pim sm\n#\ninterface Tunnel10\n ip address unnumbered interface LoopBack0\n tunnel-protocol mpls te\n destination 4.4.4.4\n mpls te tunnel-id 100\n mpls te igp shortcut ospf\n mpls te igp metric relative -10\n#\npim\n C-BSR LoopBack0\n C-RP LoopBack0\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nrouter id 3.3.3.3\n#\nmulticast routing-enable\n#\nmpls lsr-id 3.3.3.3\n#\nmpls\n mpls te\n mpls rsvp-te\n#\nospf 1\n opaque-capability enable\n area 0.0.0.0\n  network 10.0.1.0 0.0.0.255\n  network 10.0.2.0 0.0.0.255\n  network 3.3.3.3 0.0.0.0\n  mpls-te enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.1.1 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.2.2 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n undo shutdown\n ip address 3.3.3.3 255.255.255.255\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nrouter id 4.4.4.4\n#\nmulticast routing-enable\n#\nmpls lsr-id 4.4.4.4\n#\nmpls\n mpls te\n mpls rsvp-te\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.3.1 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.0.2.1 255.255.255.0\n pim sm\n mpls\n mpls te\n mpls rsvp-te\n#\ninterface LoopBack0\n ip address 4.4.4.4 255.255.255.255\n pim sm\n#\nospf 1\n opaque-capability enable\n area 0.0.0.0\n  network 10.0.2.0 0.0.0.255\n  network 10.0.3.0 0.0.0.255\n  network 4.4.4.4 0.0.0.0\n  mpls-te enable\n#\npim\n C-BSR LoopBack0\n C-RP LoopBack0\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\nrouter id 5.5.5.5\n#\nmulticast routing-enable\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.0.3.2 255.255.255.0\n pim sm\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 192.168.3.1 255.255.255.0\n pim sm\n#\ninterface LoopBack0\n ip address 5.5.5.5 255.255.255.255\n pim sm\n#\nospf 1\n area 0.0.0.0\n  network 10.0.3.0 0.0.0.255\n  network 192.168.3.0 0.0.0.255\n  network 5.5.5.5 0.0.0.0\n#\nreturn"
  },
  "related_images": [
    "图1-49 配置OSPF本地MT特性组网图.png"
  ]
}
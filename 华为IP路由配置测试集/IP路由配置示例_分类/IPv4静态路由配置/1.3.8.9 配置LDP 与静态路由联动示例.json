{
  "topology": "该MPLS网络采用菱形拓扑结构，由4台LSR设备组成，分别为LSRA、LSRB、LSRC和LSRD。LSRA作为源端LSR，LSRD作为目的端LSR，LSRB和LSRC作为中间传输节点，形成双路径冗余架构。\n\n**设备连接关系：**\n- LSRA与LSRB通过GE1/0/0接口连接\n- LSRA与LSRC通过GE2/0/0接口连接  \n- LSRB与LSRD通过GE2/0/0接口连接\n- LSRC与LSRD通过GE2/0/0接口连接**MPLS和LDP配置：**\n- 所有LSR设备均启用MPLS和LDP功能\n- LSR ID分别对应各自环回地址\n- 所有接口均启用MPLS和LDP协议\n\n**路径和冗余设计：**\n- LinkA（主路径）：LSRA → LSRB → LSRD，优先级40\n- LinkB（备份路径）：LSRA → LSRC → LSRD，优先级50\n- 通过静态路由实现主备路径切换，主路径配置ldp-sync功能\n- 在LSRA和LSRD的主路径接口上配置static-route timer ldp-sync hold-down 20秒",
  "requirement": "在存在主备 LSP 的 MPLS 组网中，LSR 之间依靠静态路由建立 LSP。当主链路的 LDP 会话故障（非链路故障导致）时，或者主链路故障后再恢复时，由于静态路由与 LDP 的不联动，会导致 MPLS 流量的中断（短时中断）。通过配置 LDP 与静态路由联动功能，使得 LinkA 上的 LDP 会话中断或者 LinkA 发生故障再恢复的情况下，保证 MPLS 流量不中断。",
  "steps": [
    "各 LSR 上配置到其他 LSR 的静态路由，使网络互通。",
    "LSR 的全局及接口下使能 MPLS、MPLS LDP 能力。",
    "使能 LDP 和静态路由联动能力，并检查配置结果。"
  ],
  "configs": {
    "LSRA": "#\nsysname LSRA\n#\nmpls lsr-id 1.1.1.1\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n static-route timer ldp-sync hold-down 20\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.2.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 1.1.1.1 255.255.255.255\n#\n ip route-static 2.2.2.2 255.255.255.255 GigabitEthernet1/0/0 10.1.1.2\n ip route-static 3.3.3.3 255.255.255.255 GigabitEthernet2/0/0 10.2.1.2\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet1/0/0 10.1.1.2 preference 40 ldp-sync\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.2.1.2 preference 50\n ip route-static 10.3.1.0 255.255.255.252 GigabitEthernet1/0/0\n ip route-static 10.4.1.0 255.255.255.252 GigabitEthernet2/0/0\n#\nreturn",
    "LSRB": "#\nsysname LSRB\n#\nmpls lsr-id 2.2.2.2\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.3.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack2\n ip address 2.2.2.2 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.1.1.1\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.3.1.2\n#\nreturn",
    "LSRC": "#\nsysname LSRC\n#\nmpls lsr-id 3.3.3.3\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.2.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack3\n ip address 3.3.3.3 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.2.1.1\n ip route-static 4.4.4.4 255.255.255.255 GigabitEthernet2/0/0 10.4.1.2\n#\nreturn",
    "LSRD": "#\nsysname LSRD\n#\nmpls lsr-id 4.4.4.4\n#\nmpls\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.3.1.2 255.255.255.0\n static-route timer ldp-sync hold-down 20\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack4\n ip address 4.4.4.4 255.255.255.255\n#\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet1/0/0 10.3.1.1 preference 40 ldp-sync\n ip route-static 1.1.1.1 255.255.255.255 GigabitEthernet2/0/0 10.4.1.1 preference 50\n ip route-static 2.2.2.2 255.255.255.255 GigabitEthernet1/0/0 10.3.1.1\n ip route-static 3.3.3.3 255.255.255.255 GigabitEthernet2/0/0 10.4.1.1\n ip route-static 10.1.1.0 255.255.255.252 GigabitEthernet1/0/0\n ip route-static 10.2.1.0 255.255.255.252 GigabitEthernet2/0/0\n#\nreturn"
  },
  "related_images": [
    "图1-27 配置LDP与静态路由联动组网图.png"
  ]
}